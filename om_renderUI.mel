//LTB: source om_renderUI;om_renderUI;

//Render UI
//Author: Oliver Markowski - himself@maya-artist.com
//July 2007
/*

//PROCEDURES
int om_getInheritedVisibility(string $obj)
		-returns also inherited visibility of selected Object - e.g. 0 if parent is hidden
		
om_getMaterialOverrides()
		-shows all material overrides on currently selected layer
		
string om_getHostname()
		-retunrs name of your computer by tokenizing output of system("ipconfig")

string om_getMergePsdCommand(string $layers[])
		-checks output paths of all renderable renderlayers and creates a mel command to execute by smedge after all images are rendered
		
string om_getMainSceneName()
		-resolves Scenename without versioning and comments - eg.   my_scene_new_v003_added_lights  will return "my_scene_new"
		
previewMaxwell()

checkFileNodes()
		-checks whether there are spaces in texture-filenames -- for linux compatibility
		
assignExportLocationAttribute()
		-assigns attr for scene division that tells where MI files are located
string includeRenderLayerObjects()
		-includes all objects on the renderlayer that are not already exported into one temporary mi file
		
string includeAlreadyExported()
		-include all previously exported objects on layer

string[] getMiExportLocationInScene()
		-returns array of objects followed by the location of their MI Files - e.g 


string om_submitSmedge(	string $application,    1 2 3 or 4
					string $waitFor, 		obsolete
					string $pool,		
					string $notify,		
					string $priority,
					string $usageLimit,
					string $range,
					string $samples,
					string $mergePSD,
					string $useHosts,
					string $maxHosts,
					string $region,
					int $localIncludes
					int $submitJobOnly
					int $submitDirectAfterExport
					string $smedgeExtraFromUI
					int $useRenderLayerRange
				)
					
					
		-creates the submiter Command for smedge

string om_submitSmedgeCmd(string $cmd)
		-executes the command and returns jobId
		
*/






global proc om_renderUI() {

	//source om_renderUI_cfg.mel;
	//source om_renderFunctions.mel;
	//source vrayRestoreMayaRenderView;
	
	global int $preferredDistributor;
	global string $submit;
	global string $RRsubmit;
	global string $scriptPath;
	
	//get script location
	string $scriptPath=`whatIs om_renderUI`,$buffer[];
	int $bsize=`tokenize $scriptPath "/" $buffer`;
	$scriptPath=`substring $scriptPath 25 (size($scriptPath)-size($buffer[$bsize-1]))`;
	
	
//if (!`pluginInfo -q -l Mayatomr`)
//	loadPlugin -qt Mayatomr;

if (`window -exists om_renderUI_win`)
	showWindow om_renderUI_win;	//deleteUI -window "om_renderUI_win"
else {
	window -title "Render UI 2.2 - by Oliver Markowski - www.fullblownimages.com" -retain -widthHeight 450 430 om_renderUI_win;

	scrollLayout;	
	  columnLayout -adjustableColumn true -cw 395 -columnOffset "both" 5;  
	
			/*
			frameLayout -collapsable 1 -collapse 1 -label ("Maxwell~Render") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 1
								-columnWidth 1 225;
					button -bgc 1 1 .5 -l "Preview Scene On Network" -c "previewMaxwell()";
					
				setParent ..;
			setParent ..;
			*/
			frameLayout -collapsable 1 -collapse 0 -label ("Submitter Settings") -labelAlign "top" -borderStyle "in";
				columnLayout;
					radioButtonGrp	-sl $preferredDistributor
									-columnWidth5 130 100 70 100 100
									-numberOfRadioButtons 4
									-label " Distributor" 
									-label1 "Qube!"
									-label2 "Smedge"
									-label3 "Local Render"
									-label4 "RR6"
									renderDistributor;
					radioButtonGrp	-sl 3
									-columnWidth5 130 120 125 80 50
									-numberOfRadioButtons 4
									-label " Render using" 
									-label2 "MentalRay4Maya"
									-en2 1
									-label1 "MR Stdalone SD" 
									-en1 0
									-label3 "VRay" 									
									-label4 "VR4M" 
									-en4 1									
									renderApplication;
					
					rowColumnLayout -numberOfColumns 8						
									-columnWidth 1 130
									-columnWidth 2 50
									-columnWidth 3 50
									-columnWidth 4 25
									-columnWidth 5 25
									-columnWidth 6 75
									-columnWidth 7 66
									-columnWidth 8 225;							

						
						text -l "Frames|Preview|Psize|By " -al "right";
						textField -en 1 -text (`playbackOptions -q -min`+"-"+`playbackOptions -q -max`) om_renderRange;
						//textField -en 1 -text (`currentTime -q`) om_renderRange;
						textField -en 1 -text (`currentTime -q`) om_previewFrames;
						textField -en 1 -text "4" om_packetSize;
						textField -en 1 -text "1" om_stepSize;
						button -l "Current Frame" -c "om_allCamsOff;textField -e -text `currentTime -q` om_renderRange";
						button -l "TimeLine" -c "om_allCamsOff;textField -e -text (`playbackOptions -q -min`+\"-\"+`playbackOptions -q -max`) om_renderRange";
						checkBox -v 0 -l "RangePerLayer" useRangePerLayer;
						setParent ..;
						
					rowColumnLayout -numberOfColumns 4
									-columnWidth 1 130
									-columnWidth 2 151
									-columnWidth 3 140
									-columnWidth 4 100;
									
						
					
					
						//intFieldGrp	-columnWidth 1 100 -columnWidth 2 75 -columnWidth 3 75 -numberOfFields 2 -label "Samples"  -value1 0 -value2 0	om_samples;
						//text -l "Contrast " -al "right";
						//floatField -value 0.1 -pre 3 om_contrast;
						//button -l "SET THIS" -c "setAttr miDefaultOptions.minSamples `intFieldGrp -q -v1 om_samples`;setAttr miDefaultOptions.maxSamples `intFieldGrp -q -v2 om_samples`;setAttr miDefaultOptions.contrastR `floatField -q -value om_contrast`;setAttr miDefaultOptions.contrastG `floatField -q -value om_contrast`;setAttr miDefaultOptions.contrastB `floatField -q -value om_contrast`;setAttr miDefaultOptions.contrastA `floatField -q -value om_contrast`" ;
						button -l "Update UI" -c "deleteUI -window om_renderUI_win;source om_renderUI;om_renderUI()";
						button -bgc .5 1 .5 -l "SUBMIT" -c "om_submitSmedge(`radioButtonGrp -q -sl renderDistributor`,`checkBoxGrp -q -v1 advancedOptions`,`radioButtonGrp -q -sl renderApplication`,\"\",`textField -q -text om_smedgeMaxSats`,`checkBoxGrp -q -v2 advancedOptions`,`intSliderGrp -q -v om_smedgePrio`,`textField -q -text om_smedgeUsageLimit`,`textField -q -text om_renderRange`,`textField -q -text om_packetSize`,`textField -q -text om_stepSize`,\"0 2\",`checkBoxGrp -q -v1 useSatellites`,`textField -q -text om_smedgeMaxSats`,`checkBoxGrp -q -v3 advancedOptions`,`checkBoxGrp -q -v1 optionBlock2`,`checkBoxGrp -q -v2 optionBlock2`,`checkBoxGrp -q -v3 optionBlock2`,`textFieldGrp -q -text smedgeExtra`,	`checkBox -q -v useRangePerLayer` , `checkBox -q -v om_renderPreviewFrames` , `textField -q -text om_previewFrames` , `checkBoxGrp -q -v3 advancedOptions` , `checkBox -q -v om_occOnly`);" submitButton;
						checkBox -v 0 -l "Render Preview Frames" om_renderPreviewFrames;
						checkBox -v 0 -l "Occ only" -cc "if ($om_occOnly) button -e -l \"SUBMIT - occ only\" -bgc 1 .5 .5 submitButton; else button -e -l \"SUBMIT\" -bgc .5 1 .5 submitButton;" om_occOnly;
						button -l "Setup Left Eye" -c "om_setupStereo(\"left\")";
						button -l "Setup Right Eye" -c "om_setupStereo(\"right\")";
						button -l "setup filename prefix" -c "om_setImageFilePrefixStereo()";
						
						
					setParent ..;
				

					frameLayout -collapsable 1 -collapse 1 -label ("Advanced Options") -labelAlign "top" -borderStyle "in";
					
						columnLayout;

							checkBoxGrp
									-columnWidth 1 75
									-columnWidth 2 93
									-columnWidth 3 80
									-columnWidth 4 150							
							      	-numberOfCheckBoxes 3
									-label ""
									-label1 "Quit Maya"
									-v1 0
									-label2 "Notify me"
									-en2 1
									-v2 1
									-label3 "Auto RenderRegion"
									-en3 1
									-v3 0
									-on3 "button -e -bgc 1 0.5 0 -l \"SUBMIT - REGION!\" submitButton"
									-of3 "button -e -bgc .5 1 .5 -l \"SUBMIT\" submitButton"									
									advancedOptions;
							
							
							rowColumnLayout -numberOfColumns 4
										-columnWidth 1 260																
										-columnWidth 2 89
										-columnWidth 3 60
										-columnWidth 4 76;
								
								intSliderGrp	-label "Smedge Prio" -field true
												-cw 1 75
												-cw 2 30
												-cw 3 145
											    -minValue 1 -maxValue 100
											    -fieldMinValue 1 -fieldMaxValue 1000
											    -value 50
												om_smedgePrio;
								
								
								
								text -l "   Max. Clients" -al "left";
								textField -en 1 -text "-1" om_smedgeUsageLimit;
								text -l " -1 = all" -enable 0 -al "left";
							
							
								checkBoxGrp
									-columnWidth 1 75
									-columnWidth 2 150
									-numberOfCheckBoxes 1
									-label ""
									-label1 "Use Satellites"
									-v1 1
									-en1 1
									useSatellites;
							
								global string $defaultPool;
								text -en 1 -l "   Pool " -al "left";								
								textField -en 1 -text $defaultPool om_smedgeMaxSats;
								//
								text -l "" -enable 1 -al "left";
								
							setParent ..;
							
							checkBoxGrp
									-columnWidth 1 75
									-columnWidth 2 120									
									-columnWidth 3 150		
									-columnWidth 4 100	
									-numberOfCheckBoxes 3
									-label ""
									-label1 "LOCAL INCLUDES"
									-v1 1
									-en1 1
									-label2 "Submit Job only - no Export"
									-v2 0
									-en2 1
									-label3 "submit directly"
									-v3 0
									-en3 0
									optionBlock2;
							
							textFieldGrp	-cw2 75 370
											-l "Extra Options"
											-text ""
											-en 1
											smedgeExtra;
							
							
						setParent ..;
					setParent ..;
				setParent ..;
			setParent ..;
			
			
			
			
			frameLayout -collapsable 1 -collapse 0 -label ("Common convienience Tools") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 3
								-columnWidth 1 165
								-columnWidth 2 165
								-columnWidth 3 165;
					
					button -w 175 -l "Open ShaderLibrary" -c "source FBI_shaderLibrary;FBI_shaderLibrary(\"//fsrv-muc-01/TEMP/shaderlibrary/\",\"\")";					
					button -w 175 -l "Select Objects without shader" -c "om_selectNonShaded()";					
					button -w 175 -l "Make unique names for selected" -c "om_renameUniqueStart()";
					
					button -w 175 -l "Print ShadingGroup Assignment" -c "om_printShadingGroupAssignments()";					
					button -w 175 -l "Select lowest Level Transforms" -c "string $llt[]=om_getLowestLevelTransforms(`ls -sl`);select -r $llt;";
					button -w 175 -l "--->COSY LAYER WRANGLER<---" -bgc 0.9 0.9 0.75 -c "om_cosyLayerWrangler()";
					
					button -w 175 -l "Uninstance ALL" -c "python(\"import uninstance;uninstance.uninstance()\");";															
					button -w 175 -l "Remove Ref Edits on this node ->" -c "removeShadingGroupReferenceEdits(`textField -q -text referenceNodeText`)";
					textField -w 175 -text "INTRN" referenceNodeText;
					button -w 175 -l "Rename FileTextures" -c "python(\"import FBI_commonConvenienceTools;FBI_commonConvenienceTools.renameFilenodes()\");";															
					
					//button -w 175 -l "Attach to Constrain Object" -c "om_attachToConstrainObject()";
					
			
				setParent ..;
			setParent ..;
			
			
			frameLayout -collapsable 1 -collapse 1 -label ("OLD convienience Tools") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 3
								-columnWidth 1 165
								-columnWidth 2 165
								-columnWidth 3 165;
			
					button -w 175 -l "Add to selected Switch" -c "om_addToSwitch()";
					button -w 175 -l "Duplicate last SwitchInput" -c "om_duplicateLastSwitchInput()";
					//button -w 175 -l "Export Camera to Nuke" -c "om_camToNuke()";
					//button -w 175 - l "ID Manager" -c "om_materialIdManager()";
					button -w 175 -l "Check Filenodes" -c "checkFileNodes()";	
					
					button -w 175 -l "Convert to tilebased EXR" -c "om_makeTiledEXR()";
					button -w 175 -l "Revert to non-tilebased EXR" -c "om_restoreNonTiledEXR()";
					
					button -w 175 -l "Filename to EXR" -c "om_fileTexturesToEXR()";
					button -w 175 -l "Filename to C" -c "om_fileTexturesToC()";
					
							
			
				setParent ..;
			setParent ..;
			
			frameLayout -collapsable 1 -collapse 0 -label ("VRAY convienience Tools") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 3
								-columnWidth 1 165
								-columnWidth 2 165
								-columnWidth 3 165;	
					
					
					//button -w 175 -l "Convert Material to VRayMtl" -c "om_convertShadersToVray()";
					
					button -w 175 -l "Convert VRayMtl to blinn" -c "python(\"import FBI_vrayConvenienceTools;FBI_vrayConvenienceTools.convertVrayMtlToBlinn()\")";
					button -w 175 -l "Convert To VRayMtl - PaulD" -c "source maya2VRay;maya2VRay()";										
					button -w 175 -l "Connect to VrayObjectProperties" -c "om_connectToVrayObjectPropertiesNode(\"\",`ls -sl`)";					
					
					button -w 175 -l "Find highest VrayMaterialID" -c "python(\"import FBI_vrayConvenienceTools;FBI_vrayConvenienceTools.vrayMatIdManager()\");";
					button -w 175 -l "Find Obj without VrayMaterialID" -c "om_findNoMatId()";
					button -w 175 -l "Find Obj without VrayMaterial" -c "om_isNoVRayMtl()";					
					button -w 175 -l "Add Material ID to shadingGroups" -c "om_addMaterialIDtoSG()";
					button -w 175 -l "Set Material ID Values -->" -c "om_setMaterialIDValues(`intFieldGrp	-q -value1 om_startMaterialID`)";
					intFieldGrp -numberOfFields 1 -cw2 50 125 -l "Start-ID"	-value1 1 om_startMaterialID;
					button -w 175 -l "Set Values for multiMatte(Ex)" -c "om_setupMultiMattes()";
					
					
					
					
					
					
	
				setParent ..;
			setParent ..;
					
			frameLayout -collapsable 1 -collapse 0 -label ("VRAY PROXY Tools - select lowest level transforms") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 3
								-columnWidth 1 165
								-columnWidth 2 165
								-columnWidth 3 165;	

					button -w 175 -l "0.Uninstance ALL" -c "python(\"import uninstance;uninstance.uninstance()\");";															
					button -w 175 -l "1.Select lowestLevelTransforms" -c "string $llt[]=om_getLowestLevelTransforms(`ls -sl`);select -r $llt;";
					button -w 175 -l "2.Clean UV Names" -c "om_cleanUpUVSets()";
					button -w 175 -l "3.Merge Verts (SLOW)" -c "om_mergeVertices()";
					button -w 175 -l "4.Create Vray Proxy" -bgc .75 .8 .75 -c "om_createVrayProxy(0,0)";
					button -w 175 -l "5.Remove VRayMeshMaterials" -c "om_removeVrayMeshMaterial()";
					button -w 175 -l "6.Delete expressions/timeToUnit" -c "string $vrMeshes[]= `ls -type VRayMesh`,$expressions[]=`listConnections -type expression $vrMeshes`,$timeToUnit[]=`listConnections -type timeToUnitConversion $vrMeshes`;if (size($expressions)) delete $expressions;if (size($timeToUnit)) delete $timeToUnit;";
					button -w 175 -l ">> 7.Tell Oli to SYNC >>" -bgc .8 .75 .75 -en 1 -c "warning \"Was glaubst du sollte Maya dazu zu sagen haben? 10 Euro in die Strafkasse ;)\"";
					button -w 175 -l "8.Set Proxypath to C:" -c "om_proxyPath()";
					
					//button -w 175 -l "Update Vray Proxy" -c "om_createVrayProxy(0,1)";
					//button -w 175 -l "Create animated Vray Proxy" -c "om_createVrayProxy(1,0)";
					button -w 175 -l "Find Obj without Proxy" -c "om_findObjectsWithoutProxy()";					
					
					
				setParent ..;
			setParent ..;
			
					
					
			frameLayout -collapsable 1 -collapse 1 -label ("3rd Party Stuff") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 3
								-columnWidth 1 165
								-columnWidth 2 165
								-columnWidth 3 165;	
					
					button -w 175 -l "FileTextureManager" -c "FileTextureManager()";
					button -w 175 -l "UVAutoRatioUI" -c "UVAutoRatioUI()";
					button -w 175 -l "Namespace Manager" -c "ks_nameSpaceManager()";
					//button -w 175 -l  0 "LightLink remover (SLOOOOOW)" -c "ks_SaveLightLinkRemover()";
					button -w 175 -l "LightLink remover (OLI)" -c "om_removeLightLinks()";					
					button -w 175 -l "MG_Transfer_Shader" -c "MG_Transfer_Shader()";
					button -w 175 -l "Comet Rename" -c "cometRename()";					
					button -w 175 -l "reverse normal" -c "reallyReverseNormal()";
					button -w 175 -l "Set Utilities" -c "km_setUtilities()";
					button -w 175 -l "spRectileLoc" -c "loadPlugin spReticle_x64;source spReticleLoc;spReticleLocCreate;";
					

				setParent ..;
			setParent ..;
			
			frameLayout -collapsable 1 -collapse 0 -label ("Renderlayer Tools") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 3
								-columnWidth 1 165
								-columnWidth 2 165
								-columnWidth 3 165;	
					
					button -w 175 -l "disable Renderlayers ->" -c "string $rl[]=`listConnections -type renderLayer renderLayerManager`,	$filter=`textFieldGrp -q -text renderLayerFilter`;for ($current in $rl) if (`gmatch $current $filter`) catch(`setAttr ($current+\".renderable\") 0`);";
					textFieldGrp -w 175 -cw2 50 120 -l "Filter " -text "**" renderLayerFilter;					
					button -w 175 -l "<- enable Renderlayers" -c "string $rl[]=`listConnections -type renderLayer renderLayerManager`,	$filter=`textFieldGrp -q -text renderLayerFilter`;for ($current in $rl) if (`gmatch $current $filter`) catch(`setAttr ($current+\".renderable\") 1`);";
					
					button -w 175 -l "ENABLE these objects RL" -c "om_enableRenderlayers()";
					button -w 175 -l "FIND this objects RL" -c "string $vops[]=`listConnections -type VRayObjectProperties`,$renderLayer=`substring $vops[0] 1 (size($vops[0])-4)`; editRenderLayerGlobals -currentRenderLayer $renderLayer;om_findCurrentCosyLayer;";
					button -w 175 -l "Check RenderLayer Overrides" -c "editRenderLayerAdjustment -q -alg";
					
					button -w 175 -l "Check All Material Overrides" -c "om_getMaterialOverrides()";
					button -w 175 -l "TRANSFER Material Overrides" -c "om_transferMaterialOverrides()";
					button -w 175 -l "Remove Material Overrides" -c "om_removeMaterialOverrides()";
					
					
					button -w 175 -l "ALL RENDERLAYERS ON" -bgc 0.75 0.85 0.75 -c "om_enableALLRenderlayers()";
					button -w 175 -l "ALL RENDERLAYERS OFF" -bgc 0.85 0.75 0.75 -c "string $rl[]=`listConnections -type renderLayer renderLayerManager`,	$cmd=\"\"; for ($current in $rl) if (`getAttr ($current+\".renderable\")`) $cmd+=(\"setAttr \"+$current+\".renderable 0;\"); eval($cmd);";
					button -w 175 -l "COUNT RENDERLAYERS" -bgc 0.85 0.85 0.75 -c "string $rl[]=`listConnections -type renderLayer renderLayerManager`;int $counter=0,$size=size($rl);for ($current in $rl) if (`getAttr ($current+\".renderable\")`) $counter++; print ($size +\" layers overall - \"+$counter+\" renderlayers enabled!\");";
					
					button -w 175 -l "PRINT RENDERLAYERS " -c "string $allLayers[] = `listConnections renderLayerManager.renderLayerId`;for ($current in $allLayers) if( `getAttr ($current + \".renderable\")` ) print (\"setAttr \"+$current+ \".renderable 1;\\n\");";
					button -w 175 -l "PRINT DISPLAYLAYERS " -c "string $allLayers[] = `ls -type displayLayer`;for ($current in $allLayers) if( `getAttr ($current + \".visibility\")` ) print (\"setAttr \"+$current+ \".visibility 1;\\n\");";
					button -w 175 -l "SIMPLE EXPORT " -c "om_simpleExport()";
					
					button -w 175 -l "PRINT VOPs PrimVis 0 " -c "string $vops[]=`ls -type VRayObjectProperties`;for ($current in $vops)	if (!`getAttr ($current+\".primaryVisibility\")`)		print ($current+\"\\n\");";
					button -w 175 -l "PRINT VOPs PrimVis 1 " -c "string $vops[]=`ls -type VRayObjectProperties`;for ($current in $vops)	if (`getAttr ($current+\".primaryVisibility\")`)		print ($current+\"\\n\");";
					
					button -w 175 -l "Add FramesToRender" -c "string $currentRenderLayer=`editRenderLayerGlobals -q -currentRenderLayer`;if (!attributeExists (\"framesToRender\", $currentRenderLayer) ) 	addAttr -ln \"framesToRender\"  -dt \"string\"  $currentRenderLayer;";					
					button -w 175 -l "Open RenderDirectory" -c "string $renderDir[] = om_getRenderDir();if (`about -os`!=\"linux64\") system (\"explorer \"+toNativePath($renderDir[0])); else system (\"nautilus \"+toNativePath($renderDir[0]));";					
					button -w 175 -l "Setup RL for distributed render" -c "string $currentRenderLayer=`editRenderLayerGlobals -q -currentRenderLayer`;if (!attributeExists (\"renderDistributed\", $currentRenderLayer) ) 	addAttr -ln \"renderDistributed\"  -at bool  $currentRenderLayer; setAttr ($currentRenderLayer+\".renderDistributed\") 1;";
					button -w 175 -l "Render Double Resolution for RL" -c "string $currentRenderLayer=`editRenderLayerGlobals -q -currentRenderLayer`;if (!attributeExists (\"renderDoubleResolution\", $currentRenderLayer) ) 	addAttr -ln \"renderDoubleResolution\"  -at bool  $currentRenderLayer; setAttr ($currentRenderLayer+\".renderDoubleResolution\") 1;";
					
					
					//button -w 175 -l "Remove Material RefEdits" -c "om_removeMaterialOverridesFromReference()";
					

								
				setParent ..;
			setParent ..; 
			
			frameLayout -collapsable 1 -collapse 1 -label ("Occlusion Pass Tools") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 3
								-columnWidth 1 165
								-columnWidth 2 165
								-columnWidth 3 165;	
					button -w 175 -l "Setup Extra-OCCLUSION" -c "om_createOcclusion()";
					button -w 175 -l "Disconnect Extra-OCCLUSION" -c "om_disconnectOcclusion()";
					button -w 175 -l "Print Frames with Occlusion" -c "om_printFramesWithOcclusion()";
					
					button -w 175 -l "Rerender OCC on this layers" -c "om_rerenderOcclusion()";
					
					
				setParent ..;
			setParent ..;					

			frameLayout -collapsable 1 -collapse 1 -label ("Mini - 2011 - Tools") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 3
								-columnWidth 1 165
								-columnWidth 2 165
								-columnWidth 3 165;	
					button -w 175 -l "MINI-TURN"           -c "source setup_MINI;setup_MINI(\"turn\");";
					button -w 175 -l "MINI-DASH"           -c "source setup_MINI;setup_MINI(\"dash\");";
					button -w 175 -l "MINI-DOOR"           -c "source setup_MINI;setup_MINI(\"door\");";
					button -w 175 -l "MINI-PANO"           -c "source setup_MINI;setup_MINI(\"pano\");";
					
					
				setParent ..;
			setParent ..;
			
			
			frameLayout -collapsable 1 -collapse 1 -label ("VW - 2011 - Tools") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 3
								-columnWidth 1 165
								-columnWidth 2 165
								-columnWidth 3 165;	
					button -w 175 -l "EXT"           -c "source setup_VW;setup_VW(\"ext\");";
					button -w 175 -l "FELGENICONS"           -c "source setup_VW;setup_VW(\"felgenicons\");";
					button -w 175 -l "COCKPIT"           -c "source setup_VW;setup_VW(\"cockpit\");";
					button -w 175 -l "SUPERSIZE"           -c "source setup_VW;setup_VW(\"supersize\");";
					button -w 175 -l "STATISCH INT"           -c "source setup_VW;setup_VW(\"statischInt\");";
					button -w 175 -l "STATISCH EXT"           -c "source setup_VW;setup_VW(\"statischExt\");";
					button -w 175 -l "MASTER INT"           -c "source setup_VW;setup_VW(\"masterInt\");";
					button -w 175 -l "MASTER EXT"           -c "source setup_VW;setup_VW(\"masterExt\");";
					
					
				setParent ..;
			setParent ..;

			
			frameLayout -collapsable 1 -collapse 1 -label ("VW Tools") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 3
								-columnWidth 1 165
								-columnWidth 2 165
								-columnWidth 3 165;	
					button -w 175 -l "SETUP GOLF_EXT" -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;currentTime 1;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"1-3\" om_renderRange;textField -e -text \"1\" om_previewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;   setAttr -type \"string\" vraySettings.batchCamera \"GOLF:cam_golf_ext\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"GOLF_EXT/<Layer>/<Scene>/GOLF_EXT-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";				
					button -w 175 -l "SETUP GOLF_EXT_4" -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;currentTime 4;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"4\" om_renderRange;textField -e -text \"4\" om_previewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;   setAttr -type \"string\" vraySettings.batchCamera \"GOLF:cam_golf_ext_frame_4\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"GOLF_EXT/<Layer>/<Scene>/GOLF_EXT-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";				
					button -w 175 -l "SETUP GOLF_COCKPIT" -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 0 ;textField -e -text \"0\" om_renderRange;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INT:cam_dashboard\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"GOLF_COCKPIT/<Layer>/<Scene>/GOLF_COCKPIT-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -l "" -en 0;  
					button -w 175 -l "" -en 0;  
					button -w 175 -l "SETUP GOLF_FULL_WIDTH" -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 10 ;textField -e -text \"10\" om_renderRange;                                             setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INT:cam_full_width\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"GOLF_FULL_WIDTH/<Layer>/<Scene>/GOLF_FULL_WIDTH-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";

					button -w 175 -l "SETUP EOS_EXT" -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"1-4\" om_renderRange;textField -e -text \"1\" om_previewFrames;                                                                  setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;   setAttr -type \"string\" vraySettings.batchCamera \"INT:ext_cameras\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"EOS_EXT/<Layer>/<Scene>/EOS_EXT-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";				
					//button -w 175 -l "SETUP EOS_EXT_FRONT" -c "setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"3\" om_renderRange;textField -e -text \"1\" om_previewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;   setAttr -type \"string\" vraySettings.batchCamera \"INT:ext_camera_front\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"EOS_EXT/<Layer>/<Scene>/EOS_EXT-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";				
					button -w 175 -l "SETUP EOS_COCKPIT"    -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 0 ;textField -e -text \"0\" om_renderRange;                                                setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INT:cam_dashboard\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"EOS_COCKPIT/<Layer>/<Scene>/EOS_COCKPIT-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -l "SETUP EOS_FULL_WIDTH" -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 10 ;textField -e -text \"10\" om_renderRange;                                              setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INT:cam_full_width\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"EOS_FULL-WIDTH/<Layer>/<Scene>/EOS_FULL-WIDTH-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					
					button -w 175 -l "SETUP TIGUAN_EXT"     -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"1-4\" om_renderRange;textField -e -text \"1\" om_previewFrames;                                                           setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;   setAttr -type \"string\" vraySettings.batchCamera \"INT:ext_cameras\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"TIGUAN_EXT/<Layer>/<Scene>/TIGUAN_EXT-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";				
					button -w 175 -l "SETUP TIGUAN_COCKPIT" -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 0 ;textField -e -text \"0\" om_renderRange;                                                setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INT:cam_dashboard\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"TIGUAN_COCKPIT/<Layer>/<Scene>/TIGUAN_COCKPIT-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -l "SETUP TIGUAN_FULL_WIDTH" -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 10 ;textField -e -text \"10\" om_renderRange;                                           setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INT:cam_full_width\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"TIGUAN_FULL-WIDTH/<Layer>/<Scene>/TIGUAN_FULL-WIDTH-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -l "SETUP TIGUAN GP EXT"     -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"1\" om_renderRange;textField -e -text \"1\" om_previewFrames;                                                           setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;   setAttr -type \"string\" vraySettings.batchCamera \"LIGHTING:ext_cameras\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 20;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"TIGUAN_GP_EXT/<Layer>/<Scene>/TIGUAN_GP_EXT-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 0.75;";
					
					button -w 175 -l "SETUP JSW_EXT"        -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;                                        unifiedRenderGlobalsWindow; setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;               textField -e -text \"1-4\" om_renderRange;textField -e -text \"1\" om_previewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;    setAttr -type \"string\" vraySettings.batchCamera \"JSW:ext_cameras\";	    setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.003; string $fileNamePrefix=\"JSW_EXT/<Layer>/<Scene>/JSW_EXT-<Layer>.\";          textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";				
					button -w 175 -l "SETUP JSW_COCKPIT"    -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow; setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 0 ;textField -e -text \"0\" om_renderRange;                                               setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"JSW_INT:cam_dashboard\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"JSW_COCKPIT/<Layer>/<Scene>/JSW_COCKPIT-<Layer>.\";  textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -l "SETUP JSW_FULL_WIDTH" -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow; setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 10;textField -e -text \"10\" om_renderRange;                                              setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"JSW_INT:cam_full_width\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"JSW_FULL-WIDTH/<Layer>/<Scene>/JSW_FULL-WIDTH-<Layer>.\";  textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					
					button -w 175 -l "SETUP NCS_EXT" -c        "textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow; setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;               textField -e -text \"1-4\" om_renderRange;textField -e -text \"1\" om_previewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;    setAttr -type \"string\" vraySettings.batchCamera \"EXT:ext_cameras\";	    setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"NCS_EXT/<Layer>/<Scene>/NCS_EXT-<Layer>.\";          textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";				
					button -w 175 -l "SETUP NCS_COCKPIT" -c    "textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow; setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 0 ;textField -e -text \"0\" om_renderRange;                                               setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INT:cam_dashboard\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"NCS_COCKPIT/<Layer>/<Scene>/NCS_COCKPIT-<Layer>.\";  textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -l "SETUP NCS_FULL_WIDTH" -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow; setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 10;textField -e -text \"10\" om_renderRange;                                              setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INT:cam_full_width\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"NCS_FULL-WIDTH/<Layer>/<Scene>/NCS_FULL-WIDTH-<Layer>.\";  textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					
					button -w 175 -l "SETUP TOUAREG_EXT"     -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"1-4\" om_renderRange;textField -e -text \"1\" om_previewFrames;                                                           setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;   setAttr -type \"string\" vraySettings.batchCamera \"EXT:ext_cameras\";	    setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"TOUAREG_EXT/<Layer>/<Scene>/TOUAREG_EXT-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";				
					button -w 175 -l "SETUP TOUAREG_COCKPIT" -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 0 ;textField -e -text \"0\" om_renderRange;                                                setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"Int:cam_dashboard\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"TOUAREG_COCKPIT/<Layer>/<Scene>/TOUAREG_COCKPIT-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -l "SETUP TOUAREG_FULL_WIDTH" -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 10 ;textField -e -text \"10\" om_renderRange;                                           setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"Int:cam_full_width\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"TOUAREG_FULL-WIDTH/<Layer>/<Scene>/TOUAREG_FULL-WIDTH-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					
					button -w 175 -l "SETUP ROUTAN_EXT" -c        "textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow; setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;               textField -e -text \"1-4\" om_renderRange;textField -e -text \"1\" om_previewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;    setAttr -type \"string\" vraySettings.batchCamera \"EXT:ext_cameras\";	    setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"ROUTAN_EXT/<Layer>/<Scene>/ROUTAN_EXT-<Layer>.\";          textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;string $vops[]=`ls -type VRayObjectProperties`;for ($current in $vops) setAttr ($current+\".noGIOnOtherMattes\") 0;";
					button -w 175 -l "SETUP ROUTAN_COCKPIT" -c    "textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow; setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 0 ;textField -e -text \"0\" om_renderRange;                                               setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INT:cam_dashboard\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"ROUTAN_COCKPIT/<Layer>/<Scene>/ROUTAN_COCKPIT-<Layer>.\";  textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;string $vops[]=`ls -type VRayObjectProperties`;for ($current in $vops) setAttr ($current+\".noGIOnOtherMattes\") 0;";
					button -w 175 -l "SETUP ROUTAN_FULL_WIDTH" -c "om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow; setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 10;textField -e -text \"10\" om_renderRange;                                              setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2536;setAttr defaultResolution.height 1426;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2536;	setAttr vraySettings.height 1426;	setAttr defaultResolution.deviceAspectRatio 1.778;setAttr vraySettings.aspectRatio 1.778;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INT:cam_full_width\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"ROUTAN_FULL-WIDTH/<Layer>/<Scene>/ROUTAN_FULL-WIDTH-<Layer>.\";  textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;string $vops[]=`ls -type VRayObjectProperties`;for ($current in $vops) setAttr ($current+\".noGIOnOtherMattes\") 0;";
					
					
					//FR NEUE BUTTONS -> 1. camera name ndern 2. framerange anpassen 3. OutputFilename aendern
				setParent ..;
			setParent ..;
			
			
			
			frameLayout -collapsable 1 -collapse 1 -label ("F20 - BMW 1er Tools") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 3
								-columnWidth 1 165
								-columnWidth 2 165
								-columnWidth 3 165;	
					button -w 175 -l "SETUP F20-DASH"           -c "source setup_f20;setup_f20(\"dash\");";
					button -w 175 -l "SETUP F20-DOOR"           -c "source setup_f20;setup_f20(\"door\");";
					button -w 175 -l "SETUP F20-SEAT"           -c "source setup_f20;setup_f20(\"seat\");";
					
					button -w 175 -l "SETUP F20-TURN"           -c "source setup_f20;setup_f20(\"turn\");";
					button -w 175 -l "SETUP F20-TURN PREVIEW"   -c "source setup_f20;setup_f20(\"turnpreview\");	 string $fileNamePrefix=\"F20-TURN-PREVIEW/<Layer>/<Scene>/F20-TURN-PREVIEW<Layer>-FH.\";    textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();";
					button -w 175 -l "SETUP F20-PANO"           -c "source setup_f20;setup_f20(\"pano\");";
					button -w 175 -l "SETUP F20-FELGENANIM" 	-c "source setup_f20;setup_f20(\"felgenanim\");";
					button -w 175 -en 0 -l "SETUP F20-FELGENICONS"    -c "source setup_f20;setup_f20(\"felgenicons\");";
					
					
				setParent ..;
			setParent ..;
			
			frameLayout -collapsable 1 -collapse 1 -label ("E8x - BMW 1er Tools") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 3
								-columnWidth 1 165
								-columnWidth 2 165
								-columnWidth 3 165;	
					button -w 175 -l "SETUP E8x-DASH" -c "om_allCamsOff;checkBoxGrp -e -v3 1 advancedOptions;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.imap_mode 0;setAttr vraySettings.mode 0;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 1 ;textField -e -text \"1\" om_renderRange;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2000;setAttr defaultResolution.height 1200;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2000;	setAttr vraySettings.height 1200;	setAttr defaultResolution.deviceAspectRatio 1.6666666667;setAttr vraySettings.aspectRatio 1.6666666667;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INTEXT:cam_dash\";	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005;setAttr vraySettings.imap_minRate -3;setAttr vraySettings.imap_maxRate 0;setAttr vraySettings.imap_subdivs 100;setAttr vraySettings.imap_interpSamples 100; string $fileNamePrefix=\"E8x-DASH/<Layer>/<Scene>/E8x-DASH-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;string $vops[]=`ls -type VRayObjectProperties`;for ($current in $vops) setAttr ($current+\".noGIOnOtherMattes\") 0;";
					button -w 175 -l "SETUP E8x-DOOR" -c "om_allCamsOff;checkBoxGrp -e -v3 1 advancedOptions;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.imap_mode 0;setAttr vraySettings.mode 0;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 2 ;textField -e -text \"2\" om_renderRange;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2000;setAttr defaultResolution.height 1200;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2000;	setAttr vraySettings.height 1200;	setAttr defaultResolution.deviceAspectRatio 1.6666666667;setAttr vraySettings.aspectRatio 1.6666666667;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INTEXT:cam_door\";	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005;setAttr vraySettings.imap_minRate -3;setAttr vraySettings.imap_maxRate 0;setAttr vraySettings.imap_subdivs 100;setAttr vraySettings.imap_interpSamples 100; string $fileNamePrefix=\"E8x-DOOR/<Layer>/<Scene>/E8x-DOOR-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;string $vops[]=`ls -type VRayObjectProperties`;for ($current in $vops) setAttr ($current+\".noGIOnOtherMattes\") 0;";
					button -w 175 -l "SETUP E8x-SEAT" -c "om_allCamsOff;checkBoxGrp -e -v3 0 advancedOptions;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.imap_mode 0;setAttr vraySettings.mode 0;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 2 ;textField -e -text \"2\" om_renderRange;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2000;setAttr defaultResolution.height 1200;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2000;	setAttr vraySettings.height 1200;	setAttr defaultResolution.deviceAspectRatio 1.6666666667;setAttr vraySettings.aspectRatio 1.6666666667;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INTEXT:cam_seat\";	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005;setAttr vraySettings.imap_minRate -3;setAttr vraySettings.imap_maxRate 0;setAttr vraySettings.imap_subdivs 100;setAttr vraySettings.imap_interpSamples 100; string $fileNamePrefix=\"E8x-SEAT/<Layer>/<Scene>/E8x-SEAT-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;string $vops[]=`ls -type VRayObjectProperties`;for ($current in $vops) setAttr ($current+\".noGIOnOtherMattes\") 0;";

										
					button -w 175 -l "SETUP E8x-TURN"   -c "setAttr vraySettings.cam_mbOn 0;om_allCamsOff;textField -e -text cluster_A om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 1;setAttr vraySettings.useCameraPath 1;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"1-36\" om_renderRange;textField -e -text \"10,13,19,28,31\" om_previewFrames;checkBox -e -v 1 om_renderPreviewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2560;setAttr defaultResolution.height 1536;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2560;	setAttr vraySettings.height 1536;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.6666666667;setAttr vraySettings.aspectRatio 1.6666666667;   setAttr -type \"string\" vraySettings.batchCamera \"E8x_cam_turn\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"E8x-TURN/<Layer>/<Scene>/E8x-TURN-<Layer>-FH.\";    textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -l "SETUP E8x-TURN NCC"   -c "currentTime 37;playbackOptions -min 1;playbackOptions -max 52;setAttr vraySettings.cam_mbOn 0;om_allCamsOff;textField -e -text cluster_A om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 1;setAttr vraySettings.useCameraPath 1;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"15,32,37-52\" om_renderRange;textField -e -text \"15,32,37,40,44,45,48,52\" om_previewFrames;checkBox -e -v 1 om_renderPreviewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2560;setAttr defaultResolution.height 1536;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2560;	setAttr vraySettings.height 1536;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.6666666667;setAttr vraySettings.aspectRatio 1.6666666667;   setAttr -type \"string\" vraySettings.batchCamera \"CAM:E8x_cam_turn_NCC\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"E8x-TURN/<Layer>/<Scene>/E8x-TURN-<Layer>-FH.\";    textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -l "SETUP E8x-PANO" -c "om_allCamsOff;checkBoxGrp -e -v3 1 advancedOptions;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.imap_mode 0;setAttr vraySettings.mode 0;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 3 ;textField -e -text \"3\" om_renderRange;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 7000;setAttr defaultResolution.height 3500;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 7000;	setAttr vraySettings.height 3500;	setAttr defaultResolution.deviceAspectRatio 2;           setAttr vraySettings.aspectRatio 2;             vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INTEXT:cam_pano\";	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 50;	setAttr vraySettings.dmcThreshold 0.005;setAttr vraySettings.imap_minRate -4;setAttr vraySettings.imap_maxRate -1;setAttr vraySettings.imap_subdivs 75;setAttr vraySettings.imap_interpSamples 75; string $fileNamePrefix=\"E8x-PANO/<Layer>/<Scene>/E8x-PANO-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;string $vops[]=`ls -type VRayObjectProperties`;for ($current in $vops) setAttr ($current+\".noGIOnOtherMattes\") 0;";
					
					
					button -w 175 -l "SETUP E8x-FELGENANIM"   -c "currentTime 991;playbackOptions -min 991;playbackOptions -max 1043;setAttr vraySettings.cam_mbOn 1;setAttr vraySettings.cam_mbDuration 0.5; om_allCamsOff;textField -e -text cluster_A om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"991-1043\" om_renderRange;textField -e -text \"1000,1018\" om_previewFrames;checkBox -e -v 1 om_renderPreviewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2560;setAttr defaultResolution.height 1536;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2560;	setAttr vraySettings.height 1536;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.6666666667;setAttr vraySettings.aspectRatio 1.6666666667;   setAttr -type \"string\" vraySettings.batchCamera \"CAM_FELGEN_ANIM:E8x_cam_turn_NCC\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"E8x-FELGEN-ANIMATION/<Layer>/<Scene>/E8x-FELGEN-ANIMATION-<Layer>-FH.\";    textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -l "SETUP E8x-FELGENICONS" -c "setAttr vraySettings.cam_mbOn 0;                                          om_allCamsOff;textField -e -text cluster_B om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"1\" om_renderRange;textField -e -text \"10,13,19,28,31\" om_previewFrames;checkBox -e -v 0 om_renderPreviewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 1200;setAttr defaultResolution.height 1200;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 1200;	setAttr vraySettings.height 1200;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.0         ;setAttr vraySettings.aspectRatio 1.0;            setAttr -type \"string\" vraySettings.batchCamera \"felgenCam1\";	    setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"E8x-FELGEN/<Layer>/<Scene>/E8x-FELGEN-<Layer>-FH.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;string $vops[]=`ls -type VRayObjectProperties`;for ($current in $vops) setAttr ($current+\".noGIOnOtherMattes\") 0;";
					
					
				setParent ..;
			setParent ..;
			
			frameLayout -collapsable 1 -collapse 1 -label ("MINI Tools") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 3
								-columnWidth 1 165
								-columnWidth 2 165
								-columnWidth 3 165;	
					button -w 175 -l "SETUP R5x-DASH" -c "om_allCamsOff;textField -e -text cluster_A om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 1 ;textField -e -text \"1\" om_renderRange;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2560;setAttr defaultResolution.height 1920;setAttr defaultResolution.pixelAspect 1;   setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2560;	setAttr vraySettings.height 1920;	setAttr defaultResolution.deviceAspectRatio 1.333333;setAttr vraySettings.aspectRatio 1.333333;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INT:r5x_cam_dash\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"R5x-DASH/<Layer>/<Scene>/R5x-DASH-<Layer>-PM.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -l "SETUP R5x-DOOR" -c "om_allCamsOff;textField -e -text cluster_A om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 2 ;textField -e -text \"2\" om_renderRange;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2560;setAttr defaultResolution.height 1920;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2560;	setAttr vraySettings.height 1920;	setAttr defaultResolution.deviceAspectRatio 1.333333;setAttr vraySettings.aspectRatio 1.333333;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INT:r5x_cam_door\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"R5x-DOOR/<Layer>/<Scene>/R5x-DOOR-<Layer>-PM.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -l "SETUP R5x-PANO" -c "om_allCamsOff;textField -e -text cluster_A om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 3 ;textField -e -text \"3\" om_renderRange;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 7000;setAttr defaultResolution.height 3500;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 7000;	setAttr vraySettings.height 3500;	setAttr defaultResolution.deviceAspectRatio 2;setAttr vraySettings.aspectRatio 2;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"INT:r5x_cam_pano\";	setAttr vraySettings.cam_type 1;	setAttr vraySettings.cam_overrideFov 1;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"R5x-PANO/<Layer>/<Scene>/R5x-PANO-<Layer>-PM.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					
					button -w 175 -bgc 0.85 0.8 0.75 -l "SETUP R60-DASH" -c "om_allCamsOff;textField -e -text cluster_A om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 1 ;textField -e -text \"1\" om_renderRange;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2560;setAttr defaultResolution.height 1920;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2560;	setAttr vraySettings.height 1920;	setAttr defaultResolution.deviceAspectRatio 1.333333;setAttr vraySettings.aspectRatio 1.333333;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"R60:r60_cam_dash\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"R60-DASH/<Layer>/<Scene>/R60-DASH-<Layer>-PM.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -bgc 0.85 0.8 0.75 -l "SETUP R60-DOOR" -c "om_allCamsOff;textField -e -text cluster_A om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 2 ;textField -e -text \"2\" om_renderRange;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2560;setAttr defaultResolution.height 1920;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2560;	setAttr vraySettings.height 1920;	setAttr defaultResolution.deviceAspectRatio 1.333333;setAttr vraySettings.aspectRatio 1.333333;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"R60:r60_cam_door\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"R60-DOOR/<Layer>/<Scene>/R60-DOOR-<Layer>-PM.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -bgc 0.85 0.8 0.75 -l "SETUP R60-PANO" -c "om_allCamsOff;textField -e -text cluster_A om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;checkBox -e -v 0 om_renderPreviewFrames;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;currentTime 3 ;textField -e -text \"3\" om_renderRange;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 7000;setAttr defaultResolution.height 3500;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 7000;	setAttr vraySettings.height 3500;	setAttr defaultResolution.deviceAspectRatio 2;setAttr vraySettings.aspectRatio 2;                vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"R60:r60_cam_pano\";	setAttr vraySettings.cam_type 1;	setAttr vraySettings.cam_overrideFov 1;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 100;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"R60-PANO/<Layer>/<Scene>/R60-PANO-<Layer>-PM.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";

					button -w 175 -l "SETUP R5x-TURN" -c "om_allCamsOff;textField -e -text cluster_A om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 1;setAttr vraySettings.useCameraPath 1;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"1-36\" om_renderRange;textField -e -text \"3,13,25,28\" om_previewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2560;setAttr defaultResolution.height 1920;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2560;	setAttr vraySettings.height 1920;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.333333;setAttr vraySettings.aspectRatio 1.333333;   setAttr -type \"string\" vraySettings.batchCamera \"EXT:CAM:R55_TURN_CAM\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"R5x-TURN/<Layer>/<Scene>/R5x-TURN-<Layer>-FH.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -bgc 0.85 0.8 0.75 -l "SETUP R60-TURN" -c "om_allCamsOff;textField -e -text cluster_A om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 1;setAttr vraySettings.useCameraPath 1;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"1-36\" om_renderRange;textField -e -text \"3,13,25,28\" om_previewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2560;setAttr defaultResolution.height 1920;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2560;	setAttr vraySettings.height 1920;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.333333;setAttr vraySettings.aspectRatio 1.333333;   setAttr -type \"string\" vraySettings.batchCamera \"R60:cam_turn_r60\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"R60-TURN/<Layer>/<Scene>/R60-TURN-<Layer>-OM.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -bgc 0.9 0.9 0.75 -l "SETUP PREVIEW" -c "om_allCamsOff;textField -e -text cluster_A om_smedgeMaxSats;setAttr defaultRenderGlobals.animation 0;setAttr vraySettings.relements_enableall 0;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 0;setAttr vraySettings.dmcThreshold 0.01;setAttr vraySettings.dmcMaxSubdivs 15;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.mode 0;setAttr vraySettings.imap_mode 0;string $fileNamePrefix=\"SANDBOX/<Layer>/<Scene>/SANDBOX-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();";

					button -w 175 -l "SETUP R5x-FELGEN" -c                      "textField -e -text cluster_A om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"1\" om_renderRange;textField -e -text \"1\" om_previewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 1200;setAttr defaultResolution.height 1200;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 1200;	setAttr vraySettings.height 1200;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.0;setAttr vraySettings.aspectRatio 1.0;   setAttr -type \"string\" vraySettings.batchCamera \"felgenCam1\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"R5x-FELGEN/<Layer>/<Scene>/R5x-FELGEN-<Layer>-PM.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -bgc 0.85 0.8 0.75 -l "SETUP R60-ZUBEHOER" -c "om_allCamsOff;textField -e -text cluster_A om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 1;setAttr vraySettings.useCameraPath 1;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"1-36\" om_renderRange;textField -e -text \"3,13,25,28\" om_previewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 2560;setAttr defaultResolution.height 1920;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 2560;	setAttr vraySettings.height 1920;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.333333;setAttr vraySettings.aspectRatio 1.333333;   setAttr -type \"string\" vraySettings.batchCamera \"R60:cam_turn_r60\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"R60-TURN-ZUBEHOER/<Layer>/<Scene>/R60-TURN-ZUBEHOER-<Layer>-OM.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -l "SETUP R60-FELGEN" -c                      "textField -e -text cluster_A om_smedgeMaxSats;setAttr vraySettings.relements_enableall 1;unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.imap_useCameraPath 0;setAttr vraySettings.useCameraPath 0;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"1\" om_renderRange;textField -e -text \"1\" om_previewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 1200;setAttr defaultResolution.height 1200;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 1200;	setAttr vraySettings.height 1200;	vrayUpdateResolution;	setAttr defaultResolution.deviceAspectRatio 1.0;setAttr vraySettings.aspectRatio 1.0;   setAttr -type \"string\" vraySettings.batchCamera \"felgenCam1\";	setAttr vraySettings.cam_type 0;	setAttr vraySettings.cam_overrideFov 0;	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"R60-FELGEN/<Layer>/<Scene>/R60-FELGEN-<Layer>-PM.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					
				setParent ..;
			setParent ..;
			
			
			/*frameLayout -collapsable 1 -collapse 1 -label ("Toyota Tools") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 3
								-columnWidth 1 165
								-columnWidth 2 165
								-columnWidth 3 165;	
					button -w 175 -bgc 0.85 0.8 0.75 -l "SETUP TURN_TOTALE" -c "setAttr defaultRenderGlobals.animation 1;setAttr vraySettings.relements_enableall 1; unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"1\" om_renderRange;textField -e -text \"1-36\" om_renderRange;textField -e -text \"1,8,16,20,28,34\" om_previewFrames;   setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 1024;setAttr defaultResolution.height 1200;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 1024;	setAttr vraySettings.height 1200;	setAttr defaultResolution.deviceAspectRatio 0.853;setAttr vraySettings.aspectRatio 0.853;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"camera\";							setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"TURN_TOTALE/<Layer>/<Scene>/TURN_TOTALE-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -bgc 0.85 0.8 0.75 -l "SETUP TURN_CLOSE" -c "setAttr defaultRenderGlobals.animation 1;setAttr vraySettings.relements_enableall 1;  unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1; textField -e -text \"2\" om_renderRange;textField -e -text \"2-19\" om_renderRange;textField -e -text \"2,9,17\" om_previewFrames;            setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 1920;setAttr defaultResolution.height 1200;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 1920;	setAttr vraySettings.height 1200;	setAttr defaultResolution.deviceAspectRatio 1.6;setAttr vraySettings.aspectRatio 1.6;  vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"closeUp_camera\";							setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"TURN_CLOSE/<Layer>/<Scene>/TURN_CLOSE-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";
					button -w 175 -bgc 0.85 0.8 0.75 -l "SETUP SITZFLAECHE" -c "setAttr defaultRenderGlobals.animation 1;setAttr vraySettings.relements_enableall 1; unifiedRenderGlobalsWindow;setAttr vraySettings.giOn 1;setAttr vraySettings.imgOpt_exr_bitsPerChannel 32;setAttr vraySettings.useForGlossy 1;setAttr vraySettings.numPasses 16;setAttr vraySettings.subdivs 1000;setAttr vraySettings.sampleSize 0.03;setAttr vraySettings.imap_multipass 1;textField -e -text \"3\" om_renderRange;textField -e -text \"37-54\" om_renderRange;textField -e -text \"39,46,54\" om_previewFrames;         setAttr defaultResolution.aspectLock 0;setAttr defaultResolution.width 1920;setAttr defaultResolution.height 1200;setAttr defaultResolution.pixelAspect 1;	setAttr vraySettings.aspectLock 0;	setAttr vraySettings.width 1920;	setAttr vraySettings.height 1200;	setAttr defaultResolution.deviceAspectRatio 1.600;setAttr vraySettings.aspectRatio 1.600;                vrayUpdateResolution;	setAttr -type \"string\" vraySettings.batchCamera \"sitzflaeche_camera\";	setAttr vraySettings.cam_fov 360;	setAttr vraySettings.samplerType 1;	setAttr vraySettings.dmcMinSubdivs 1;	setAttr vraySettings.dmcMaxSubdivs 30;	setAttr vraySettings.dmcThreshold 0.005; string $fileNamePrefix=\"SITZFLAECHE/<Layer>/<Scene>/SITZFLAECHE-<Layer>.\";textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix;setAttr -type \"string\" vraySettings.fileNamePrefix $fileNamePrefix;vrayChangeFileNamePrefix();setAttr vraySettings.sys_rayc_dynMemLimit 8000;setAttr vraySettings.sys_regsgen_xc 32;setAttr vraySettings.dmcs_adaptiveAmount 1;";

				setParent ..;
			setParent ..;
			
			
			frameLayout -collapsable 1 -collapse 1 -label ("MentalRay - Scene Division") -labelAlign "top" -borderStyle "in";
				rowColumnLayout	-numberOfColumns 2
								-columnWidth 1 225
								-columnWidth 2 100;
					button -l "Assign \"miExportLocation\"-Attribute" -c "assignExportLocationAttribute()";
					button -l "Remove Attr" -c "string $sel[]=`ls -sl -type transform`;deleteAttr ($sel[0]+\".miExportLocation\") ;deleteAttr ($sel[0]+\".miReExport\");";
				setParent ..;
			setParent ..;
						
			*/
			
	setParent ..;


	

	//SET MR-EXPORT VERBOSITY TO ERROR MESSAGES ONLY	
	if (attributeExists ("exportVerbosity", "mentalrayGlobals"))
		setAttr mentalrayGlobals.exportVerbosity 2;


	//CHECK IF ANY SPHERON NAMED TRANSFORM IS IN THE SCENE
	//string $spheron[]=`ls -type transform`;
	//for ($current in $spheron) {
		//if ((`gmatch $current "*pheron*"`) && (`getAttr ($current+".visibility")`)) {
			//checkBoxGrp -e -v1 1 advancedOptions;
			//break;
			//}
		//}

	if (attributeExists ("smedgePool", "defaultRenderLayer"))
		textField -e -text `getAttr defaultRenderLayer.smedgePool` om_smedgeMaxSats;

	
	showWindow om_renderUI_win;
	
	}
	
	//SET MI SAMPLES IF THEY EXIST
	//if (`objExists miDefaultOptions`) {
		//intFieldGrp	-e -value1 `getAttr miDefaultOptions.minSamples` -value2 `getAttr miDefaultOptions.maxSamples`	om_samples;
		//floatField -e -value `getAttr miDefaultOptions.contrastR` om_contrast;
		//}
}






global proc string om_submitSmedge(string $renderDistributor,int $quitMaya, string $application, string $waitFor, string $pool,string $notify,string $priority,string $usageLimit,string $range,int $packetSize,int $stepSize,string $samples,int $useHosts, string $maxHosts, string $region, int $localIncludes, int $submitJobOnly, int $submitDirectAfterExport, string $smedgeExtraFromUI, int $useRenderLayerRange , int $om_renderPreviewFrames, string $om_previewFrames , int $autoRenderRegion , int $om_occOnly)
{
	//AUTO SETUP SCENE
	//FORCE CORRECT VRAY IMG PREFIX
	//om_setImageFilePrefixStereo();
	//SET 32BIT FRAMEBUFFER
	//setAttr vraySettings.imgOpt_exr_bitsPerChannel 16;
	
	//SET MULTICHANNEL EXR
	setAttr -type "string" vraySettings.imageFormatStr "exr (multichannel)";
	
	//SET DEFAULT SUBDIVS
	setAttr "vraySettings.ddisplac_maxSubdivs" 2;
	
	if (!`getAttr defaultRenderGlobals.renderAll`)
		error "DISABLE RENDER SELECTED!!!";
	
	//COSY SPECIFIC - CHECK IF ALL OBJECTS ARE AT LEAST CONNECTED TO default_VOP
	string $unconnected[]=om_findObjectsWithoutVOP();
	$numUnconnected=size($unconnected);
	if ($numUnconnected)
	  if (!`about -batch`)
		if (`confirmDialog -title "Confirm" -message ("You have "+$numUnconnected+" objects which are not connect to any VOP.\Submit anyway?") -button "Yes" -button "No" -defaultButton "No" -cancelButton "No" -dismissString "No"`=="No") {
			select -r $unconnected;
			error "10 Euro in die Strafkasse!";			
		}	
	//DISCONNECT OCCLUSION
	om_disconnectOcclusion();
	
	global string $submit,$RRsubmit;
	string $mergePSD;
	
	//DELETE FROM HERE
	//int $om_renderPreviewFrames, string $om_previewFrames,int $autoRenderRegion,int $om_occOnly
	//`checkBox -q -v om_renderPreviewFrames` , `textField -q -text om_previewFrames` , `checkBoxGrp -q -v3 advancedOptions` , `checkBox -q -v om_occOnly`
	//TMPint $autoRenderRegion=`checkBoxGrp -q -v3 advancedOptions`;
	//TMPstring $om_previewFrames=`textField -q -text om_previewFrames`;
	//int $om_renderPreviewFrames=`checkBox -q -v om_renderPreviewFrames`
	//int om_occOnly=0`checkBox -q -v om_occOnly`;
	//int $om_occOnly=0;
	//int $om_renderPreviewFrames=1;
	//string $om_previewFrames="37,52";
	//int $autoRenderRegion=0;
	//DELETE TO HERE
	
	float	$vrayRenderRegionXXYY[];
	string $vrayRenderRegionString=("\"none\"");
	
	if ($quitMaya)
		if (`confirmDialog -title "Confirm" -message ("Force Quit Maya after export?") -button "Yes" -button "No" -defaultButton "No" -cancelButton "No" -dismissString "Yes"`=="No")
			error "Idiot!";
	if (`gmatch $range "*-*"` && $renderDistributor==3)
		if (`confirmDialog -title "Confirm" -message ("Render Framerange locally? I doubt that dude!") -button "Yes" -button "No" -defaultButton "No" -cancelButton "No" -dismissString "Yes"`=="No")
			error "Idiot!";
			
	switch ($application) {
		case "1":
			$application="MentalRay Standalone SD";
			break;
		case "2":
			$application="MentalRay for Maya";
			break;
		case "3":
			$application="vray";
			break;
		case "4":
			$application="vr4m";
			break;
		}
		
	
	//ISOLATE SELECT FOR ANIMATION EXPORT SPEEDUP
	string $panel=`getPanel -wf`;
	int $alreadyIsolated;			
	if ((`gmatch $panel "model*"`)) {
		$alreadyIsolated=`isolateSelect -q -state $panel`;
			if (!$alreadyIsolated) isolateSelect -state 1 $panel;
	}
	
	
	
	//REMEMBER RENDERPOOL (for 16GB Pool)
	if (!attributeExists ("smedgePool", "defaultRenderLayer"))
		addAttr -ln "smedgePool" -dt "string"  defaultRenderLayer;
	setAttr ("defaultRenderLayer.smedgePool") -type "string" $maxHosts;
	
	
	//MAKE SURE RENDER SELECTED OBJECTS IS OFF!!!	
	setAttr defaultRenderGlobals.renderAll 1;

	//SET IMAGE NAMING CONVENTIONS
	//string $ifp=`getAttr defaultRenderGlobals.imageFilePrefix`;
	//if ($ifp=="") {
		//setAttr -type "string" defaultRenderGlobals.imageFilePrefix "<Layer>/<Scene>";
		//file -s;
		//}
	
	//setAttr defaultRenderGlobals.animation 1;
	setAttr defaultRenderGlobals.outFormatControl 0;

		

				
	string	$scene   = `file -q -sn`,
			$project   = `workspace -q -rd`,
			$shortname = `basenameEx $scene`,
			$folder    = `dirname $scene`,
			$cmd = toNativePath($submit) + " Script",
			$RRcmd = " -SendPass Default -NoAutoSceneRead On ",	
			$RR60cmd = " -NoAutoSceneRead On ",
			$startDir = toNativePath( `workspace -q -fn` + "/" + `workspace -q -rte images` ),
			$imageDir = $startDir,
			$smedgeExtra=" -Extra \"";
			
	
	
			
		
		//ASSIGN POOL 
		$cmd += (" -Pool " + $pool);
				
		//SET START DIR
		$cmd += " -StartDirectory " + $startDir;
		
		// set to launch one per cpu (change 1 to 0 if you want to launch one per engine)
		$cmd += " -CPUs 0";
		
		$cmd += (" -UsageLimit "+$usageLimit);
		$cmd += (" -Priority "+$priority);
		if ($priority=="0")
			$cmd += (" -Paused");
						
		int $projSize=size($project)-1; //stringLength
		
		//ADD HOSTS TO SMEDGE_EXTRA
		string $hosts;
		if ($useHosts)	{
		
			string $poolMembers[]=om_getSmedgePoolMembers($maxHosts);

			if (size($poolMembers)) {
				$cmd += (" -Pool "+$poolMembers[0]);
				for ($i=1;$i<size($poolMembers);$i++)
					$hosts+=($poolMembers[$i]+" ");
				}
			else
				switch ($maxHosts) {
					case "POOL_01":
						$cmd += " -Pool cluster1-001";
						$hosts="cluster1-002 cluster1-003 cluster1-004";
						break;
					case "POOL_02":
						$cmd += " -Pool cluster1-006";
						$hosts="cluster1-007 cluster1-008 cluster1-009";
						break;
					case "POOL_03":
						$cmd += " -Pool cluster1-011";
						$hosts="cluster1-012 cluster1-013 cluster1-014";
						break;
					case "POOL_04":
						$cmd += " -Pool cluster2-001";
						$hosts="cluster2-002 cluster2-003 cluster2-004 cluster2-005";
						break;
					case "POOL_05":
						$cmd += " -Pool cluster1-005";
						$hosts="cluster1-010 cluster1-015 cluster2-001";
						break;
					}
			$smedgeExtra += ("-hosts "+$hosts);
			}
			
		
		//RENDER REGION ON SMEDGE
		

		
		
		
		string $testResolution=`optionVar -q renderViewTestResolution`;
		/*if ($region && ($testResolution!=1)) {
			error "You need to set TESTRESOLUTION to RENDER SETTINGS if you want to render region!";
			}*/
		//if ($region && ($testResolution==1)) {
		if ($region) {
			int	$XL=`getAttr defaultRenderGlobals.left`,			
				$XH=`getAttr defaultRenderGlobals.rght`,
				$YL=`getAttr defaultRenderGlobals.bot`,
				$YH=`getAttr defaultRenderGlobals.top`;
				
					switch ($testResolution) {
						case "2":	$XL*=10;	//10%
									$XH*=10;
									$YL*=10;
									$YH*=10;
									break;
						case "3":   $XL*=4;	//25%
									$XH*=4;
									$YL*=4;
									$YH*=4;
									break;
						case "4":   $XL*=2;	//50%
									$XH*=2;
									$YL*=2;
									$YH*=2;						
									break;
						case "5":   $XL*=1.3333333333333333333333333333333;	//75%
									$XH*=1.3333333333333333333333333333333;
									$YL*=1.3333333333333333333333333333333;
									$YH*=1.3333333333333333333333333333333;
									break;
						case "6":   $XL/=1.10;	//110%
									$XH/=1.10;
									$YL/=1.10;
									$YH/=1.10;
									break;
						case "7":   $XL/=1.250;	//125%
									$XH/=1.250;
									$YL/=1.250;
									$YH/=1.250;
									break;
						case "8":   $XL/=1.50;	//150%
									$XH/=1.50;
									$YL/=1.50;
									$YH/=1.50;
									break;
					}
						
			$smedgeExtra+=(" -window "+$XL+" "+$YL+" "+$XH+" "+$YH+" ");
		}
		
		
		
		
		
		switch ($application) {
			case "vray":
				if (`getAttr vraySettings.globopt_light_doDefaultLights`) {
					confirmDialog -title "For your information..." -message ("DefaultLighting will now be turned off. Don't complain if your renders are black!");
					setAttr "vraySettings.globopt_light_doDefaultLights" 0;
					}
					
				string $vrayVersion=`getenv VRAY_VERSION`;
				if ($vrayVersion=="")
					$vrayVersion="00000_2010_06_10_VW_MINI";

				setAttr "vraySettings.vrscene_render_on" 0;
				setAttr "vraySettings.vrscene_on" 1;				
				//setAttr "defaultRenderGlobals.byFrameStep" $stepSize;
				
				
				int $animOnly=`getAttr vraySettings.animBatchOnly`,
					$anim=`getAttr defaultRenderGlobals.animation`,
					$imap_mode=`getAttr vraySettings.imap_mode`;
				setAttr "vraySettings.animBatchOnly" 0;
				setAttr "defaultRenderGlobals.animation" 1;
				float $gamma=`getAttr vraySettings.cmap_gamma`,
						$adaptionOnly=`getAttr vraySettings.cmap_adaptationOnly`;
				
				//MAKE SURE RENDER SELECTED OBJECTS IS OFF!!!	
				setAttr defaultRenderGlobals.renderAll 1;
				
				//MAKE SURE RENDER REGION IN VRAY VFB IS OFF!!!
				int $vfbOn=`getAttr vraySettings.vfbOn`;
				setAttr vraySettings.vfbOn 0;
				
				

				int $oldStep=`getAttr "defaultRenderGlobals.byFrameStep"`,
					$oldStart=`getAttr "defaultRenderGlobals.startFrame"`,
					$oldEnd=`getAttr "defaultRenderGlobals.endFrame"`;
						
				
				
				string $vrayFileDir,
						$tmpFolder=`getenv TEMP`;
				if ($tmpFolder=="")
						$tmpFolder=(`workspace -q -rd`+"/"+`workspace -q -rte renderScenes`);
						
				if ($renderDistributor==3)  {
					$vrayFileDir=$tmpFolder;					
					}
				else
					$vrayFileDir=`workspace -q -rte renderScenes`;
				
								
				string	$currentFileLoc=`file -q -exn`,													
						$allLayers[] = `listConnections renderLayerManager.renderLayerId`,
						$layerCmd,$RRlayerCmd,$RR60layerCmd;
					
				system("mkdir "+toNativePath($vrayFileDir));
				$cmd += " -Type vray";
				$RRcmd += " -Setsoftware Vray,Vray";				
				string $mayaVersion=`about -version`;
				$mayaVersion=`substring $mayaVersion 1 4`+".0";
				$RR60cmd += " -Software VRay_StdA -V "+$mayaVersion;
								
				
				$cmd += " -PacketSize "+($packetSize*$stepSize);
				
				
				$cmd += " -SequenceBy "+$stepSize;
				$RRcmd += " -SeqStep "+$stepSize;
				$RR60cmd += " -QP "+$stepSize;
				//print ("DEBUG: "+$stepSize+"\n");
				
				//$cmd+=(" -FirstWorkEvt \""+toNativePath($project)+"\\preRender.bat\"");
				

				int $canceled=0;
				
				/*for ($current in $allLayers) 
					if( `getAttr ($current + ".renderable")` ) {
						editRenderLayerGlobals -currentRenderLayer $current;
						
						
				
						string $vrimgDir[]=om_getRenderDir();
						
						//CHECK IF FILES ALREADY EXIST
						string	$RRext=`getAttr vraySettings.imageFormatStr`;
						string $alreadyRenderedImages[]=`getFileList -folder ($vrimgDir[0]+"/") -filespec ($vrimgDir[1]+"*"+$RRext)`;						
						if (size($alreadyRenderedImages)) {
							string $confirm=`confirmDialog -title "Confirm" -message (size($alreadyRenderedImages)+" images already exist in the "+$vrimgDir[0]+"\nDelete them?") -button "Yes" -button "No" -cancelButton "Cancel" -defaultButton "Cancel"  -dismissString "Cancel"`;							
							if ($confirm=="Yes") 								
									system("del "+toNativePath($vrimgDir[0])+"\\"+$vrimgDir[1]+"*."+$RRext);								
							else
								if ($confirm=="Cancel") {
									$canceled=1;
									break;									
									}
							}
						//CHECK DONE						
					}*/
				
				if (!$canceled)
				  for ($current in $allLayers) 
					if( `getAttr ($current + ".renderable")` ) {		
						
						editRenderLayerGlobals -currentRenderLayer $current;
						
						//START GET CAMERA
						string $cams[]=`ls -type camera`,$camera;
							for ($currentCam in $cams)
								if (`getAttr ($currentCam+".renderable")`) {
									$camera=$currentCam;
									//print ("DEBUG rendercam: "+$camera+"\n");
									break;									
								}
						//BACKWARD COMPATIBILITY!!!!
						string $batchCamera=`getAttr vraySettings.batchCamera`;
						if ($batchCamera!="persp")
							$camera=$batchCamera;
						$camera = `substituteAllString $camera ":" "_"`;					
						$camera = `substituteAllString $camera "|" "_"`;	
						//print ("DEBUG camera before submit: "+$camera+"\n");
						//END GET CAM
						
						
						string $vrayFile=($vrayFileDir +"/"+ basenameEx($currentFileLoc) + "_" + $camera );
						if (!`gmatch $vrayFile "/*"` && $renderDistributor!=3)
							$vrayFile=(`workspace -q -rd` + $vrayFile);
						
						
						//DEFAULTRENDERLAYER HACK2!!!!!
						if ($current=="defaultRenderLayer")
							$current="masterLayer";
						////HACK END
						
						$layerCmd = $cmd + " -Scene " + toNativePath($vrayFile)+"_"+$current+".vrscene";
						$RRlayerCmd =  toNativePath($vrayFile)+"_"+$current+".vrscene" + $RRcmd;
						$RR60layerCmd =  toNativePath($vrayFile)+"_"+$current+".vrscene" + $RR60cmd;
						
						//CHECK FILE FORMAT
						string	$RRext=`getAttr vraySettings.imageFormatStr`;
						int		$GIonly=`getAttr vraySettings.globopt_gi_dontRenderImage`;
								
						if ($RRext=="")
							$RRext="png";
						if (`gmatch $RRext "exr*"`) {							
							setAttr "vraySettings.cmap_adaptationOnly" 1;//setAttr "vraySettings.cmap_gamma" 1;
							$RRext="exr";
							}
						if ($GIonly)
							$RRext="vrmap";
						$RRlayerCmd += (" -ImageExtention ."+$RRext);
						$RR60layerCmd += (" -ImageExtention \"."+$RRext+"\"");
						$RR60layerCmd += (" -ImageFramePadding 4");
						
						$RRlayerCmd += (" -ImageFormat "+$RRext);				
						
						
						
						$layerCmd += (" -Name " + $shortname + ":"+$current);
						
						string $vrimgDir[]=om_getRenderDir();
						if ($GIonly) {
							string $irmap=`getAttr vraySettings.imap_autoSaveFile`;
							$irmap=`substring $irmap 1 (size($irmap)-6)`;
							$RRlayerCmd += " -ImageOutput " + $irmap;
							$RR60layerCmd+= " -ImageFileName " + $irmap;
							}
						else {
							$RRlayerCmd += " -ImageOutput " + $vrimgDir[0] + "/" + $vrimgDir[1];
							$RR60layerCmd += " -ImageDir \"" + $vrimgDir[0] +"\"" ;
							$RR60layerCmd += " -ImageFileName " + $vrimgDir[1];
							if (!`gmatch $RRext "exr*"`) {
								$RRlayerCmd += ".";
								$RR60layerCmd += ".";
								}
							$RR60layerCmd += "####."+$RRext;
						}
						
						//RANGE PER LAYER
						string $renderlayerRange=$range;
						if ($useRenderLayerRange && `attributeExists "framesToRender" $current`) {								
									string $framesToRender=`getAttr ($current+".framesToRender")`;
									if (size($framesToRender))
										$renderlayerRange=$framesToRender;
									else {
										warning ("Invalid RangePerLayer on "+$current);
										continue;
									}
								}
						$layerCmd += " -Range "+$renderlayerRange;
						
						//PREVIEW FRAMES!!!						
						//CONVERT STRING RANGES TO FULL INTS
						int $expandedFrameList[]=sort(om_expandFrameList($renderlayerRange,$stepSize)),
							$expandedPreviewFrameList[]=sort(om_expandFrameList($om_previewFrames,$stepSize));
						//print "DEBUG FRAMERANGE: ";
						//print $expandedFrameList;
						//CREATE FRAME-STRING LIST - remove previewframes if renderPreview is enabled
						string $expandedFrameListString="";
						if ($om_renderPreviewFrames) {
							//CONVERT INT ARRAY TO STRING ARRAY FOR LATER USE WITH stringArrayContains Command
							string $expandedPreviewFrameStringList[];
							int $ti=0;
							for ($currentPF in $expandedPreviewFrameList) {
								$expandedPreviewFrameStringList[$ti]=$currentPF;
								$ti++;
							}
							//print "DEBUG: $expandedPreviewFrameStringList";
							//print $expandedPreviewFrameStringList;
							
							for ($listItem=0;$listItem<size($expandedFrameList);$listItem++) {
								string $intToStr=$expandedFrameList[$listItem];
								if (!stringArrayContains($intToStr, $expandedPreviewFrameStringList))
									$expandedFrameListString+=($expandedFrameList[$listItem]+",");
							}
							
							
						}
						else 
							for ($listItem=0;$listItem<size($expandedFrameList);$listItem++)
								$expandedFrameListString+=($expandedFrameList[$listItem]+",");
						//FINISHED CREATING FRAME-STRING LIST
						//print "DEBUG: $expandedFrameListString";
						//print $expandedFrameListString;
						
						
						
						
						
						$RRlayerCmd += " -SeqIn "+ $expandedFrameList[0];
						$RR60layerCmd += " -QS "+ $expandedFrameList[0];
												
						$RRlayerCmd += " -SeqOut "+ $expandedFrameList[size($expandedFrameList)-1];
						$RR60layerCmd += " -QE "+ $expandedFrameList[size($expandedFrameList)-1];
						int $start=$expandedFrameList[0],
							$end=$expandedFrameList[size($expandedFrameList)-1];		
						
						//$layerCmd += " -JobFinishedEvt \"Nuke6.2.exe -F " + $start + "-" + $end + "x" + $stepSize + " -X Write \\\\blackout\\PROJECTS\\PROJECTS\\__NUKEENV\\scripts\\convertToScanlineExr.nk "+$vrimgDir[0] + "/" + $vrimgDir[1]+"PERCENT04d.exr\"";						
						$layerCmd += " -Extra \""+$vrimgDir[0] + "/" + $vrimgDir[1]+"PERCENT04d.exr\"";
						string $postWork=("Nuke6.2.exe -F "+$start+"-"+$end+"x1 -X Write \"\\\\blackout\\REPOSITORY\\NUKE\\scripts\\convertToScanlineExr.nk\"  \""+$vrimgDir[0] + "/" + $vrimgDir[1]+"PERCENT04d.exr\"\n");
						
						
						//setAttr "defaultRenderGlobals.animation" 1;						
						
						//ADD EXPORT HANDLE IF FRAMERANGE IS SPECIFIED...OTHERWISE MOTION BLUR COULD GET MESSED UP AT FIRST AND LAST FRAME
						//if ($start==$end || $stepSize!=1) {
							setAttr defaultRenderGlobals.startFrame ($start);
							setAttr defaultRenderGlobals.endFrame ($end);
							//BACKWARD COMPATIBILITY
							setAttr "defaultRenderGlobals.startFrame" ($start);
							setAttr "defaultRenderGlobals.endFrame" ($end);
						//}
						/*else {
							setAttr defaultRenderGlobals.startFrame ($start-1);
							setAttr defaultRenderGlobals.endFrame ($end+1);
							//BACKWARD COMPATIBILITY
							setAttr "defaultRenderGlobals.startFrame" ($start-1);
							setAttr "defaultRenderGlobals.endFrame" ($end+1);
						//setAttr "defaultRenderGlobals.byFrameStep" $stepSize;
						}*/
				
						
						
						
						//DO THE EXPORT
						string $exportStep[]={"beauty"};
						if ($om_occOnly)
							clear $exportStep;
						int $numberOfExports=1;
						
						string	$nukeImg=($vrimgDir[0] + "/" + $vrimgDir[1]+"PERCENT04d.exr"),
								$nukeImgOcc;
						
						print ("DEBUG $nukeImg: "+$nukeImg+"\n");
						
						
						if (!$submitJobOnly) {
							//CHECK FOR TEST RESOLUTION AND SET TO 100%
							int $oldTestRes=`optionVar -q renderViewTestResolution`;
							optionVar -intValue renderViewTestResolution 1;
							
							//REMEMBER CURRENT RES & CHECK IF WE NEED TO RENDER DOUBLE RESOLUTION
							int	$width=`getAttr vraySettings.width`,
								$height=`getAttr vraySettings.height`,
								$imap_minRate=`getAttr vraySettings.imap_minRate`,
								$imap_maxRate=`getAttr vraySettings.imap_maxRate`;
							
							int $tmpwidth=$width,
								$tmpheight=$height;
							if (attributeExists ("renderDoubleResolution", $current))
								if (`getAttr ($current+".renderDoubleResolution")`) {
										$tmpwidth=$width*2;
										$tmpheight=$height*2;
										setAttr defaultResolution.width $tmpwidth;
										setAttr vraySettings.width $tmpwidth;
										setAttr defaultResolution.height $tmpheight;
										setAttr vraySettings.height $tmpheight;
										setAttr vraySettings.imap_minRate ($imap_minRate-1);
										setAttr vraySettings.imap_maxRate ($imap_maxRate-1);
								}
							//CHECK IF WE RENDER WITH AUTOREGION AND FIND THAT REGION							
								if ($autoRenderRegion) {
									float $mayaRenderRegionXXYY[];
									string $renderableObjects[]=om_returnRenderableObjects();
									int $first=1;
									for ($currentRenderableObject in $renderableObjects) {
										float	$objectRenderRegionXXYY[]=om_getRenderRegion($currentRenderableObject, $batchCamera, $tmpwidth, $tmpheight);
										if ($first) {
											$mayaRenderRegionXXYY=$objectRenderRegionXXYY;
											$first=0;
											}										
										else {
											$mayaRenderRegionXXYY[0]=min($mayaRenderRegionXXYY[0],$objectRenderRegionXXYY[0]);
											$mayaRenderRegionXXYY[1]=max($mayaRenderRegionXXYY[1],$objectRenderRegionXXYY[1]);
											$mayaRenderRegionXXYY[2]=min($mayaRenderRegionXXYY[2],$objectRenderRegionXXYY[2]);
											$mayaRenderRegionXXYY[3]=max($mayaRenderRegionXXYY[3],$objectRenderRegionXXYY[3]);
										}
									}
																
									$vrayRenderRegionXXYY[0]=clamp(0,$tmpwidth,$mayaRenderRegionXXYY[0]);
									$vrayRenderRegionXXYY[1]=clamp(0,$tmpwidth,$mayaRenderRegionXXYY[1]);
									//CHECK FOR PANO POLE ISSUE	
									if ($vrayRenderRegionXXYY[1]-$vrayRenderRegionXXYY[0]>($tmpwidth*0.75)) {
										$vrayRenderRegionXXYY[0]=0;
										$vrayRenderRegionXXYY[1]=$tmpwidth;
									}
									//FLIP REGION UPSIDE DOWN FOR VRAY VFB
									//$vrayRenderRegionXXYY[2]=clamp(0,$tmpheight,$tmpheight-$mayaRenderRegionXXYY[3]);
									//$vrayRenderRegionXXYY[3]=clamp(0,$tmpheight,$tmpheight-$mayaRenderRegionXXYY[2]);
									$vrayRenderRegionXXYY[2]=$tmpheight-clamp(0,$tmpheight,$mayaRenderRegionXXYY[3]);
									$vrayRenderRegionXXYY[3]=$tmpheight-clamp(0,$tmpheight,$mayaRenderRegionXXYY[2]);
									print ("DEBUG RENDERREGION:\n");
									print $vrayRenderRegionXXYY;
									$vrayRenderRegionString=("\""+int($vrayRenderRegionXXYY[0])+";"+int($vrayRenderRegionXXYY[2])+";"+int($vrayRenderRegionXXYY[1])+";"+int($vrayRenderRegionXXYY[3])+"\"");
								}
							
							//REMEMBER FileName, cause we switch this when exporting the occlusion separately							
							string	$currentFileLoc=`file -q -exn`;
						
							
							//EXPORT VRSCENE
							//IF "USE GI & IRRADMAP & USE CAMERA PATH IS ENABLED, WE MUST DO 2 SEPERATE EXPORTS	
							string $renderIRmap=0; //REMOVE
							
							/*DISABLE IRMAP SUBMISSION
							if (!$om_occOnly && `getAttr vraySettings.giOn`==1 && `getAttr vraySettings.primaryEngine`==0 && `getAttr vraySettings.imap_useCameraPath`==1) {
								$numberOfExports++;
								$renderIRmap=1; //REMOVE
								$exportStep[0]="IRmap";
								$exportStep[1]="beauty_IRmap";
								
							}
							DISABLE IRMAP SUBMISSION*/
							
							
							//DEFINE SUFFIX FOR VRSCENE IN CASE OF IRRADIANCE MAP RENDERING
							string $exportFileNameSuffix="";
							
							
							//IF WE RENDER OCCLUSION WE MUST ADD ANOTHER EXPORT
							int $renderSeparateOcclusion=0;
							//OLD BEHAVIOUR
							//if (attributeExists ("renderOcclusion", $current) && attributeExists ("occlusionRenderedOnFrame", $current))
							if (attributeExists ("forceOcclusion", "om_OCC_SG")) {
								if (`getAttr ("om_OCC_SG.forceOcclusion")`) {
									//check if one of the frames to render is not already rendered - if only one frame is missing we need to submit occl again
									//OLD BAHAVIOUR
									//for ($currentFrame in $expandedFrameList) 
										//string $occlusionRenderedOnFrame=`getAttr ($current+".occlusionRenderedOnFrame")`;
										//if (!`gmatch $occlusionRenderedOnFrame ("*,"+$currentFrame+",*")`) 
											$renderSeparateOcclusion=1;											
											//setAttr -type "string" ($current+".occlusionRenderedOnFrame") ($occlusionRenderedOnFrame+$expandedFrameListString);

											if ($om_occOnly) {
												clear $exportStep;
												$exportStep[0]="occlusion";
											}
											else
												$exportStep[size($exportStep)]="occlusion";	
											//break;
										
									
								}
							}
							
							
							
							//for ($i=1;$i<=$numberOfExports;$i++) 
							for ($currentExportStep in $exportStep) {								
								//set the localexport filename
								string $imapName=(`workspace -q -rd`+"data/vray_irradianceMaps/"+basenameEx($currentFileLoc)+"_"+$current+".irmap");
								
								//REMEMBER OLD SETTING
								int $giOn=`getAttr vraySettings.giOn`,
									$relements_enableall=`getAttr vraySettings.relements_enableall`,
									$samplerType=`getAttr vraySettings.samplerType`,
									$subdivMinRate=`getAttr vraySettings.subdivMinRate`;
									$subdivMaxRate=`getAttr vraySettings.subdivMaxRate`;
									$subdivThreshold=`getAttr vraySettings.subdivThreshold`;
								
								print ("DEBUG Exportstep: "+$currentExportStep+"\n");
								
								
								
								switch ($currentExportStep) {
										case "beauty":			//DO NOTHING																
																break;
										
										case "IRmap" :			setAttr vraySettings.imap_mode 0;
																setAttr vraySettings.imap_dontDelete 1;
																setAttr vraySettings.imap_autoSave 1;
																setAttr -type "string" vraySettings.imap_autoSaveFile $imapName;									
																setAttr vraySettings.globopt_gi_dontRenderImage 1;
																$exportFileNameSuffix="_irmapOnly";									
																break;
										
										case "beauty_IRmap":	setAttr vraySettings.imap_mode 2;
																setAttr -type "string" vraySettings.imap_fileName $imapName;
																setAttr vraySettings.globopt_gi_dontRenderImage 0;
																$exportFileNameSuffix="";
																break;
										
										case "occlusion":		om_connectOcclusion($current);				
																
																string $newFileLoc=dirname($currentFileLoc)+"/"+basenameEx($currentFileLoc);
																$newFileLoc+="_occlusion.mb";
																file -rename $newFileLoc;
																$nukeImgOcc=($vrimgDir[0] + "_occlusion/" + $vrimgDir[1]+"PERCENT04d.exr");
																print ("DEBUG $nukeImgOcc: "+$nukeImgOcc+"\n");
																vrayChangeFileNamePrefix(); //WARUM AUCH IMMER DAS NTIG IST
																setAttr vraySettings.giOn 0;
																setAttr vraySettings.relements_enableall 0;
																
																//SET NEW SUBDIVISION SAMPLER AND SETTINGS																
																setAttr vraySettings.samplerType 2;
																setAttr vraySettings.subdivMinRate 0;
																setAttr vraySettings.subdivMaxRate 3;
																setAttr vraySettings.subdivThreshold 0.01;																
																
																$exportFileNameSuffix="_occlusion";
																break;						
								}
								
								
								
								string $vrayFileLocalTemp=($tmpFolder + "/tmp_" + basenameEx($currentFileLoc) + "_" + $camera + $exportFileNameSuffix);
								//print ("DEBUG $vrayFileLocalTemp = "+$vrayFileLocalTemp+"\n");
								//DEFAULTRENDERLAYER HACK!!!!!
								if (size($allLayers)>1)	setAttr -type "string" vraySettings.vrscene_filename $vrayFileLocalTemp; else setAttr -type "string" vraySettings.vrscene_filename ($vrayFileLocalTemp+"_masterLayer");
								////HACK END
								
								//OLD
								//renderWindowRenderCamera render "" `getAttr vraySettings.batchCamera`;
								//$command $resolution[0] $resolution[1] 	$doShadows 	$doGlowPass $camera	$option									
								//if (!`about -batch`)asdf
								vrend -width $tmpwidth -height $tmpheight -camera `getAttr vraySettings.batchCamera` -layer $current -noRender -exportFileName $vrayFileLocalTemp;
								
								
								//GET SCRIPTPATH AND COPY THE VRSCENE PREFIX
								global string $scriptPath;
								string $log;
								if (`about -os`!="linux64") {									
									
									//VRAY EXPORT BUG HACK:
									string $exportedFile=(toNativePath($vrayFileLocalTemp)+"_"+$current+".vrscene");
									print ("DEBUG exportFile: "+$exportedFile+"\n");
									if (!`filetest -r $exportedFile`)
										$exportedFile=(toNativePath($vrayFileLocalTemp)+".vrscene");									
									print ("DEBUG exportFile: "+$exportedFile+"\n");
									//VRAY EXPORT BUG HACK END
									
									$log=`system("copy /B /Y "+toNativePath($scriptPath)+"vrscene_prefix.vrscene+"+$exportedFile+" "+toNativePath($vrayFile)+$exportFileNameSuffix+"_"+$current+".vrscene")`;
									       print("copy /B /Y "+toNativePath($scriptPath)+"vrscene_prefix.vrscene+"+$exportedFile+" "+toNativePath($vrayFile)+$exportFileNameSuffix+"_"+$current+".vrscene\n");
									
									
									print ($log+"\n");
									system("del "+$exportedFile);
									}
								else
									$log=`system("mv  "+toNativePath($vrayFileLocalTemp)+"_"+$current+".vrscene "+toNativePath($vrayFile)+$exportFileNameSuffix+"_"+$current+".vrscene")`;
								
								print ($log+"\n");
								//DISCONNECT OCCLUSIONSETUP AND RESTORE GI Settings and enable renderelements if previously enabled
								om_disconnectOcclusion();
								setAttr vraySettings.giOn $giOn;
								setAttr vraySettings.relements_enableall $relements_enableall;
								setAttr vraySettings.samplerType $samplerType;
								setAttr vraySettings.subdivMinRate $subdivMinRate;
								setAttr vraySettings.subdivMaxRate $subdivMaxRate;
								setAttr vraySettings.subdivThreshold $subdivThreshold;
								
								file -rename $currentFileLoc;								
							}
							
							//RESET RESOLUTION
							setAttr defaultResolution.width $width;
							setAttr vraySettings.width $width;
							setAttr defaultResolution.height $height;
							setAttr vraySettings.height $height;
							//RESET IRMAP SeTTINGS
							setAttr vraySettings.imap_minRate $imap_minRate;
							setAttr vraySettings.imap_maxRate $imap_maxRate;
							//RESET TESTRESOLUTION
							optionVar -intValue renderViewTestResolution $oldTestRes;
							//RESET IMAP to not be overwritten by testrenderings
							setAttr -type "string" vraySettings.imap_autoSaveFile "";

							
						}
						
						//PROTECT PACKSIZE TO BE OVERRIDEN
						$tmpPacketSize=$packetSize;
						//ADD EXTRA JOBPARAMETERS						
						if(`getAttr vraySettings.imap_mode`==6)
							$GIonly=0;
						int $seqDivMin=$packetSize/2;
						
						int $renderPreview=1;
						if(`getAttr vraySettings.imap_mode`==1 || `getAttr vraySettings.imap_mode`==4){
							$renderPreview=0;
							$tmpPacketSize=$end-$start+1;
							$seqDivMin=$tmpPacketSize;
						}
						
						//CHECK IF ITS ID PASS
						string $clientGroup="VRAY";
						if (`gmatch $current "ID*"` || `gmatch $current "id*"`) {
							$clientGroup="VRAY_LITTLE_JOBS";
							$seqDivMin=5;
							$tmpPacketSize=10;
						}
							
						$RRlayerCmd += " \"RenderPreview=1|"+$renderPreview+"\" \"NoFrameChecking=1|"+$GIonly+"\" \"SequenceDivide=1|1\" \"SequenceDivideMIN=1|"+$seqDivMin+"\" \"SequenceDivideMAX=1|"+$tmpPacketSize+"\" \"MC=1|40\" \"DCG="+$clientGroup+"\" \"Priority=1|"+$priority+"\"";
						$RR60layerCmd += " \"RenderPreview=1~"+$renderPreview+"\" \"NoFrameChecking=1~"+$GIonly+"\" \"SequenceDivide=1~1\" \"SequenceDivideMIN=1~"+$seqDivMin+"\" \"SequenceDivideMAX=1~"+$tmpPacketSize+"\" \"MC=1~40\" \"DCG="+$clientGroup+"\" \"Priority=1~"+$priority+"\"";
						
						int $processId;
						
						/*OLD RR5.0 - replaced by QUBE!
						if ($renderDistributor==1) {
							$RRlayerCmd = toNativePath($RRsubmit) + " " + $RRlayerCmd;
							print ($RRlayerCmd+"\n");
							exec($RRlayerCmd);
							}						
						*/	
						
						//IF WE HAVE 2 EXPORTS WE MUST SUBMIT 2 JOBS WHERE the 2nd waits for the 1st to be finished
						int $lastJobID=0;
						//for ($i=1;$i<=$numberOfExports;$i++)
						for ($currentExportStep in $exportStep) {							
								//set the localexport filename
								string	$imapName=(`workspace -q -rd`+"data/vray_irradianceMaps/"+basenameEx($currentFileLoc)+"_"+$current+".irmap"),
										$nukeImgExport=$nukeImg;
								
								
								print ("DEBUG submitstep: "+$currentExportStep+"\n");
								
								switch ($currentExportStep) {
										case "beauty":			//DO NOTHING
																$exportFileNameSuffix="";
																break;
										
										case "IRmap" :			$exportFileNameSuffix="_irmapOnly";									
																break;
										
										case "beauty_IRmap":	$exportFileNameSuffix="";
																break;
										
										case "occlusion":		$exportFileNameSuffix="_occlusion";
																$nukeImgExport=$nukeImgOcc;
																break;
								}
							
							
							
							
							
								
							
							
							
							if ($renderDistributor==1) { //NEW QUBE JOB!
								
								string	$vrayFileQube=(toNativePath($vrayFile)+$exportFileNameSuffix+"_"+$current+".vrscene");
										
								// alex -> lokale rechner raus
								string $qubehosts="renderm10,renderm11,renderm12,renderm13,renderm14,renderm15,renderm16,renderm17,renderm18,renderm19,renderm20,renderm21,renderm22,renderm23";
								//string $qubehosts="mws005,mws006,mws007,mws008,mws009,mws012,mws013,mws014,mws015,mws016,mws017,mws018,mws019,renderm10,renderm11,renderm12,renderm13,renderm14,renderm15,renderm16,renderm17,renderm18,renderm19,renderm20,renderm21,renderm22,renderm23";
																
								int $renderDistributed=0; //check renderui global setting
								if (attributeExists ("renderDistributed", $current) && size($expandedFrameList)==1)
									$renderDistributed=`getAttr ($current+".renderDistributed")`;
								
								int $previewPrio=int($priority);
								
								if ($om_renderPreviewFrames)
									$previewPrio-=10;
								if ($previewPrio<1)
									$previewPrio=1;	
								
								string $jobname=$camera+" "+$shortname+":"+$current+$exportFileNameSuffix;
								
								
								
								if ($currentExportStep=="IRmap") {
									string $result[]=python ("import qb;myjob = qb.Job();myjob['name'] = '"+$jobname+"';myjob['prototype'] = 'cmdrange';myjob['priority'] = '"+$previewPrio+"';myjob['reservations'] = 'host.processors=7+,host.memory=5000';myjob['retrysubjob'] = 3;myjob['retry'] = 3;myjob['cpus'] = '20';myjob['cluster'] = '/"+$pool+"';myjob['cluster'] = '/"+$pool+"';myjob['hosts'] = '"+$qubehosts+"';myjob['package'] = {'cmdline' : '\\\\\\\\fsrv-muc-01\\\\PLUGINS\\\\TOOLS\\\\qb_render.bat "+`encodeString $vrayFileQube`+" "+$nukeImgExport+" QB_FRAME_NUMBER "+$vrayVersion+"','padding' : 0,'range' : '"+$expandedFrameList[0]+"-"+$expandedFrameList[0]+"'};myjob['agenda'] = qb.genframes(myjob['package']['range']);qb.submit(myjob)");  
									tokenize $result[0] ", :'" $result; 
									string $lastKey="";
									for ($currentKey in $result) {
										if ($lastKey=="id") {
											print ("ID: "+$currentKey+"\n");
											$lastJobID=$currentKey;
											break;
											}
										$lastKey=$currentKey;
									}									
								}
								else {
									string $renderCommand="\\\\\\\\fsrv-muc-01\\\\PLUGINS\\\\TOOLS\\\\qb_renderRegionAndConvert.bat";
									if ($renderDistributed && $currentExportStep!="occlusion") {
										$renderCommand="\\\\\\\\fsrv-muc-01\\\\PLUGINS\\\\TOOLS\\\\qb_renderRegionDistributedAndConvert.bat";
										$qubehosts="renderm10,renderm15,renderm20";										
									}
									
									if ($lastJobID==0 || $currentExportStep=="occlusion") {
										if ($om_renderPreviewFrames)
											python ("import qb;myjob = qb.Job();myjob['name'] = '"+$jobname+"';myjob['prototype'] = 'cmdrange';myjob['priority'] = '"+$previewPrio+"';myjob['reservations'] = 'host.processors=7+,host.memory=5000';myjob['retrysubjob'] = 3;myjob['retry'] = 3;myjob['cpus'] = '20';myjob['cluster'] = '/"+$pool+"';myjob['hosts'] = '"+$qubehosts+"';myjob['package'] = {'cmdline' : '"+$renderCommand+" "+`encodeString $vrayFileQube`+" "+$nukeImgExport+" QB_FRAME_NUMBER "+$vrayVersion+" "+$vrayRenderRegionString+"','padding' : 0,'range' : '"+$om_previewFrames+"'};myjob['agenda'] = qb.genframes(myjob['package']['range']);qb.submit(myjob)");  
										python ("import qb;myjob = qb.Job();myjob['name'] = '"+$jobname+"';myjob['prototype'] = 'cmdrange';myjob['priority'] = '"+$priority+"';myjob['reservations'] = 'host.processors=7+,host.memory=5000';myjob['retrysubjob'] = 3;myjob['retry'] = 3;myjob['cpus'] = '20';myjob['cluster'] = '/"+$pool+"';myjob['hosts'] = '"+$qubehosts+"';myjob['package'] = {'cmdline' : '"+$renderCommand+" "+`encodeString $vrayFileQube`+" "+$nukeImgExport+" QB_FRAME_NUMBER "+$vrayVersion+" "+$vrayRenderRegionString+"','padding' : 0,'range' : '"+$expandedFrameListString+"'};myjob['agenda'] = qb.genframes(myjob['package']['range']);qb.submit(myjob)");  
									}
									else {
										if ($om_renderPreviewFrames)
											python ("import qb;myjob = qb.Job();myjob['name'] = '"+$jobname+"';myjob['prototype'] = 'cmdrange';myjob['priority'] = '"+$previewPrio+"';myjob['dependency'] = 'link-complete-job-"+$lastJobID+"';myjob['reservations'] = 'host.processors=7+,host.memory=5000';myjob['retrysubjob'] = 3;myjob['retry'] = 3;myjob['cpus'] = '20';myjob['cluster'] = '/"+$pool+"';myjob['hosts'] = '"+$qubehosts+"';myjob['package'] = {'cmdline' : '"+$renderCommand+" "+`encodeString $vrayFileQube`+" "+$nukeImgExport+" QB_FRAME_NUMBER "+$vrayVersion+" "+$vrayRenderRegionString+"','padding' : 0,'range' : '"+$om_previewFrames+"'};myjob['agenda'] = qb.genframes(myjob['package']['range']);qb.submit(myjob)");  											
										python ("import qb;myjob = qb.Job();myjob['name'] = '"+$jobname+"';myjob['prototype'] = 'cmdrange';myjob['priority'] = '"+$priority+"';myjob['dependency'] = 'link-complete-job-"+$lastJobID+"';myjob['reservations'] = 'host.processors=7+,host.memory=5000';myjob['retrysubjob'] = 3;myjob['retry'] = 3;myjob['cpus'] = '20';myjob['cluster'] = '/"+$pool+"';myjob['hosts'] = '"+$qubehosts+"';myjob['package'] = {'cmdline' : '"+$renderCommand+" "+`encodeString $vrayFileQube`+" "+$nukeImgExport+" QB_FRAME_NUMBER "+$vrayVersion+" "+$vrayRenderRegionString+"','padding' : 0,'range' : '"+$expandedFrameListString+"'};myjob['agenda'] = qb.genframes(myjob['package']['range']);qb.submit(myjob)");  											
										print ("Submitted job waiting for ID: "+$lastJobID+"\n");
									}
								
								}
								

							}
							
							
							global string $renderHosts; //set in om_renderUI_cfg.mel							
												
							
							//ROYAL RENDER
							if ($renderDistributor==4) {
								if (`about -os`!="linux64") 
								$RR60layerCmd = toNativePath("//blackout/ROYAL_RENDER/bin/win/rrSubmitterconsole.exe") + " " + $RR60layerCmd;
								else
									$RR60layerCmd = toNativePath("/blackout/ROYAL_RENDER/bin/lx/rrSubmitterconsole") + " " + $RR60layerCmd;
									
								print ($RR60layerCmd+"\n");
								exec($RR60layerCmd);
								}
							
							
							//SMEDGE
							if ($renderDistributor==2) {
								//TEMPORARY TURNED OFF
								om_submitSmedgeCmd($layerCmd);
								//print("vray.exe -autoclose=1 -display=0 -portNumber=20207  -distributed="+$useHosts+" -renderhost=\""+$renderHosts+"\" -frames="+$expandedFrameListString+" -scenefile=\""+toNativePath($vrayFile)+"_"+$current+".vrscene\"\n");
								//print $postWork;
								
							}						
							
							//LOCAL RENDER
							if ($renderDistributor==3) {
								
								
								if (`about -os`!="linux64") {
									print("vray.exe -autoclose=0 -display=1  -portNumber=20207  -distributed="+$useHosts+" -renderhost=\""+$renderHosts+"\" -frames="+$expandedFrameList[0]+"-"+$expandedFrameList[1]+" -scenefile=\""+toNativePath($vrayFile)+"_"+$current+".vrscene\"\n");
									//print $postWork;
									$processId=`exec("vray.exe -autoclose=0 -display=1  -portNumber=20207  -distributed="+$useHosts+" -renderhost=\""+$renderHosts+"\" -frames="+$expandedFrameList[0]+"-"+$expandedFrameList[1]+","+$stepSize+" -scenefile=\""+toNativePath($vrayFile)+"_"+$current+".vrscene\"")`;
									}
								else {								
									print("/usr/autodesk/maya/vray/bin/vray -autoclose=0 -display=1  -portNumber=20207  -distributed="+$useHosts+" -renderhost=\""+$renderHosts+"\" -frames="+$expandedFrameListString+","+$stepSize+" -scenefile=\""+toNativePath($vrayFile)+"_"+$current+".vrscene\"\n");
									$processId=`exec("/usr/autodesk/maya/vray/bin/vray -autoclose=0 -display=1  -portNumber=20207  -distributed="+$useHosts+" -renderhost=\""+$renderHosts+"\" -frames="+$expandedFrameListString+","+$stepSize+" -scenefile=\""+toNativePath($vrayFile)+"_"+$current+".vrscene\"")`;
									}
								//print ("ProcessID: "+$processId+"\n");
							}
													
						}	
					}
				setAttr "vraySettings.vrscene_render_on" 1;
				setAttr "vraySettings.vrscene_on" 0;
				
				setAttr "defaultRenderGlobals.startFrame" $oldStart;
				setAttr "defaultRenderGlobals.endFrame" $oldEnd;
				setAttr "defaultRenderGlobals.byFrameStep" $oldStep;
				//BACKWARD COMPATIBILITY				
				
				setAttr "defaultRenderGlobals.animation" $anim;
				setAttr "vraySettings.animBatchOnly" $animOnly;
				
				setAttr vraySettings.vfbOn $vfbOn;
				
				setAttr "vraySettings.cmap_adaptationOnly" $adaptionOnly;
				setAttr "vraySettings.imap_mode" $imap_mode;
				
				break;
				
			case "sw":
			case "vr4m":
			case "MentalRay for Maya":
					
				//$imageDir = ($startDir +"\\"+ om_getMainSceneName());
				//SAVE FILE TO RENDERSCENES
				string	$currentFileLoc=`file -q -exn`,
						$newFileLoc=(`workspace -q -rd` + `workspace -q -rte renderScenes` +"/" + basenameEx($currentFileLoc)+".mb");
								
				file -rename $newFileLoc;
				file -s;
				file -rename $currentFileLoc;
				$scene=$newFileLoc;		
				
				
				
								
				if ($application=="sw") {
					$cmd += (" -Type sw");
					$RR60cmd += " -Software Maya -Renderer Software -V 2009";
					}
				else if ($application=="vr4m") {
						$cmd += (" -Type vr4m");
						$RR60cmd += " -Software Maya -Renderer VRay -V 2009";
						}
					else {
						$cmd += (" -Type MR4M");
						$RR60cmd += " -Software Maya -Renderer MentalRay -V 2009";
						}
				$cmd += " -Scene " + toNativePath($scene) ;				
				$cmd += " -Project " + `substring $project 1 $projSize`;
				$RR60cmd += " -SceneDatabaseDir "+$project;

				
				$cmd += " -PacketSize "+($packetSize*$stepSize);
				$cmd += " -SequenceBy "+$stepSize;
				$RR60cmd += " -QP "+$stepSize;
				
				string $layerCmd;
				string $hostname = om_getHostname();

				$range = `substituteAllString $range ":" "-"`;
				
				string $allLayers[] = `listConnections renderLayerManager.renderLayerId`;
				for ($current in $allLayers)
					if( `getAttr ($current + ".renderable")` ) {
						$layerCmd = $cmd + (" -Name " + $shortname + ":"+$current);
						$layerCmd+= (" -Extra \"-rl "+$current+"\"");
						$RR60layerCmd =  toNativePath($scene)+" "+$RR60cmd;
						$RR60layerCmd += " -Layer "+$current; 
						
						
						//RANGE PER LAYER
						string $renderlayerRange=$range;
						if ($useRenderLayerRange && `attributeExists "framesToRender" $current`) {								
									string $framesToRender=`getAttr ($current+".framesToRender")`;
									if (size($framesToRender))
										$renderlayerRange=$framesToRender;
									else {
										warning ("Invalid RangePerLayer on "+$current);
										continue;
									}
								}
						
						$layerCmd += " -Range "+$renderlayerRange;
						string $expandedFrameList[];
						tokenize $renderlayerRange "-,;" $expandedFrameList;						
						
						$RR60layerCmd += " -SeqStart "+ $expandedFrameList[0];
						if ($expandedFrameList[1]=="")
							$expandedFrameList[1]=$expandedFrameList[0];
						
						$RR60layerCmd += " -SeqEnd "+ $expandedFrameList[1];
												
						editRenderLayerGlobals -currentRenderLayer $current;
						string $vrimgDir[]=om_getRenderDir();
						
						$RR60layerCmd += " -ImageDir \"" + $vrimgDir[0] +"\"" ;
						$RR60layerCmd += " -ImageFileName " + $vrimgDir[1];
						$RR60layerCmd += ".####."+$vrimgDir[2];
						$RR60layerCmd += " \"AllowLocalSceneCopy= 1~0\" \"AllowTextureReplacement= 1~0\" \"AllowLocalRenderOut= 0~1\" \"SequenceDivide= 1~1\" \"SeqDivMIN= 1~"+$packetSize+"\" \"SeqDivMAX= 1~"+$packetSize+"\" \"MC= 1~40\" \"Priority=1~"+$priority+"\"";
						
						//if ($notify=="1" && $hostname!="")
							//$layerCmd+=(" -JobFinishedEvt net send "+$hostname+" Job "+$shortname+":"+$current+" is done!");
							//if ($application=="vr4m")
								//$layerCmd+=(" -JobFinishedEvt \\\\octowski\\D\\PROJECTS\\__MAYAENV\\TOOLS\\vrimg2exr.bat "+$vrimgDir[0]);							
							//else
								//$layerCmd+=(" -JobFinishedEvt net send "+$hostname+" Job "+$shortname+":"+$current+" is done!");
						
						
						
						//SUBMIT USING DIFFERNET DISTRIBUTORS
						
						if ($renderDistributor==2) {
							om_submitSmedgeCmd($layerCmd);
						}
						if ($renderDistributor==4) {
							if (`about -os`!="linux64") 
								$RR60layerCmd = toNativePath("//blackout/ROYAL_RENDER/bin/win/rrSubmitterconsole.exe") + " " + $RR60layerCmd;
							else
								$RR60layerCmd = toNativePath("/blackout/ROYAL_RENDER/bin/lx/rrSubmitterconsole") + " " + $RR60layerCmd;
								
							print ($RR60layerCmd+"\n");
							exec($RR60layerCmd);
							}
						
						
						
					}
				break;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
			
			case "MentalRay Standalone SD":
				
				
				
				
				$cmd += " -Type MR";
				$cmd += (" -Note !!!DO NOT EDIT!!! - automatic submission");
				
				//LOCAL INCLUDES KRAM
				if ($localIncludes) {
					$smedgeExtra+=(" -I \\\"c:/rendertemp;"+$project+"/renderScenes/reuseableMiExports\\\"");
					$cmd+=(" -FirstWorkEvt xcopy /D /I /Y \""+toNativePath($project)+"\\renderScenes\\reuseableMiExports\\*.*\" \"c:\\rendertemp\"");
					}
				else
					$smedgeExtra+=(" -I \\\""+$project+"/renderScenes/reuseableMiExports\\\"");
							
				
				

				string $allLayers[],$activeLayers[],$layerJobIds[],$waitForLayers;
				clear($allLayers);
				clear($activeLayers);
				clear($layerJobIds);
				$waitForLayers="";
				$allLayers = `listConnections renderLayerManager.renderLayerId`;

				string $layerCmd;
				
				$smedgeExtra+=" -fb_virtual off -swap_dir c:/rendertemp -swap_limit 10000 -task_order hilbert";
				$smedgeExtra+=(" "+$smedgeExtraFromUI);
				
				if (`getAttr defaultResolution.width`>4000)
					$smedgeExtra+=" -task_size 128";
				else
					if (`getAttr defaultResolution.width`<2000)
						$smedgeExtra+=" -task_size 32";
					else
						$smedgeExtra+=" -task_size 64";
				
				
				
				global string $alreadyExportedObjects[];
				$alreadyExportedObjects=getMiExportLocationInScene();
				
				string $renderlayerRange=$range;
				
				if ($pool!="local") {
					string $folder=toNativePath($project+"/renderScenes/"+ $shortname);
					system("mkdir \""+ $folder+"\"");
					
						
					for ($current in $allLayers) {
						if( `getAttr ($current + ".renderable")` ) {
							print ("Current RenderLayer: "+$current+"\n");
							string $currentClean = `substituteAllString $current ":" "_"`;
							editRenderLayerGlobals -currentRenderLayer $current;
							
							//CHECK FOR ALREADY RENDERED FRAMES
							string $imageRenderDirOverride[]=om_getRenderDir();
							string $dirListing[]=`getFileList -folder ($imageRenderDirOverride[0]+"/")`;							
							if (size($dirListing)) {								
								string $version=`getAttr defaultRenderGlobals.renderVersion`;								
								
								if (isValidString($version, "v[0-9][0-9][0-9]")) {
									int $vers=`substring $version 2 4`;
									$vers++;
									$version=$vers;
									$size=size($version);
									switch ($size) {
										case 1:	$version="v00"+$version;
												break;
										case 2:	$version="v0"+$version;
												break;
										case 3:	$version="v"+$version;
												break;
										}									
								}
								else if (isValidString($version, "[0-9][0-9][0-9]")) {
									int $vers=$version;
									$vers++;
									$version=$vers;
									$size=size($version);
									switch ($size) {
										case 1:	$version="00"+$version;
												break;
										case 2:	$version="0"+$version;
												break;										
										}	
								
								}
								
							catch (`editRenderLayerAdjustment defaultRenderGlobals.renderVersion`);							
							setAttr -type "string" defaultRenderGlobals.renderVersion $version;
							warning ("Increasing Renderlayer-Version on "+$current+" to "+$version+"!");
							$imageRenderDirOverride=om_getRenderDir();
							}							
							
							//SET RANGE PER LAYER
							if ($useRenderLayerRange && `attributeExists "framesToRender" $current`) {								
									string $framesToRender=`getAttr ($current+".framesToRender")`;
									if (size($framesToRender))
										$renderlayerRange=$framesToRender;
									else {
										warning ("Invalid RangePerLayer on "+$current);
										continue;
									}
								}
								
								
								
							//START EXPORT OF RENDERLAYER
							if (!$submitJobOnly) {		
								
								
								
								om_updateExrSaver;
								includeRenderLayerObjects;
								
								select -r `editRenderLayerMembers -q -fn $current`;
								
								//SPLIT RANGE TO JOBS
								string $jobs[],$jobRange[];
								tokenize $renderlayerRange "," $jobs;	
								
								
								for ($currentJob in $jobs) {
									tokenize $currentJob "-" $jobRange;	
									int $startFrame = $jobRange[0],
										$endFrame;		
									if ($jobRange[1]!="")
										$endFrame   = $jobRange[1];
									else
										$endFrame   = $startFrame;
									
									if ($endFrame!=$startFrame && $region)
										if (`confirmDialog -title "Confirm" -message ("Render Region for this Framerange?") -button "Yes" -button "No" -defaultButton "No" -cancelButton "No" -dismissString "Yes"`=="No")
											error "User Aborted!";
									
									setAttr defaultRenderGlobals.startFrame $startFrame;
									setAttr defaultRenderGlobals.endFrame $endFrame;	
									
									Mayatomr -active -mi -pf 2 -layer $current -exportFilter 8212 -binary -xp "311111111" -file ($project+"/renderScenes/"+$shortname +"/"+$shortname+"_"+$currentClean+".mi");
								}
							}
							
						
							//END EXPORT OF RENDERLAYER
						
							$activeLayers[size($activeLayers)]=$current;
							
							//if ($allLayers[1] != "") {								
								//if ($current=="defaultRenderLayer") $current="masterLayer";								
								//NAMESPACE_CLEANUP!!!!								
								
								
								system("mkdir \""+toNativePath($imageRenderDirOverride[0])+"\"");
								$layerCmd = $cmd + ($smedgeExtra+" -file_dir "+ $imageRenderDirOverride[0] +"\"") + " -Scene " + $project+"/renderScenes/"+ $shortname +"/"+ $shortname+"_"+ $currentClean +".0001.mi";
								$layerCmd += " -SceneNameFormat " + $project+"/renderScenes/"+ $shortname +"/"+ $shortname+"_"+ $currentClean +".%d.mi";
								//}
							//else {
								//$layerCmd = $cmd + " -Scene " + $project+"/renderScenes/"+ $shortname +"/"+ $shortname+".0001.mi";
								//$layerCmd += " -SceneNameFormat " + $project+"/renderScenes/"+ $shortname +"/"+ $shortname+".%d.mi";
								//}
						
							$renderlayerRange = `substituteAllString $renderlayerRange ":" "-"`;							
							$layerCmd += " -Range "+$renderlayerRange;
							$layerCmd += " -Name " + $shortname + " " + $current;
							
							//assign jobfinishedEvent to Last renderlayer and wait for the previous Layers
							if ($mergePSD){
								if ($current==$allLayers[size($allLayers)-1]) {
									string $mayaBatchCommand=om_getMergePsdCommand($activeLayers);								
									$layerCmd += " -WaitForJobID "+$layerJobIds[size($layerJobIds)-1];
									$layerCmd += " -JobFinishedEvt \""+$mayaBatchCommand+"\"";														
								}
							}
							else {
								string $hostname = om_getHostname();
								
								//COSY ONLY								
								if (`attributeExists "framesToRender" $current`) {									
									string $framesToRender=`getAttr ($current+".framesToRender")`;
									switch ($framesToRender) {
										case "1-72":	$layerCmd+= (" -JobFinishedEvt \\\\Vinxp\\Work\\_SHARED\\batchscripts_dos\\cosyNotifyAndRename.bat \\\""+$imageRenderDirOverride[0]+"\\\" walk "+$hostname+" \\\"Job "+$shortname+"_"+$current+" is done!\\\"");
														break;
										case "1001-1034":
										case "1001-1034,966-999":
										case "966-999,1001-1034":
										case "966-999":	$layerCmd+= (" -JobFinishedEvt \\\\Vinxp\\Work\\_SHARED\\batchscripts_dos\\cosyNotifyAndRename.bat \\\""+$imageRenderDirOverride[0]+"\\\" wood "+$hostname+" \\\"Job "+$shortname+"_"+$current+" is done!\\\"");
														break;
										default:		$layerCmd+= (" -JobFinishedEvt \\\\Vinxp\\Work\\_SHARED\\batchscripts_dos\\cosyNotifyAndRename.bat \\\""+$imageRenderDirOverride[0]+"\\\" default "+$hostname+" \\\"Job "+$shortname+"_"+$current+" is done!\\\"");
														break;														
									}
								} //COSY ONLY
								else
								if ($notify=="1" && $hostname!="")
									$layerCmd+= (" -JobFinishedEvt net send "+$hostname+" Job "+$shortname+"_"+$current+" is done!");
									
								$layerCmd+= (" -Creator " + $hostname);
							}
		
								
							$layerJobIds[size($layerJobIds)]=om_submitSmedgeCmd($layerCmd);
							
						}
					}
				
				//RESET ALL FUCKIN INCLUDES
				setAttr -type "string" mentalrayGlobals.includes "";
				setAttr -type "string" mentalrayGlobals.links "";
				
				select -cl;
				
				}	
				else {   
				
						system("mkdir c:\\rendertemp\\MI_Files");
						mentalrayBatchExportProcedure( "c:/rendertemp/MI_Files/"+$shortname+".mi"," -perframe 2 -padframe 1 -exportFilter 8212 -tabstop 8 -xp \"311111111\"");						
						
						string	$currentLayer = `editRenderLayerGlobals -q -currentRenderLayer`,
								$localFileName;
						if ($allLayers[1] != "") {
							if ($currentLayer=="defaultRenderLayer") $currentLayer="masterLayer";
							
							//NAMESPACE_CLEANUP!!!!
								$currentLayer = `substituteAllString $currentLayer ":" "_"`;
								
							$localFileName="c:/rendertemp/MI_Files/"+ $shortname+"_"+ $currentLayer +"."+`currentTime -q`+".mi";
							}
						else $localFileName="c:/rendertemp/MI_Files/"+ $shortname+"."+`currentTime -q`+".mi";
							
						system("mkdir c:\\rendertemp\\imageTmp");
						float $aspectRatio=`getAttr defaultResolution.deviceAspectRatio`;
						
						if ($region) {
							string 	$XL=`getAttr defaultRenderGlobals.left`,
									$XH=`getAttr defaultRenderGlobals.rght`,
									$YL=`getAttr defaultRenderGlobals.bot`,
									$YH=`getAttr defaultRenderGlobals.top`;
							exec("cmd /k ray -file_dir C:/rendertemp/imageTmp -imgpipe 1 -samples "+$samples+" -samples_collect 3 -contrast 0.1 0.1 0.1 0.1 -v 5 -window "+$XL+" "+$YL+" "+$XH+" "+$YH+" "+$localFileName+" | imf_disp -notop -");
							}
						else {
							int $width=$aspectRatio*1000;
							system("xcopy /D /I /Y \""+toNativePath($project)+"\\renderScenes\\reuseableMiExports\\*.*\" \"c:\\rendertemp\"");
							exec("cmd /k ray -resolution "+$width+" 1000 -L \"//vinx-server/vr/LIBRARY/mentalRay/mr3568/64/lib\" -I \"//vinx-server/vr/LIBRARY/mentalRay/mr3568/64/include\" -file_dir C:/rendertemp/imageTmp -imgpipe 1 -samples "+$samples+" -samples_collect 3 -contrast 0.1 0.1 0.1 0.1 -v 5 "+$localFileName+" | imf_disp -notop -");
							}
						print ("Rendering Frame to C:\\RENDERTEMP\\IMAGETEMP\\\n");
				}
				
			break;
		}
	
	
	if ($quitMaya)
		quit -force;	
	
	//RESET ALL FUCKIN INCLUDES
	if ($application=="MentalRay Standalone SD") {
				setAttr -type "string" mentalrayGlobals.includes "";
				setAttr -type "string" mentalrayGlobals.links "";
				}
				
	//RESTORE VIEWPORT
	if ((`gmatch $panel "model*"`) && ($alreadyIsolated=="0"))
		isolateSelect -state 0 $panel;		
	
	return ("Layers submitted succesful!");
}

global proc string om_submitSmedgeCmd(string $cmd) {
		// do the command
		
		print ("DEBUG SMEDGE COMMAND:\n"+$cmd+"\n");
		string $jobId;
		int $i;
		for ($i=1;$i<5;$i++) {
		string	$result = `system ($cmd+" -ConnectTimeout "+$i)`,
				$buffer[];			
		//DEBUG
		print ("DEBUG: "+$result+"\n");
		//END DEBUG
		
		tokenize $result ": " $buffer;
		
		string $jobId=$buffer[size($buffer)-1];
		$jobId=`substring $jobId 1 36`;
		
		//print $cmd;
		
		if (size($jobId)!=36) {			
			warning ("No valid JobId recieved after try "+$i+"!");						
			}
		else {
			print( "// Result Job ID " + $jobId + "\n" );
			break;
			}
		}
		if ($i==10) print ($cmd+"\n");
		return $jobId;
}





global proc string[] getMiExportLocationInScene() {

		/*OLDSCHOOL
		string $sel[]=`ls -type transform`,$currentNode,$tags[],$currentTag;
			if (`pluginInfo -q -l vplayer`)
				$sel=`ls -type transform -type PartNode`;
		*/			
		string $nodes[]=`ls -as`,$tempNodes[],$nodesFound[];

		$i=0; //WHILE PROTECTION!!!!
		clear($nodesFound);
		while ($i<100 && size($nodes)) {
			for ($current in $nodes)
				if (attributeExists ("miExportLocation", $current)) {
					$nodesFound[size($nodesFound)]=$current;
					$nodesFound[size($nodesFound)]=(`getAttr ($current+".miExportLocation")`);
					}
				else
					$tempNodes[size($tempNodes)]=$current;
				if (`pluginInfo -q -l vplayer`)
					$nodes=`listRelatives -path -type transform -type PartNode $tempNodes`;
				else
					$nodes=`listRelatives -path -type transform $tempNodes`;
			clear($tempNodes);		
			$i++;
		}
			
			
			
			
			
			return ($nodesFound);
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
global proc string includeAlreadyExported() {


		global string $alreadyExportedObjects[];
		
		string $shortFileName[],
			$includes="";
		int $i=0,$reExport;
		
		if (`getAttr defaultRenderGlobals.enableDefaultLight`) {
			confirmDialog -title "For your information..." -message ("DefaultLighting will now be turned off. Don't complain if your renders are black!");
			setAttr "defaultRenderGlobals.enableDefaultLight" 0;
			}
		
		int $oldStartFrame=`getAttr defaultRenderGlobals.startFrame`,
			$oldEndFrame=`getAttr defaultRenderGlobals.endFrame`;
		setAttr defaultRenderGlobals.startFrame 1;
		setAttr defaultRenderGlobals.endFrame 1;
		
		
		
		
		//START EXPORT

		while ($i<size($alreadyExportedObjects)) {
			
			
		
			//SELECT GEO FOR EXPORT AND TRANSLATE
			select -r -hi $alreadyExportedObjects[$i];
			if (`om_getInheritedVisibility($alreadyExportedObjects[$i])`) {				
				tokenize $alreadyExportedObjects[$i+1] "/\\" $shortFileName;
				$includes+=($shortFileName[size($shortFileName)-1]+" ");
				
				if (attributeExists ("miReExport", $alreadyExportedObjects[$i])) {
					$reExport=`getAttr ($alreadyExportedObjects[$i]+".miReExport")`;
					setAttr ($alreadyExportedObjects[$i]+".miReExport")  0;
				}
				else
					$reExport=0;
				
				if (`filetest -r $alreadyExportedObjects[$i+1]`==0 || $reExport){
					
					
					system ("mkdir \""+toNativePath(`workspace -q -rd`)+"renderScenes\\reuseableMiExports\"");				
					
					string $currentLayer = `editRenderLayerGlobals -q -currentRenderLayer`;
					editRenderLayerGlobals -currentRenderLayer defaultRenderLayer;
					setAttr "defaultRenderLayer.renderable" 1;
					Mayatomr -mi -layer defaultRenderLayer -exportFilter 8380399 -active -binary -xp "n" -file ($alreadyExportedObjects[$i+1]);
					setAttr "defaultRenderLayer.renderable" 0;
					editRenderLayerGlobals -currentRenderLayer $currentLayer;
			
					
				}
			}
			$i+=2;
			
			
			
		}
		
		//RESET VALUES
		setAttr defaultRenderGlobals.startFrame $oldStartFrame;
		setAttr defaultRenderGlobals.endFrame $oldEndFrame;
		
		
		
		return $includes;
}

global proc string includeRenderLayerObjects() {

		///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//EXPORT TEMP OBJECTS PER LAYER	
		global string	$alreadyExportedObjects[];
		
		string	$scene= `file -q -sn`,
				$shortname = `basenameEx $scene`,
				$currentLayer = `editRenderLayerGlobals -q -currentRenderLayer`,
				$includes="mayabase.mi base.mi paint.mi";
				
		
		//INCLUDE ALLREADY EXPORTED OBJECTS
		$includes+=(" "+includeAlreadyExported());
				
		//select -r -vis `ls -type mesh -type nurbsSurface`;
		select -r `ls -type mesh -type nurbsSurface`;
		
		int $i=0;
		while ($i<size($alreadyExportedObjects)) {
			select -d -hi $alreadyExportedObjects[$i];
			$i+=2;
			}

			
		
		string	$miTempExportName=(`workspace -q -rd`+"renderScenes/tempMiExports/");
		system("mkdir \""+toNativePath($miTempExportName)+"\"");
		$miTempExportName+=($shortname+"_"+$currentLayer+".mi");

		int $oldEndFrame=`getAttr defaultRenderGlobals.endFrame`;
		setAttr defaultRenderGlobals.endFrame `getAttr defaultRenderGlobals.startFrame`;

		$miTempExportName = substituteAllString($miTempExportName, ":", "_");
		Mayatomr -mi -active -binary -xp "n" -exportFilter 8380399 -layer $currentLayer -file $miTempExportName;

		setAttr defaultRenderGlobals.endFrame $oldEndFrame;

		$includes+=(" "+$miTempExportName);

		setAttr -type "string" mentalrayGlobals.includes $includes;
		setAttr -type "string" mentalrayGlobals.links "base.dll mayabase.dll paint.dll"; //spheronBRDF.dll spheronIBL.dll spheronShadows.dll


		return $miTempExportName;
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

global proc assignExportLocationAttribute() {
		//ASSIGN FOR ALL ALREADY SELECTED TRANSFORMS
		string	$sel[]=`ls -sl -type transform`,
				$attributeValue,
				$renderdir=`workspace -q -rd`;
		if (`pluginInfo -q -l vplayer`)
			$sel=`ls -sl -type transform -type PartNode`;		

		for ($current in $sel) {
		
			//if ($sel[1]!="" && $sel[0]!="") error ("Select 1 object at a time!");
			
			string $substituteSel=substituteAllString($current, ":", "_");
			string $substituteSel=substituteAllString($substituteSel, "|", "__");
			$attributeValue=$renderdir+("renderScenes/reuseableMiExports/"+$substituteSel+".mi");
			
			
			
			if (!attributeExists ("miExportLocation", $current)) {
				addAttr -ln "miExportLocation" -dt "string"  $current;
				setAttr ($current+".miExportLocation")  -type "string" $attributeValue;
				}
				else
				setAttr ($current+".miExportLocation") -type "string" $attributeValue;
			
			if (!attributeExists ("miReExport", $current)) {
				addAttr -ln "miReExport" -at bool $current;
				setAttr ($current+".miReExport")  0;
				}				
			}
	}









global proc checkFileNodes() {

		string $sel[]=`ls -type file -type mentalrayTexture -type imagePlane`,$fileName,$fileNodes[],$buffers[];
		int $numToks;


		clear($fileNodes);

		for ($current in $sel) {
			if (attributeExists ("fileTextureName", $current))
				$fileName=`getAttr ($current+".fileTextureName")`;
				else if (attributeExists ("imageName", $current))
					$fileName=`getAttr ($current+".imageName")`;
			
				
			//if (`substring $fileName 1 2`=="R:")
				//$fileNodes[size($fileNodes)]=$current;		
			//if (`substring $fileName 1 6`=="//Vinx")
			//	$fileNodes[size($fileNodes)]=$current;		
			
			//FIND SPACES IN FILENAMES!!!!
			$numToks=`tokenize $fileName " " $buffers`;
			if ($numToks>1)
				$fileNodes[size($fileNodes)]=$current;
			
			}
			
		if (size($fileNodes)) {
			print ("Non Linux-conform filepaths...\n");
			print ($fileNodes);
			select -r $fileNodes;
			warning "You have Filetextures in your scene that contain SPACES in their names!";
			}
			else
			print "All Filenodes are fine!\n";
}
 
/////////////////////////////////////////////////
global proc previewMaxwell() {

		string $project=toNativePath(`workspace -q -rd`),
			$file=basenameEx (`file -q -exn`),
			$activeCamera;

		system("mkdir "+$project+"\\mx_export");
		system("mkdir "+$project+"\\images\\preview_"+$file);
		for ($current in `ls -type camera`)
			if (getAttr ($current+".renderable"))
				$activeCamera=$current;

		$filePath=`file -op ("camera="+$activeCamera) -typ "MaxwellScene" -pr -ea ($project+"/mx_export/"+$file+"_"+$activeCamera)`;

global string $submit;

		string $cmd = (toNativePath($submit) + " Script -Type Maxwell Light Simulator -Range 1-1000 -Scene "+$filePath+" -Name "+$file+$activeCamera+" -Extra \" -idcpu:$(SubRange.Start) -p:low -mxi:"+$project+"\\images\\preview_"+$file+"\\"+$file+"_"+$activeCamera+"_$(SubRange.Start).mxi\"");
		print ($cmd+"\n");
		exec $cmd;
}


global proc string om_getMainSceneName() {
		string	$scene   = `file -q -sn`,
				$shortname = `basenameEx $scene`,
				$buffer[],
				$mainSceneName="";
				
		int $i,$j,$numTokens=`tokenize $shortname "_" $buffer`;
		for ($i=$numTokens-1;$i>=0;$i--)
			if (`size $buffer[$i]`==4) 
				if (`substring $buffer[$i] 2 4` && (`substring $buffer[$i] 1 1`=="v"))
					break;

		//print ($buffer[$i]+"\n");
		//print ($i+"\n");


		if ($i>0) {
			$mainSceneName=$buffer[0];
			for ($j=1;$j<$i;$j++) {
				$mainSceneName+=("_"+$buffer[$j]);
				}
			}
			else $mainSceneName=$shortname;

		return $mainSceneName;
}

global proc string om_getMergePsdCommand(string $layers[]) {


		string	$ifnString=" ",$imageFileName[],$buffers[];

		string $imageDir=`workspace -q -rd`+`workspace -q -rte images`;

		for ($current in $layers)
			{
			editRenderLayerGlobals -currentRenderLayer $current;
			$imageFileName=`renderSettings -fin`;
			$ifnString+=" -ifn \""+$current+"\" \"Normal\" \""+$imageDir+"/"+$imageFileName[0]+"\"";
			}

		int $numtokens=`tokenize $imageFileName[0] "/" $buffers`;
		//print $buffers[size($buffers)-2];
		for ($i=0;$i<(size($buffers)-2);$i++)
			$imageDir+=("/"+$buffers[$i]+"/");
		//print $imageDir;
		string $cmd="createLayeredPsdFile -xr 727 -yr 348 "+$ifnString+" -psf \""+$imageDir+"/allTogether.psd\"";

		int $numtokens=`tokenize $cmd "\"" $buffers`;
		$cmd="mayabatch -c \\\"";

		for ($i=0;$i<($numtokens);$i++)
			$cmd+=($buffers[$i]+"\\\\\"\\\"");

		$cmd+="\"";

		return $cmd;
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
global proc string om_getHostname() {
		string $buffer[],$hostname=`system "ipconfig -all"`;

		tokenize $hostname " .:" $buffer;
		for ($i=0;$i<size($buffer);$i++)
			if ($buffer[$i]=="Host" && $buffer[$i+1]=="Name") {
				$hostname=$buffer[$i+2];
				break;	
				}
		tokenize $hostname $buffer; //CLEANUP FROM TABS AND RETURNS
		return $buffer[0];
		}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
global proc string[] om_getSmedgePoolMembers(string $poolname) {
		string $buffer[],$memberArr[],$members=`system ("//Vinxp/work/_SHARED/Smedge3_NetworkInstall_2.3.2/PoolManager.exe ListMembers "+$poolname+" -ConnectTimeout 10")`;
		int $i,$j;
		clear($memberArr);
		tokenize $members  $buffer;

		for ($i=0;$i<size($buffer);$i++) 
			if ($buffer[$i]==($poolname+":")) {
				for ($j=$i+2;$j<size($buffer);$j=$j+2)
					$memberArr[size($memberArr)]=$buffer[$j];
				break;	
				}
		sort($memberArr);
		return $memberArr;
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

global proc om_getMaterialOverrides() {

		string $allLayers[]=`listConnections renderLayerManager`;
		int $hasOverrides=0,$printedOnce;
		
		for ($currentLayer in $allLayers) {
			if ($currentLayer=="defaultRenderLayer")
				continue;			
			$printedOnce=0;
			string $adjustments[]=`editRenderLayerAdjustment -q -layer $currentLayer`;
			
			string $striche="";
			for ($i=0;$i<(size($currentLayer)+8);$i++)
				$striche+="-";	
						
			for ($current in $adjustments)
				if (`gmatch $current "*instObjGroups*"`) {
					if ($printedOnce==0) {
						print ($striche+"\n");
						print ("|   "+$currentLayer+"   |\n");
						print ($striche+"\n");
						$printedOnce=1;
						}
					$hasOverrides=1;
					print ($current+"\n");
					}
		}
		if ($hasOverrides)
			warning "You have Material Overrides in your scene! Check Script Editor...";
		else
			print "No Material Overrides found!";
}

global proc om_removeMaterialOverrides() {
	string $matOverrides[],$allOverrides[]=`editRenderLayerAdjustment -q`;
	clear($matOverrides);
	for ($current in $allOverrides) {
		if (`gmatch $current "*instObjGroups*"`)
			$matOverrides[size($matOverrides)]=$current;
	}

	$currentLayer=`editRenderLayerGlobals -q -currentRenderLayer`;
	editRenderLayerGlobals -currentRenderLayer defaultRenderLayer;
	if (size($matOverrides))
		editRenderLayerAdjustment -layer $currentLayer -remove $matOverrides;
	else
		warning "No Material Overrides found dude...";
	editRenderLayerGlobals -currentRenderLayer $currentLayer;
}

global proc om_transferMaterialOverrides() {
	string	$currentLayer=`editRenderLayerGlobals -q -currentRenderLayer`,
			$matOverrides[],
			$matOverridesLong[],
			$allOverrides[]=`listConnections -p 1 -type shape $currentLayer`,
			$shadingGroup[];
	clear($matOverrides);
	
	for ($current in $allOverrides) {
		if (`gmatch $current "*instObjGroups*"`) {
			$matOverridesLong[size($matOverrides)]=$current;
			string $buffer[];
			tokenize $current "." $buffer;
			string $tmpSG[]=`listConnections -type shadingEngine $buffer[0]`;			
			$shadingGroup[size($matOverrides)]=$tmpSG[0];			
			$matOverrides[size($matOverrides)]=$buffer[0];			
		}
	}

	
	editRenderLayerGlobals -currentRenderLayer defaultRenderLayer;
	if (size($matOverrides))
		editRenderLayerAdjustment -layer $currentLayer -remove $matOverridesLong;
	else
		warning "No Material Overrides found dude...";
	
	for ($i=0;$i<size($matOverrides);$i++) {
		//print ("DEBUG $matOverrides = "+$matOverrides[$i]+"\n");
		//print ("DEBUG $shadingGroup = "+$shadingGroup[$i]+"\n");
		sets -e -fe $shadingGroup[$i] $matOverrides[$i];
		print ("Adding "+$matOverrides[$i]+" to SG: "+$shadingGroup[$i]+"\n");
	}
	editRenderLayerGlobals -currentRenderLayer $currentLayer;
}


global proc int om_getInheritedVisibility(string $obj) {

		//FOR LATER BUGFIXING
		//if (attributeExists visibility $sela[0]))
		int $visibility=`getAttr ($obj+".visibility")`;
		if ($visibility) {
			int $top=0;
			
			string 	$tester[]=`listRelatives -p -path -type transform $obj`,
					$displayLayer[];
			
			if (`pluginInfo -q -l vplayer`)			
				$tester=`listRelatives -p -path -type transform -type PartNode $obj`;
			
			if (size($tester))
				$top=1;
			
			$displayLayer=`listConnections -type displayLayer $obj`;
			if (size($displayLayer)) {
				$visibility*=`getAttr ($displayLayer[0]+".visibility")`;
				//print $displayLayer;
				}
			
			while ($top && $visibility) {
				$tester=`listRelatives -p -path $obj`;
					if (size($tester)) {
					$obj=$tester[0];
					if (`attributeExists visibility $obj`)
						$visibility*=`getAttr ($obj+".visibility")`;
					
					$displayLayer=`listConnections -type displayLayer $obj`;
					if (size($displayLayer))
							$visibility*=`getAttr ($displayLayer[0]+".visibility")`;
					//print ($obj+"\n");
				}
				else break;
				}
			
		}
		return $visibility;
}

global proc string om_createRenderSubset(string $sel[],string $subSetName) {

	string	$selShapes[]=`ls -s $sel`,$subset;
			$sel=`listRelatives -pa -ad -type mesh $sel`;	
			
			appendStringArray ($sel, $selShapes, size($selShapes));
			
			$sel = stringArrayRemoveDuplicates($sel);
			$sel=`listRelatives -pa -p $sel`;
		
	if (objExists($subSetName)) {
		//BREAK ALL OBJECT CONNECTIONS
		string $objects[] =`listConnections -p 1 -s 1 -d 0 -c 1 ($subSetName+".objects")`;

		for ($i=0;$i<size($objects);$i+=2)
			disconnectAttr  $objects[$i+1] $objects[$i];
		}
		else {
			createNode -n $subSetName mip_render_subset;
		}
		
	for ($i=0;$i<size($sel);$i++)
		connectAttr -f ($sel[$i]+".message") ($subSetName+".objects["+$i+"]");

	setAttr ($subSetName+".full_screen_fg") 0;
	om_attachSubset($subSetName);
	
	return $subset;
}

global proc om_attachSubset(string $subSet) {

$subSet=`substitute "-" $subSet "_"`;

string $cams[]=`ls -type camera`;
	for ($current in $cams) {
		if (`getAttr ($current+".renderable")`) {
			string	$renderSubset[]=`listConnections -p 1 -c 1 -type mip_render_subset $current`;				
			print "-----------------\n";
			string $renderLayer=`editRenderLayerGlobals -q -currentRenderLayer`;
			if (size($renderSubset))
				for ($i=0;$i<size($renderSubset);$i+=2) {					
					if ($renderLayer!="defaultRenderLayer") {
						print ("Adding RL-Override to "+ $renderSubset[$i]+"\n");
						editRenderLayerAdjustment -layer $renderLayer $renderSubset[$i];
						}
					print ("Disconnecting "+$renderSubset[$i+1] +" from  " +$renderSubset[$i]+"\n");
					disconnectAttr $renderSubset[$i+1] $renderSubset[$i];
				}

			//string $conns[]=`listConnections -p 1 -s 1 -d 0 -type mip_render_subset $current`;
			for ($i=0;$i<10;$i++) {
				
				string $tempConn[]=`listConnections -d 0 ($current+".miLensShaderList["+$i+"]")`;
				if (!size($tempConn)) {
					if (`editRenderLayerGlobals -q -currentRenderLayer`!="defaultRenderLayer") {
						editRenderLayerAdjustment -layer $renderLayer ($current+".miLensShaderList["+$i+"]");
						print ("Adding RL-Override to "+$current+".miLensShaderList["+$i+"]\n");
						}
					print ("Connecting "+$subSet+".message to " + $current + ".miLensShaderList[" +$i+ "]\n");
					connectAttr -f ($subSet+".message") ($current+".miLensShaderList["+$i+"]") ;					
					break;
				}
			}
			
			print "-----------------\n";
		}
	}
}

global proc om_convertCosyLayers() {


string $sel[]=`ls -sl`;

if (!`objExists renderlayer_global_subset`) {	

	string $renameMe=`createNode mip_render_subset`;
	rename $renameMe renderlayer_global_subset;
	setAttr renderlayer_global_subset.enabled 0;

	string $cams[]=`ls -type camera`;
	for ($current in $cams)	
		if (`getAttr ($current+".renderable")`) {
			string $lensShaders[]=`listConnections ($current+".miLensShaderList")`;
			connectAttr -f renderlayer_global_subset.message ($current+".miLensShaderList["+size($lensShaders)+"]");
			}	
	}
	
string	$cosyName=`getAttr ($sel[0]+".name")`,		
		$layerObjects=`getAttr ($sel[0]+".objectSet_1")`,
		$setMember[]=`sets -q $layerObjects`,
		$cosyPrefix=`getAttr ($sel[0]+".prefix")`,
		$cosyPostfix=`getAttr ($sel[0]+".postfix")`,	
		$renderlayer=createCosyRenderlayer($cosyName,$cosyPrefix,$cosyPostfix);
	
	//NEW ADJUST LENSSHADER OVERRIDE
	string	$camConnections[]=`listConnections -p 1 -type camera renderlayer_global_subset.message`,
			$renderLayerSubset=om_createRenderSubset ($setMember,($renderlayer+"_subset"));
			
	
	for ($currentConnection in $camConnections)
		{
			editRenderLayerAdjustment $currentConnection;
			connectAttr -f ($renderLayerSubset+".message") $currentConnection;
		}
	
	select $sel;
}







global proc om_assignSpecialChannelColors() {

string $sel[]=`ls -type mia_material_pass`;

//RESET ALL COLORS
for ($i=0;$i<size($sel);$i++) {
	setAttr ($sel[$i]+".special_channel1") -type double3 0 0 0;
	setAttr ($sel[$i]+".special_channel2") -type double3 0 0 0;
	setAttr ($sel[$i]+".special_channel3") -type double3 0 0 0;
	setAttr ($sel[$i]+".special_channel4") -type double3 0 0 0;
	//setAttr ($sel[$i]+".special_channel5") -type double3 0 0 0;
	}

/*//CYCLE THROUGH ALL CHANNELS  ---   5 special channels
for ($i=0;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel1") -type double3 1 0 0;

for ($i=1;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel1") -type double3 0 1 0;

for ($i=2;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel1") -type double3 0 0 1;

for ($i=3;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel2") -type double3 1 0 0;

for ($i=4;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel2") -type double3 0 1 0;

for ($i=5;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel2") -type double3 0 0 1;

for ($i=6;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel3") -type double3 1 0 0;

for ($i=7;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel3") -type double3 0 1 0;

for ($i=8;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel3") -type double3 0 0 1;

for ($i=9;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel4") -type double3 1 0 0;

for ($i=10;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel4") -type double3 0 1 0;

for ($i=11;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel4") -type double3 0 0 1;

for ($i=12;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel5") -type double3 1 0 0;

for ($i=13;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel5") -type double3 0 1 0;

for ($i=14;$i<size($sel);$i+=15)
	setAttr ($sel[$i]+".special_channel5") -type double3 0 0 1;
*/

//CYCLE THROUGH ALL CHANNELS  ---   4 special channels
for ($i=0;$i<size($sel);$i+=12)
	setAttr ($sel[$i]+".special_channel1") -type double3 1 0 0;

for ($i=1;$i<size($sel);$i+=12)
	setAttr ($sel[$i]+".special_channel1") -type double3 0 1 0;

for ($i=2;$i<size($sel);$i+=12)
	setAttr ($sel[$i]+".special_channel1") -type double3 0 0 1;

for ($i=3;$i<size($sel);$i+=12)
	setAttr ($sel[$i]+".special_channel2") -type double3 1 0 0;

for ($i=4;$i<size($sel);$i+=12)
	setAttr ($sel[$i]+".special_channel2") -type double3 0 1 0;

for ($i=5;$i<size($sel);$i+=12)
	setAttr ($sel[$i]+".special_channel2") -type double3 0 0 1;

for ($i=6;$i<size($sel);$i+=12)
	setAttr ($sel[$i]+".special_channel3") -type double3 1 0 0;

for ($i=7;$i<size($sel);$i+=12)
	setAttr ($sel[$i]+".special_channel3") -type double3 0 1 0;

for ($i=8;$i<size($sel);$i+=12)
	setAttr ($sel[$i]+".special_channel3") -type double3 0 0 1;

for ($i=9;$i<size($sel);$i+=12)
	setAttr ($sel[$i]+".special_channel4") -type double3 1 0 0;

for ($i=10;$i<size($sel);$i+=12)
	setAttr ($sel[$i]+".special_channel4") -type double3 0 1 0;

for ($i=11;$i<size($sel);$i+=12)
	setAttr ($sel[$i]+".special_channel4") -type double3 0 0 1;

}







/*global proc getCOID() {

	int $i=1; //PROTECT WHILE
	string $sel[]=`ls -sl`,
		$parent=`listRelatives -pa -type PartNode $sel[0]`;
	while(1) {
		$sel=`listRelatives -pa $sel[0]`;
		$parent=`listRelatives -pa -type PartNode $sel[0]`;
		print $parent;
		$i++;	if ($i>100) break;
	}
}
*/


/*
global proc om_updateExrSaver() {

	string $imageName = ( `workspace -q -fn` + "/" + `workspace -q -rte images`+"/");

	int $temp=`getAttr defaultRenderGlobals.animation`,
		$tempExtension=`getAttr defaultRenderGlobals.outFormatControl`;
	setAttr defaultRenderGlobals.animation 0;
	setAttr defaultRenderGlobals.outFormatControl 1;
	
	string $filename[]=`renderSettings -fin`;
	
	setAttr defaultRenderGlobals.animation $temp;
	setAttr defaultRenderGlobals.outFormatControl $tempExtension;
	
	$imageName+=$filename[0];

	for ($current in `ls -type camera`)
		if (getAttr ($current+".renderable")) {
			string $currentEXRsaver[]=`listConnections -type p_OpenEXR_saver $current`;
				if(size($currentEXRsaver)) {
					if (`editRenderLayerGlobals -q -currentRenderLayer`!="defaultRenderLayer")
						editRenderLayerAdjustment ($currentEXRsaver[0]+".fileName");
					setAttr -type "string" ($currentEXRsaver[0]+".fileName") $imageName;
				}
			}
}
*/

global proc om_convertToMiaX() {

	string $currentMiaMaterial[]=`ls -sl -type mia_material_pass`;
	if (!size($currentMiaMaterial))
		error "Select Mia-Pass Material";
	
	for ($currentMia in $currentMiaMaterial) {
		string $conns[]=`listConnections -s 0 -d 1 -p 1 -c 1 -type shadingEngine $currentMia`;
			if (size($conns)) {
			string $newMiaPass=`createNode -n ($currentMia+"_pass") mia_material_x`;
			string $attrType;

			string $attributes[]=`listAttr -v $currentMia`;
			for ($current in $attributes) {
				if ($current=="result")
					break;
				if ($current=="bump" || $current=="lights")
					continue;
				if (!`attributeExists $current $newMiaPass`)
					continue;
				$type=`getAttr -type ($currentMia+"."+$current)`;
				//print ($current+" "+$type+"\n");
				if ($type=="float3") {
					float $float[]=`getAttr ($currentMia+"."+$current)`;
					setAttr ($newMiaPass+"."+$current) -type $type $float[0] $float[1] $float[2];
					}

				else
					setAttr ($newMiaPass+"."+$current) `getAttr ($currentMia+"."+$current)`;

			}
			
			string $conns[]=`listConnections -s 1 -d 0 -p 1 -c 1 $currentMia`,
					$connection;
			for ($i=0;$i<size($conns);$i+=2) {
				$connection=`substring $conns[$i] (size($currentMia)+1) 100`;
				//print $connection;
				if (`gmatch $connection ".special_channel*"`)
					continue;
				if ($connection==".special_bump")
					$connection=".bump";
				connectAttr -f $conns[$i+1] ($newMiaPass+$connection);		
			}
			
			
			$conns=`listConnections -s 0 -d 1 -p 1 -c 1 -type shadingEngine $currentMia`;
			for ($i=0;$i<size($conns);$i+=2) {
				$connection=`substring $conns[$i] (size($currentMia)+1) 100`;
				//print $connection;
				if ($connection==".outValue")
					$connection=".message";
				
				connectAttr -f ($newMiaPass+$connection) $conns[$i+1];
			}
		}
	}	
}

global proc om_convertToMiaPass() {

	string $currentMiaMaterial[]=`ls -sl -type mia_material_x -type mia_material`;
	if (!size($currentMiaMaterial))
		error "Select Mia-Pass Material";
	
	for ($currentMia in $currentMiaMaterial) {
		string $conns[]=`listConnections -s 0 -d 1 -p 1 -c 1 -type shadingEngine $currentMia`;
			if (size($conns)) {
			string $newMiaPass=`createNode -n ($currentMia+"_pass") mia_material_pass`;
			string $attrType;

			string $attributes[]=`listAttr -v $currentMia`;
			for ($current in $attributes) {
				if ($current=="result")
					break;
				if ($current=="bump" || $current=="lights")
					continue;							
				if (!`attributeExists $current $newMiaPass`)
					continue;
				$type=`getAttr -type ($currentMia+"."+$current)`;
				//print ($current+" "+$type+"\n");
				if ($type=="float3") {
					float $float[]=`getAttr ($currentMia+"."+$current)`;
					setAttr ($newMiaPass+"."+$current) -type $type $float[0] $float[1] $float[2];
					}

				else
					setAttr ($newMiaPass+"."+$current) `getAttr ($currentMia+"."+$current)`;

			}
			
			string $conns[]=`listConnections -s 1 -d 0 -p 1 -c 1 $currentMia`,
					$connection;
			for ($i=0;$i<size($conns);$i+=2) {
				$connection=`substring $conns[$i] (size($currentMia)+1) 100`;
				//print $connection;
				//if (`gmatch $connection ".special_channel*"`)
					//continue;
				//if ($connection==".special_bump")
					//$connection=".bump";
				connectAttr -f $conns[$i+1] ($newMiaPass+$connection);		
			}
			
			
			$conns=`listConnections -s 0 -d 1 -p 1 -c 1 -type shadingEngine $currentMia`;
			for ($i=0;$i<size($conns);$i+=2) {
				$connection=`substring $conns[$i] (size($currentMia)+1) 100`;
				//print $connection;
				if ($connection==".message")
					$connection=".outValue";
				
				connectAttr -f ($newMiaPass+$connection) $conns[$i+1];
			}
		}
	}	
}

global proc om_replaceShaders() {

	string $shadingGroups[]=`ls -type shadingEngine`;

	for ($currSG in $shadingGroups) {
		 string $sgMembers[]=`listConnections ($currSG+".dagSetMembers")`;
			 for ($current in $sgMembers)
				if (`gmatch $current "clashed_*"`) {
					$current=`substring $current 9 3000`;
					//select -add $current;
					if (`objExists $current`)
						sets -e -forceElement $currSG $current;
				}
	}
}




global proc  om_connect_lm_2dmv() {
	$sel=`ls -type mia_material_pass`;
	for ($current in $sel) {
		string $hasSG[]=`listConnections -type shadingEngine $current`;
		if (size($hasSG)) {
			connectAttr -f lm2DMV_v21.outValueR ($current+".special_channel5R");
			connectAttr -f lm2DMV_v21.outValueG ($current+".special_channel5G");
		}

			
	}
}

global proc om_assignMiLabel() {

	$sel=`ls -sl -type transform`;
	for ($current in $sel)
	if (!`attributeExists miLabel $current`) {
		addAttr -ln "miLabel"  -at long  -dv 1 $current;
		setAttr -e-keyable true ($current+".miLabel");
	}
	
}

global proc om_findNonMia() {

	string $sel[]=`ls -type mesh -type nurbsSurface`,
		$shader[]=`listConnections -type shadingEngine $sel`,
		$mia[];

	$shader = stringArrayRemoveDuplicates($shader);
	select -cl;

	for ($current in $shader) {
		$mia=`listConnections -type mia_material_pass ($current+".miMaterialShader")`;
		if (!size($mia))
		select -add -ne $current;
	//		print ($current+"\n");
	}
}

global proc om_assignRandomShader() {

//ASSIGN RANDOM SHADER
//SELECT OBJECTS AND SHADERS THAT U WANT TO DISTRIBUTE RANDOMLY

	string $shader[]=`listConnections -type shadingEngine`,
		$meshes[]=`listRelatives -pa -s -type mesh -type nurbsSurface`;

	$shader=stringArrayRemoveDuplicates($shader);

	for ($current in $meshes) {
		int $rand=`rand 0 (size($shader))`;
		sets -e -forceElement $shader[$rand] $current;
		}
}


global proc om_setRenderStats() {
	string $sel[]=`ls -type mesh`;
	editRenderLayerGlobals -currentRenderLayer defaultRenderLayer;
	for ($current in $sel) {
		catch(`setAttr ($current+".visibleInReflections") 1`);
		catch(`setAttr ($current+".visibleInRefractions") 1`);
	}
}


global proc string[] om_getRenderDir() {

	string	$currentLayer=`editRenderLayerGlobals -q -currentRenderLayer`,
			$imageDir = `workspace -q -rte images`,
			$rglobalsPrefix=`getAttr defaultRenderGlobals.imageFilePrefix`,
			$buffer[],
			$returnValue[];

	//IF VRAY IS THE CURRENT REMDERER USE ITS OWN PREFIX
	if (currentRenderer() == "vray")
		$rglobalsPrefix=`getAttr vraySettings.fileNamePrefix`;
	
	//IF IMAGEPATH ALREADY CONTAINS A FULL SERVERPATH DO NOT ADD THE PROJECT IN FRONT OF IMAGEDIR-NAME
	if (!`gmatch $imageDir "//*"` && !`gmatch $imageDir "\\\\*"` && !`gmatch $imageDir "*:*"` )
		$imageDir = ( `workspace -q -fn` + "/" + `workspace -q -rte images`);
			
	if ($rglobalsPrefix=="")
		$rglobalsPrefix="<Layer>/<Scene>";
	else
		if (!`gmatch $rglobalsPrefix "*<Layer>*"`)
			$rglobalsPrefix="<Layer>/"+$rglobalsPrefix;
	
	//Namespace cleanup
	tokenize $currentLayer ":" $buffer;

	$currentLayer=$buffer[size($buffer)-1];
	if ((currentRenderer() == "vray") && ($currentLayer=="defaultRenderLayer")) {
		string $allLayers[] = `listConnections renderLayerManager.renderLayerId`;
		if (size($allLayers)>1)
			$rglobalsPrefix=`substituteAllString $rglobalsPrefix "<Layer>" "masterLayer"`;
		else
			$rglobalsPrefix=`substituteAllString $rglobalsPrefix "<Layer>" ""`;
		}
	else
		$rglobalsPrefix=`substituteAllString $rglobalsPrefix "<Layer>" $currentLayer`;
	
	string $version=`getAttr defaultRenderGlobals.renderVersion`;
	$rglobalsPrefix=`substituteAllString $rglobalsPrefix "<Version>" $version`;
	
	string $file=`file -q -exn`;
	$file=basenameEx($file);
	$rglobalsPrefix=`substituteAllString $rglobalsPrefix "<Scene>" $file`;

	string $vrayCam=`getAttr vraySettings.batchCamera`;
	$vrayCam = `substituteAllString $vrayCam ":" "_"`;
	$rglobalsPrefix=`substituteAllString $rglobalsPrefix "<Camera>" $vrayCam`;
	
	tokenize $rglobalsPrefix "\\/" $buffer;
	for ($i=0;$i<size($buffer)-1;$i++)
		$imageDir+=("/"+$buffer[$i]);

		
	//GET EXTENSION
	string $extbuffer[],$extension[]=`renderSettings -fin`;
	tokenize $extension[0] "." $extbuffer;
	
		
	$returnValue[0]=$imageDir;
	$returnValue[1]=$buffer[size($buffer)-1];
	$returnValue[2]=$extbuffer[size($extbuffer)-1];;
return $returnValue;
}




global proc om_vrayRenderVertexColors() {

	string $sel[]=`ls -sl -type transform`,
			$switch,
			$surfaceShader,
			$alreadyConnected[];
		
	
	
	if (!`objExists occlusion_tripleSwitch`)
		$switch=`shadingNode -asUtility tripleShadingSwitch -name occlusion_tripleSwitch`;
	else {
		$alreadyConnected=`listConnections -type mesh occlusion_tripleSwitch`;
		//delete `listConnections -type VRayVertexColors occlusion_tripleSwitch`;
		delete occlusion_tripleSwitch;
		
		$switch=`shadingNode -asUtility tripleShadingSwitch -name occlusion_tripleSwitch`;
	}
	
	if (!`objExists occlusion_vertexColor`)	
		$surfaceShader=`shadingNode -asShader surfaceShader -name occlusion_vertexColor`;
	else $surfaceShader="occlusion_vertexColor";
	
	catch(`connectAttr -f ($switch+".output") ($surfaceShader+".outColor")`);
	
	string $shapes[]=`listRelatives -f -shapes $sel`;
	appendStringArray ($shapes, $alreadyConnected, size($alreadyConnected));
	$shapes = stringArrayRemoveDuplicates($shapes);	
	
	for ($i=0;$i<(size($shapes));$i++) {
		print a;
		
		string $vertexColors[]=`listConnections -type VRayVertexColors $shapes[$i]`;
		
		if(size($vertexColors))
			$tmpName=$vertexColors[0];
		else {
			$tmpName=`shadingNode -asTexture VRayVertexColors -name ($shapes[$i]+"_vrayVertexColor")`;
			connectAttr -f ($shapes[$i]+".colorSet[0].colorName") ($tmpName+".colorSet");
			}		
		print (	$shapes[$i]+"\n");
		connectAttr -f ($shapes[$i]+".instObjGroups[0]") ($switch+".input["+$i+"].inShape");
		connectAttr -f ($tmpName+".outColor") ($switch+".input["+$i+"].inTriple");
	}
	
	select $surfaceShader;
	
	//USE COLORSET 1 INSTEAD OF 0
	//string $sel[]=`ls -sl`;
		//for ($i=0;$i<size($sel);$i+=2)
			//connectAttr -f ($sel[$i]+".colorSet[1].colorName") ($sel[$i+1]+".colorSet");

	
	
}



global proc om_createFileNodeSwitch() {

	string $sel[]=`ls -sl -type transform`,
			$surfaceShader=`shadingNode -asShader surfaceShader -name curvature`,
			$switch=`shadingNode -asUtility tripleShadingSwitch -name curvature_tripleSwitch`;

		connectAttr -f ($switch+".output") ($surfaceShader+".outColor");

		for ($i=0;$i<size($sel);$i++) {
			string $tmpName=`shadingNode -asTexture file -name ($sel[$i]+"_curvature_file")`,
				$shape[]=`listRelatives -f -shapes $sel[$i]`;

			setAttr -type "string" ($tmpName+".fileTextureName") ("//pslsrv10/pslsrv10/Projects/TMW09_ANM06_Infiniti_G37_Convertible/TM09A06_3D/TM09A06_Playground/OliO/textures/curvature/CURVATURE_"+$sel[$i]+".hdr");
			setAttr ($tmpName+".disableFileLoad") 1;


			connectAttr -f ($shape[0]+".instObjGroups[0]") ($switch+".input["+$i+"].inShape");
			connectAttr -f ($tmpName+".outColor") ($switch+".input["+$i+"].inTriple");
		}
		
		select $surfaceShader;
}


global proc om_addToSwitch() {

	string $sel[]=`ls -sl -type transform`,
		$switch[]=`ls -sl -type tripleShadingSwitch`,
		$conns[]=`listConnections -type mesh $switch[0]`;
		
	int $offset=size($conns);
	for ($i=$offset;$i<(size($sel)+$offset);$i++) {
		string $shape[]=`listRelatives -f -shapes $sel[$i-$offset]`;
		connectAttr -f ($shape[0]+".instObjGroups[0]") ($switch[0]+".input["+$i+"].inShape");
	}
}

global proc om_duplicateLastSwitchInput() {
	string $switch[]=`ls -sl -type tripleShadingSwitch`,
		$conns[]=`listConnections -type mesh $switch[0]`,
		$lastInput[];

	for ($i=0;$i<size($conns);$i++) {
		string $tmp[]=`listConnections -p 1 ($switch[0]+".input["+$i+"].inTriple")`;
		if (size($tmp))
			$lastInput=$tmp;
		else
			connectAttr -f $lastInput[0] ($switch[0]+".input["+$i+"].inTriple");
		}
}

global proc om_createVrayProxy(int $exportAnimation, int $update) {

	editRenderLayerGlobals -currentRenderLayer defaultRenderLayer;

	string	$sel[]=`ls -sl -type transform`,
			$shape[]=`listRelatives -f -type mesh $sel`,
			$directory=`workspace -q -rd` + "vray/" + basenameEx(`file -q -exn`)+"/";
	float	$startFrame=`currentTime -q`,
			$endFrame=$startFrame;
	
	select -cl;
	
	if ($exportAnimation) {
		$startFrame=`playbackOptions -q -min`;
		$endFrame=`playbackOptions -q -max`;
		}
			
	
	system("mkdir "+toNativePath($directory));

	global string $gMainProgressBar;
	progressBar -edit    -beginProgress    -isInterruptable true    -status "Creating Vray Proxies ..."    -maxValue `size($shape)`    $gMainProgressBar;
	
	int $index=0;
	for ($current in $shape) {	
		select -r $current;
		
		//REMEMBER SHADINGGROUP!!!!!
		string $sg[]=`listConnections -type shadingEngine $current`;
		if (!attributeExists ("shadingGroup", $current)) {
				addAttr -ln "shadingGroup" -dt "string"  $current;
		}
		setAttr ($current+".shadingGroup") -type "string" $sg[0];
		
		int $numTris[]=`polyEvaluate -t $current`;
		string $tmp[]=`ls $current`;		
		$current=substituteAllString($tmp[0], "|", "___");
		//REMOVE THE FOLLOWING LINE
		string $hasProxy[]=`listConnections -type VRayMesh $tmp[0]`;
		
		$lastCharacter=size($current);
		$firstCharacter=$lastCharacter-150;
		if ($firstCharacter<1)
			$firstCharacter=1;
		string $truncatedName=`substring $current $firstCharacter $lastCharacter`;	
		
		if (`filetest -r ($directory+"/"+$truncatedName)`)
			$truncatedName=$truncatedName+"_"+$index;
		trace ("DEBUG - current node: "+$current+"\n");
		//if (!size($hasProxy))
		if (!om_hasVrayMesh($tmp[0]))
			if ($exportAnimation) 
				vrayCreateProxy -fname ($truncatedName+".vrmesh") -previewFaces ($numTris[0]/20) -dir $directory -overwrite -animOn -animType 3 -startFrame $startFrame -endFrame $endFrame -exportType 2; // -vertexColorsOn -velocityOn 
			else
				vrayCreateProxy -fname ($truncatedName+".vrmesh") -createProxyNode -previewFaces ($numTris[0]/20) -vertexColorsOn -dir $directory -overwrite -animType 3 -startFrame $startFrame -endFrame $endFrame -exportType 2; //-createProxyNode
		else if ($update) {
				vrayCreateProxy -fname ($truncatedName+".vrmesh") -previewFaces ($numTris[0]/20) -dir $directory -overwrite -animType 3 -startFrame $startFrame -endFrame $endFrame -exportType 2;
				//REMEMBER LAST PROXYNAME
				string $oldFileName=`getAttr ($hasProxy[0]+".fileName") ($truncatedName+".vrmesh")`;
				
				if(!attributeExists ("originalFileName", $hasProxy[0]))
					addAttr -ln "originalFileName"  -dt "string"  $hasProxy[0];
				setAttr -type "string" ($hasProxy[0]+".originalFileName") $oldFileName;
				
				setAttr -type "string" ($hasProxy[0]+".fileName") ($truncatedName+".vrmesh");
				
			 }
			 else
				print ($current+" already has a proxy!\n");
		


	if(`progressBar -query -isCancelled $gMainProgressBar`)
       break;
	progressBar -edit -step 1 $gMainProgressBar;
	$index++;
	}
	progressBar -edit    -endProgress    $gMainProgressBar;
	select -cl;

	
}

global proc om_assignVrayProxy() {

	string $sel[]=`ls -sl -type transform`;
	
	global string $gMainProgressBar;
	progressBar -edit    -beginProgress    -isInterruptable true    -status "Creating Vray Proxies ..."    -maxValue `size($sel)`    $gMainProgressBar;

	
	for ($i=0;$i<size($sel);$i++) {
		string $shape[]=`listRelatives -f -shapes $sel[$i]`;
		tokenize $shape[0] "|" $shape;
		
		$shape[0]=$shape[size($shape)-1];		
		
		if (!`objExists ($shape[0]+"_proxy")`) 
			createNode VRayMesh -n ($shape[0]+"_proxy");
		
		catch(`connectAttr ($shape[0]+"_proxy.output") ($shape[0]+".inMesh")`);
		
		setAttr -type "string" ($shape[0]+"_proxy.fileName") ("//pslsrv10/pslsrv10/Projects/TMW09_ANM06_Infiniti_G37_Convertible/TM09A06_3D/TM09A06_Models/TM09A06_Car/vrayProxies/v001/"+$sel[$i]+".vrmesh");;
		setAttr ($shape[0]+"_proxy.showBBoxOnly") 1;
		
		
		if(`progressBar -query -isCancelled $gMainProgressBar`)
        break;
		progressBar -edit -step 1 $gMainProgressBar;

	}
	
	progressBar -edit    -endProgress    $gMainProgressBar;
	select -r $sel;
}


global proc om_convertShadersToVray() {

	string $sel[]=`ls -sl -type shadingEngine`;
	
	if (!size($sel))
		$sel=`listConnections -type shadingEngine`;
		
	$sel = stringArrayRemoveDuplicates($sel);
	
	for ($current in $sel) {
		string	$tmpName[]=`listConnections ($current+".surfaceShader")`,
				$type=`nodeType($tmpName[0])`,
				$newMtl;
				
		if (`gmatch $type "VRay*"`)
			continue;
				
		$newMtl=`createNode -n ($tmpName[0]+"_VRAY") VRayMtl`;
				
		//diffuse
		float $diffuse[]=`getAttr ($tmpName[0]+".color")`;
		setAttr ($newMtl+".diffuseColor") -type double3 $diffuse[0] $diffuse[1] $diffuse[2];
		setAttr ($newMtl+".diffuseColorAmount") `getAttr ($tmpName[0]+".diffuse")`;
		
		if ($type=="blinn") {			
			
			setAttr ($newMtl+".useFresnel") 1;
			
			setAttr ($newMtl+".reflectionGlossiness") (1-`getAttr ($tmpName[0]+".eccentricity")`);
			
			float $refl=`getAttr ($tmpName[0]+".reflectivity")`;
			setAttr ($newMtl+".reflectionColorAmount") $refl;

			float $reflColor[]=`getAttr ($tmpName[0]+".specularColor")`;
			setAttr ($newMtl+".reflectionColor") -type double3 $reflColor[0] $reflColor[1] $reflColor[2];

		}
		
		string $allConnectedSGs[]=`listConnections -type shadingEngine $tmpName[0]`;
		for ($sg in $allConnectedSGs) {
			connectAttr -f ($newMtl+".outColor") ($sg+".surfaceShader");		
			connectAttr -f ($tmpName[0]+".message") ($sg+".miMaterialShader");
			}

	}


}



global proc om_camToNuke() {

	string $cam=`getAttr vraySettings.batchCamera`,
			$camShape[]=`listRelatives -s $cam`;

	float	$startFrame=`playbackOptions -q -min`,
			$endFrame=`playbackOptions -q -max`,
			$i;
			
	float	$horAp=`getAttr ($camShape[0]+".horizontalFilmAperture")`*25.4,
			$vertAp=`getAttr ($camShape[0]+".verticalFilmAperture")`*25.4;
	string $chanFile=(`workspace -q -rd`+"../nuke/"+$cam+"_4_nuke_"+$horAp+"_"+$vertAp+".chan");
	
	int $fileId=`fopen $chanFile`;

	//ISOLATE SELECT FOR ANIMATION EXPORT SPEEDUP
	string $panel=`getPanel -wf`;
	int $alreadyIsolated;			
	if ((`gmatch $panel "model*"`)) {
		$alreadyIsolated=`isolateSelect -q -state $panel`;
			if (!$alreadyIsolated) isolateSelect -state 1 $panel;
	}
	
	for ($i=$startFrame;$i<=$endFrame;$i++) {
		currentTime $i;
		float	$posWS[]=`xform -q -ws -t $cam`,
				$rotWS[]=`xform -q -ws -ro $cam`,
				$focalLength=`getAttr ($camShape[0]+".focalLength")`;
	
		
		fprint $fileId ($i+" "+$posWS[0]+" "+$posWS[1]+" "+$posWS[2]+" "+$rotWS[0]+" "+$rotWS[1]+" "+$rotWS[2]+" "+$focalLength+"\n");
	}
	
	fclose $fileId;	
	
	//RESTORE VIEWPORT
	if ((`gmatch $panel "model*"`) && ($alreadyIsolated=="0"))
		isolateSelect -state 0 $panel;	
}


global proc om_makeTiledEXR() {

	string $sel[]=`ls -sl -type file`;

	for ($current in $sel) {
		string $fileName=`getAttr ($current+".fileTextureName")`;
		if (`gmatch $fileName "*.exr"` && !`gmatch $fileName "*TILED*"`) {

			//string $buffer[];
			//tokenize $fileName "\\/" $buffer;
			//$newFileName=$buffer[size($buffer)-1];
			$newFileName=`substring  $fileName 1 (size($fileName)-4)`;
			$newFileName=($newFileName+"_TILED.exr");

			if (!`filetest -r $newFileName`) {
				string $cmd = ("exrmaketiled -v -m \""+$fileName+"\" \""+$newFileName+"\"");
				print ($cmd+"\n");
				exec $cmd;
			}
			if(!attributeExists ("originalFileName", $current))
				addAttr -ln "originalFileName"  -dt "string"  $current;
			
			setAttr -type "string" ($current+".originalFileName") $fileName;		
			//setAttr ($current+".filterType") 1;
			setAttr ($current+".disableFileLoad") 1;

			setAttr -type "string" ($current+".fileTextureName") $newFileName;		



			
		}
	}
}

global proc om_fileTexturesToEXR() {

	string $sel[]=`ls -sl -type file`;

	for ($current in $sel) {
		string $fileName=`getAttr ($current+".fileTextureName")`;
		if (!`gmatch $fileName "*.exr"`) {			
			$newFileName=`substring  $fileName 1 (size($fileName)-4)`;
			$newFileName=($newFileName+".exr");
			
			if(!attributeExists ("originalFileName", $current))
				addAttr -ln "originalFileName"  -dt "string"  $current;
			
			setAttr -type "string" ($current+".originalFileName") $fileName;		
			
			setAttr ($current+".disableFileLoad") 1;

			setAttr -type "string" ($current+".fileTextureName") $newFileName;		



			
		}
	}
}

global proc om_fileTexturesToC() {

	string $sel[]=`ls -sl -type file`;

	for ($current in $sel) {
		string $fileName=`getAttr ($current+".fileTextureName")`;
		if (`gmatch $fileName "E:*"`) {			
			$newFileName=`substring  $fileName 2 (size($fileName))`;
			$newFileName=("C"+$newFileName);
			
			setAttr -type "string" ($current+".fileTextureName") $newFileName;		
			
		}
		if (`gmatch $fileName "*fsrv-muc-01*"`) {			
			$newFileName=`substring  $fileName 14 (size($fileName))`;
			$newFileName=("C:"+$newFileName);
			print $newFileName;
			
			setAttr -type "string" ($current+".fileTextureName") $newFileName;		
			
		}
	}
}


global proc om_restoreNonTiledEXR() {


string $sel[]=`ls -sl -type file`;

	for ($current in $sel) {
		string $fileName=`getAttr ($current+".fileTextureName")`;
		if (`gmatch $fileName "*_TILED.exr"`) {

			$newFileName=`substring $fileName 1 (size($fileName)-10)`;
			$newFileName+=".exr";		
			
			setAttr ($current+".disableFileLoad") 1;
			setAttr -type "string" ($current+".fileTextureName") $newFileName;		
			
		}
	}

}


global proc om_connectToVrayObjectPropertiesNode(string $vopName, string $sel[]) {
	if (!size($sel))
		$sel=`ls -sl -type transform`;
	if (!size($vopName)) {
		string $vrayObj[]=`ls -sl -type VRayObjectProperties`;
		$vopName=$vrayObj[0];
		}

	string	$conns[]=`listConnections $vopName`,
			$realSelection[]=`ls -sl`;
	
	appendStringArray($sel, $conns, size($conns));
	$sel=stringArrayRemoveDuplicates($sel);	
	
	
	
	int $index=0;	
	int $yesToAll=0;
	int $noToAll=0;
	
	for ($current in $sel) {
		string $tmp[]=`ls -r 1 $current`;
		$current=$tmp[0];
		if (`objExists $current`)
			if (`nodeType $current`=="transform" || `nodeType $current`=="mesh") {
			
			string $connectedVOP[]=`listConnections -type VRayObjectProperties $current`;
			
			//check if i am alrady connected		
			if ($connectedVOP[0]!=$vopName) {
				if ($connectedVOP[0]=="default_VOP" || $connectedVOP[0]=="") {
					//sets COMMAND verhindert UNDO!!! ACHTUNG!
					//connectAttr -f ($current+".instObjGroups[0]") ($vopName+".dagSetMembers["+$index+"]");
					sets -edit -forceElement  $vopName $current ;
				}
				else {
					if ($yesToAll) {
						//connectAttr -f ($current+".instObjGroups[0]") ($vopName+".dagSetMembers["+$index+"]");
						sets -edit -forceElement  $vopName $current ;
					}
					else 
					if ($noToAll==0) {
						global string $gMainWindow;
						string $currentShort[];
						int $numToks=`tokenize $current "|" $currentShort`;
						
						select -r $current;
						refresh;
						
						string $dialog=`confirmDialog -title "Confirm" -p $gMainWindow -messageAlign "center" -message ($currentShort[$numToks-1]+"\nis already connected to:\n"+$connectedVOP[0]+"\n\nReally move to:\n"+$vopName) -button "Yes" -button "Yes to all" -button "No" -button "No to all" -button "Cancel" -defaultButton "No" -cancelButton "No" -dismissString "Cancel"`;
						if ($dialog=="Cancel")
							error "Aborted!";
						if ($dialog=="Yes") {
							//connectAttr -f ($current+".instObjGroups[0]") ($vopName+".dagSetMembers["+$index+"]");
							sets -edit -forceElement  $vopName $current ;
						}
						if ($dialog=="Yes to all") {
							//connectAttr -f ($current+".instObjGroups[0]") ($vopName+".dagSetMembers["+$index+"]");
							sets -edit -forceElement  $vopName $current ;
							$yesToAll=1;
						}
						if ($dialog=="No to all")
							$noToAll=1;
					}
				}
			}
			else {
					//string $connection[]=`listConnections -c 1 -p 1 -s 1 -d 1 -type VRayObjectProperties $current`;				
					//disconnectAttr $connection[0] $connection[1];
					//connectAttr -f ($current+".instObjGroups[0]") ($vopName+".dagSetMembers["+$index+"]");
					sets -edit -forceElement  $vopName $current ;
				}
			$index++;
		}
	}
	
	select -r -ne $realSelection;
	
}


global proc om_proxyPath() {
	string $sel[]=`ls -type VRayMesh`;
	int $counter=0;
	for ($current in $sel) {
		string $fileName=`getAttr ($current+".fileName")`,
			$buffer[];

		tokenize $fileName "/\\" $buffer;
		
		string $serverpath=`workspace -q -rd`;
		$serverpath=`substituteAllString $serverpath "//Blackout" "c:"`;
		string $localDir=($serverpath+"vray/");
		
		if (!`gmatch $fileName ($localDir+"*")`) {
			setAttr -type "string" ($current+".fileName") ($localDir+$buffer[size($buffer)-2]+"/"+$buffer[size($buffer)-1]);
			$counter++;}
	}
	print ($counter+" filenames updated!\n");
}


	
global proc om_cleanUpVrayProxies(string $destination) {  // PLEASE USE FORWARD SLASHES!!!

	string $vrm[]=`ls -type VRayMesh`;

	int $i=0;
	for ($current in $vrm) {
		string $file=`getAttr ($current+".fileName")`;

		//print ($file+"\n");
		string $result=system("xcopy /D /I /Y \""+toNativePath($file)+"\" \""+toNativePath($destination)+"\"");
		string $buffer[],$newFile;
		int $size=`tokenize $file "/" $buffer`;
		$newFile=($destination+"/"+$buffer[$size-1]);
		setAttr -type "string" ($current+".fileName") $newFile;
		//print ($newFile+"\n");
		
	}
}	



global proc om_selectNonShaded() {

	string $sela[]=`ls -type shape`,
		$conns[];
	clear($conns);
	for ($current in $sela) {
		$conns=`listConnections -type shadingEngine $current`;
		//print ("DEBUG: "+$current+"\n");
		//print $conns;
		if ($conns[0]=="") {
			//print "aaaa\n";
			select -add $current;

		} 
		clear($conns);
	}
}


global proc om_removeVrayMeshMaterial() {
	select -cl;
	string $vrayMeshMtl[]=`ls -type VRayMeshMaterial`,
		$realShaders[];

	for ($currentMeshMtl in $vrayMeshMtl) {
		string $tmp[]=`listConnections ($currentMeshMtl+".shaders")`;
		appendStringArray($realShaders, $tmp,size($tmp));
	}
	$realShaders=stringArrayRemoveDuplicates($realShaders);

	for ($current in $realShaders) {
		$vrayMeshMtl=`listConnections -type VRayMeshMaterial $current`;
		string $ownShadingGroup[]=`listConnections -type shadingEngine $current`;
		
		//CREATE EMPTY SG IF NOT ALREADY PRESENT
		if (!size($ownShadingGroup)) {
			//print ("sets -em -r 1 -nss 1 -n "+$current+"SG\n");
			$ownShadingGroup[0]=`sets -em -r 1 -nss 1 -n ($current+"SG")`;
			connectAttr -f ($current+".message") ($ownShadingGroup[0]+".surfaceShader");			
		}
		for ($currentVrayMeshMtl in $vrayMeshMtl) {
			string $currentSG[]=`listConnections -type shadingEngine $currentVrayMeshMtl`,
				$member[]=`sets -q $currentSG`;			
			sets -e -forceElement $ownShadingGroup[0] $member;
			
			for ($currentShape in $member)
				if (attributeExists ("shadingGroup", $currentShape)) {
					string $origSG=`getAttr ($currentShape+".shadingGroup")`;
					if (`objExists $origSG`)
						sets -e -forceElement $origSG $currentShape;
				}
			catch(`delete $currentSG`);
			catch(`delete $currentVrayMeshMtl`);
		}
	}		
}


global proc om_renameUniqueStart() {

	string $sel[]=`ls -sl -type transform`;
	int $numTransforms=size(`listRelatives -ad -type transform`);

	global string $gMainProgressBar;
	progressBar -edit    -beginProgress    -isInterruptable true    -status ("Renaming "+$numTransforms+" nodes...")    -maxValue $numTransforms    $gMainProgressBar;

	for ($currentNode in $sel)
		om_renameUnique($currentNode);

	progressBar -edit    -endProgress    $gMainProgressBar;
	
}	

global proc om_renameUnique(string $nextNode) {	
	
	global string $gMainProgressBar;
	//if(`progressBar -query -isCancelled $gMainProgressBar`)
      // break;
	progressBar -edit -step 1 $gMainProgressBar;
	
	
	string $childs[]=`listRelatives -f -type transform $nextNode`;
	if (size($childs)) //RECURSE YOURSELF!
		for ($current in $childs)
			om_renameUnique($current);

	string	$buffer[],
			$tmp[]=`ls -r 1 $nextNode`;
	$nextNode=$tmp[0];
	tokenize $nextNode "|" $buffer;
	string	$objName=$buffer[size($buffer)-1],
			$newName=$objName;
	//print ("DEBUG: "+$newName+"\n");
	$counter=0;
	if (size(`ls -r 1 -type transform $newName`)>1) {
		while (size(`ls -r 1 -type transform $newName`)) {
			$newName=$objName+$counter;
			$counter++;	
			}	
	
		string $result=`rename $nextNode $newName`;
		string $shapes[]=`listRelatives -f -s $result`;
		for ($i=0;$i<size($shapes);$i++)
			rename $shapes[$i] ($newName+"Shape"+$i);
		print ("DEBUG: renamed "+$nextNode+" to "+$newName+"\n");
		}
}





global proc reallyReverseNormal() {

	string $selection[] = `ls -sl`;

	for($obj in $selection)
	{

	string $normalNode[] = `polyNormal -normalMode 3 -userNormalMode 1 -ch 1 $obj`;
	setAttr ($normalNode[0]+".userNormalMode") 1;

	}
}


global proc string[] om_getLowestLevelTransforms (string $sel[]) {

	//CONVERT SELECTION TO LOWEST TRANSFORM
		string $childTransforms[]=`listRelatives -ad -f -type transform $sel`;
		appendStringArray($sel, $childTransforms, size($childTransforms));	
		string $lowLevelTransforms[];
		int $index=0;
		for ($current in $sel) {
			string $shape[]=`listRelatives -s $current`;
			if (size($shape)) {
				$lowLevelTransforms[$index]=$current;
				$index++;
			}
		}
	return $lowLevelTransforms;
}


global proc om_deleteUVSets () {
	string $sel[]=`ls -type transform`;
	for ($current in $sel) {
		string $allSets[]=`polyUVSet -q -allUVSets $current`;
		if (size($allSets)>1)
			for ($currentSet in $allSets)
				if (!`gmatch $currentSet "uvs_*"`) {
					//print $current;
					catch(`polyUVSet -delete -uvSet $currentSet $current`);
					}
	}
}


global proc om_findHighestMatId () {
	string $sg[]=`ls -type shadingEngine`,
		$vrayMatIds[];

	int $index;
	for ($current in $sg)
		if (`attributeExists "vrayMaterialId" $current`) {
			$vrayMatIds[$index]=`getAttr ($current+".vrayMaterialId")`;
			$index++;
		}
	$vrayMatIds=sort($vrayMatIds);
	print $vrayMatIds;
}


global proc om_findNoMatId () {
	string $sg[]=`ls -type shadingEngine`;	

	select -cl;
	for ($current in $sg)
		if (!`attributeExists "vrayMaterialId" $current`)
			select -add `sets -q $current`;			
}


global proc om_setupMultiMattes () {

	catch(`setAttr ("vrayRE_Multi_Matte.vray_redid_multimatte") 1`);
	catch(`setAttr ("vrayRE_Multi_Matte.vray_greenid_multimatte") 2`);
	catch(`setAttr ("vrayRE_Multi_Matte.vray_blueid_multimatte") 3`);
	catch(`setAttr ("vrayRE_Multi_Matte.vray_usematid_multimatte") 1`);
	catch(`setAttr ("vrayRE_Multi_Matte.vray_affectmattes_multimatte") 0`);

	catch(`setAttr ("vrayRE_Multi_MatteEx.vray_redid_multimatte") 101`);
	catch(`setAttr ("vrayRE_Multi_MatteEx.vray_greenid_multimatte") 102`);
	catch(`setAttr ("vrayRE_Multi_MatteEx.vray_blueid_multimatte") 103`);
	catch(`setAttr ("vrayRE_Multi_MatteEx.vray_usematid_multimatte") 1`);
	catch(`setAttr ("vrayRE_Multi_MatteEx.vray_affectmattes_multimatte") 0`);
	

	for ($i=1;$i<34;$i++) {
		catch(`setAttr ("vrayRE_Multi_Matte"+$i+".vray_redid_multimatte") ($i*3+1)`);
		catch(`setAttr ("vrayRE_Multi_Matte"+$i+".vray_greenid_multimatte") ($i*3+2)`);
		catch(`setAttr ("vrayRE_Multi_Matte"+$i+".vray_blueid_multimatte") ($i*3+3)`);
		catch(`setAttr ("vrayRE_Multi_Matte"+$i+".vray_usematid_multimatte") 1`);
		catch(`setAttr ("vrayRE_Multi_Matte"+$i+".vray_affectmattes_multimatte") 0`);		

		catch(`setAttr ("vrayRE_Multi_MatteEx"+$i+".vray_redid_multimatte") ($i*3+101)`);
		catch(`setAttr ("vrayRE_Multi_MatteEx"+$i+".vray_greenid_multimatte") ($i*3+102)`);
		catch(`setAttr ("vrayRE_Multi_MatteEx"+$i+".vray_blueid_multimatte") ($i*3+103)`);
		catch(`setAttr ("vrayRE_Multi_MatteEx"+$i+".vray_usematid_multimatte") 1`);
		catch(`setAttr ("vrayRE_Multi_MatteEx"+$i+".vray_affectmattes_multimatte") 0`);
		

	}
}

global proc int[] om_expandFrameList (string $stringFrameList,int $stepSize) {
	string $expandedFrameListTmp[];
	tokenize $stringFrameList "," $expandedFrameListTmp;

	int $expandedFrameList[],$index=0;
	clear $expandedFrameList;
	for ($currentSubRange in $expandedFrameListTmp) {
		if (`gmatch $currentSubRange "*-*"`) {
			string $subRange[];
			tokenize $currentSubRange "-" $subRange;
			for ($subFrame=int($subRange[0]);$subFrame<=int($subRange[1]);$subFrame=$subFrame+$stepSize) {
				$expandedFrameList[$index]=$subFrame;
				$index++;
			}
		}
		else {
			$expandedFrameList[$index]=int($currentSubRange);
			$index++;
		}
	}
	return $expandedFrameList;
}




global proc om_removeMaterialOverridesFromReference () {
	string $allEdits[]=`referenceQuery -es`,$printme="";
	for ($current in $allEdits) {
		string $buffer[];
		tokenize $current "\"" $buffer;
		
		if (`gmatch $current "disconnectAttr*instObjGroups*SG.*"` && !`gmatch $current "*VOP*"`) {
			$printme+=($current+"\n");
			//print ($current+"\n");
			//print ($buffer[1]+"\n");
			referenceEdit -failedEdits true -successfulEdits true -editCommand disconnectAttr -removeEdits $buffer[1];
		}
		if (`gmatch $current "connectAttr*instObjGroups*SG.*"` && !`gmatch $current "*VOP*"`) {
			$printme+=($current+"\n");
			//print ($current+"\n");
			//print ($buffer[1]+"\n");
			referenceEdit -failedEdits true -successfulEdits true -editCommand connectAttr -removeEdits $buffer[1];
		}
	}
	print $printme;
}


global proc om_removePartNodes () {
	string $sel[]=`ls -sl -type PartNode`,$buffer[];
	for ($current in $sel) {
		tokenize $current "|" $buffer;
		string $shortName=$buffer[size($buffer)-1];
		string $transform=`createNode -n ($shortName+"___TRANSFORM") transform`,
		$childs[]=`listRelatives -f $current`,
		$parent[]=`listRelatives -f -p $current`;	
		if (size($childs))
			parent $childs $transform;
		parent $transform $parent[0];
		delete $current;
	}
}


global proc om_simpleExport () {
	string $crl=`editRenderLayerGlobals -q -currentRenderLayer`,$members[]=`editRenderLayerMembers -q $crl`,$buffer[],
	$cmd=("editRenderLayerMembers -noRecurse  `editRenderLayerGlobals -q -currentRenderLayer` ");
	for ($current in $members) {
		int $size=`tokenize $current ":" $buffer`;
		$cmd=($cmd+$buffer[$size-1]+" ");
		}
	print ("---------------------------------------------------------------COPY BELOW THIS LINE---------------------------------------------------------------\n");
	
	print ($cmd+";\nsetLayerTo all\".visibility\" 0;\n");	
	
	string $allLayers[] = `ls -type displayLayer`;
	for ($current in $allLayers) 
		if( `getAttr ($current + ".visibility")` ) {
			int $size=`tokenize $current ":" $buffer`;
			print ("catch(`setAttr "+$buffer[$size-1]+ ".visibility 1`);\n");
		}
			
	
	
}

global proc om_enableRenderlayers() { // ENABLE ALL RENDERLAYERS OF THE SELECTED OBJECTS

	string $vops[]=`listConnections -type VRayObjectProperties`;
	$vops=stringArrayRemoveDuplicates($vops);
	for ($current in $vops) {
		string $renderLayer=`substring $current  1 (size($current)-4)`;
		catch(`setAttr ($renderLayer+".renderable") 1`);
		}

}


global proc om_enableALLRenderlayers() {
	string $rl[]=`listConnections -type renderLayer renderLayerManager`,
	$cmd=""; 
	
	global string $gMainProgressBar;
	progressBar -edit    -beginProgress    -isInterruptable true    -status "Enabling all renderlayers..."    -maxValue `size($rl)`    $gMainProgressBar;
	
	for ($current in $rl) {
		if (!`getAttr ($current+".renderable")`) 
			catch(`setAttr ($current+".renderable") 1`); 
		if(`progressBar -query -isCancelled $gMainProgressBar`)
		   break;
		progressBar -edit -step 1 $gMainProgressBar;
	}

	progressBar -edit    -endProgress    $gMainProgressBar;
	
	
}




global proc om_deselectVrayMeshes() {
	string $meshes[]=`ls -type transform -sl`;

	for ($current in $meshes) {
		string $hist[]=`listHistory $current`;
		for ($curHist in $hist)
			if (`nodeType($curHist)`=="VRayMesh")
				select -d $current;

	}
}

global proc int om_hasVrayMesh(string $obj) {

	if (`objExists $obj`) {
		string $hist[]=`listHistory $obj`;
		for ($curHist in $hist)
			if (`nodeType($curHist)`=="VRayMesh")
				return 1;		
	}
	return 0;
	
}


global proc om_printOutlinerStart() {

	string $sel[]=`ls -sl -type transform`;
	int $numTransforms=size(`listRelatives -ad -type transform`);

	global string $gMainProgressBar;
	progressBar -edit    -beginProgress    -isInterruptable true    -status ("Renaming "+$numTransforms+" nodes...")    -maxValue $numTransforms    $gMainProgressBar;

	for ($currentNode in $sel)
		om_printOutliner($currentNode,0);

	progressBar -edit    -endProgress    $gMainProgressBar;
	
}	

global proc om_printOutliner(string $nextNode,int $recursionDepth) {	
	
	global string $gMainProgressBar;
	//if(`progressBar -query -isCancelled $gMainProgressBar`)
      // break;
	progressBar -edit -step 1 $gMainProgressBar;
	
	for ($i=0;$i<$recursionDepth;$i++)
		print "    ";
	
	string $buffi[];
	int $num=`tokenize $nextNode "|" $buffi`;
	print ($buffi[$num-1]+"\n");
	string $childs[]=`listRelatives -f -type transform $nextNode`;
	if (size($childs)) //RECURSE YOURSELF!
		for ($current in $childs)
			om_printOutliner($current,$recursionDepth+1);

	/*string	$buffer[],
			$tmp[]=`ls -r 1 $nextNode`;
	$nextNode=$tmp[0];
	tokenize $nextNode "|" $buffer;
	string	$objName=$buffer[size($buffer)-1],
			$newName=$objName;
	//print ("DEBUG: "+$newName+"\n");
	$counter=0;
	if (size(`ls -r 1 -type transform $newName`)>1) {
		while (size(`ls -r 1 -type transform $newName`)) {
			$newName=$objName+$counter;
			$counter++;	
			}	
	
		string $result=`rename $nextNode $newName`;
		string $shapes[]=`listRelatives -f -s $result`;
		for ($i=0;$i<size($shapes);$i++)
			rename $shapes[$i] ($newName+"Shape"+$i);
		print ("DEBUG: renamed "+$nextNode+" to "+$newName+"\n");
		}
	*/
}

global proc om_resolveClashedShadingGroups(string $prefix,int $includeIncrements) {

	string $allShadingGroups[]=`ls -type shadingEngine`;
	int $prefixSize=size($prefix);
	
	for ($current in $allShadingGroups)
		if (`gmatch $current ($prefix+"*")`) {
			$unclashedName=`substring $current ($prefixSize+1) (size($current)-$includeIncrements)`;
			if (`objExists $unclashedName`) 
				if (nodeType($unclashedName)=="shadingEngine") {
					print ("Moving members from "+$current+" to "+ $unclashedName +"\n");
					string $members[]=`sets -q $current`;
					sets -e -forceElement $unclashedName $members;
					delete $current;
			}
	}



}

global proc om_printShadingGroupAssignments() {
	string $sel[]=`ls -sl`,$sg[];
	for ($current in $sel) {
		$sg=`listConnections -type shadingEngine $current`;
		print ("catch(`sets -e -forceElement "+ $sg[0] +" "+$current+"`);\n");

	}
}

global proc om_attachToConstrainObject() {
	// attach selected nodes to contrain
	// constrain must be LAST in selection list
	$selected = `ls -sl`;
	int $lastindex = size($selected)-1;
	for ( $i = 0; $i < $lastindex; $i++ )
	{
		print ("bind " + $selected[$i] + " to " + $selected[$lastindex] +  ".\n");
		parentConstraint  -mo $selected[$lastindex] $selected[$i];
		//select -r $selected[$i];
		//string $shapes[] = om_getLowestLevelTransforms(`ls -sl`);
		//select -r $shapes;
	}
	
	string $shapes[] = om_getLowestLevelTransforms($selected);
	select -r $shapes;
	isolateSelect -removeSelected modelPanel4;

}





global proc om_assignUniqueIDs(string $prefix) {
	string $meshes[]=`ls -sl -type mesh`;
	
	if (!size($meshes))
		$meshes=`ls -type mesh`;
		
	int $count=0;
	for ($current in $meshes) {
		if (!attributeExists ("SCName", $current) ) {
			addAttr -ln "SCName"  -dt "string"  $current;
			setAttr -type "string" ($current+".SCName") ($prefix+"_"+$count);
			$count++;
		}
	}
	print ($count+" unique name attributes assigned!");
}


global proc om_isNoVRayMtl() {
	string $sgs[]=`ls -type shadingEngine`;
	select -cl;
	for ($current in $sgs) {
		string $connsVR[]=`listConnections -type VRayMtl $current`;
		string $connsVRBlend[]=`listConnections -type VRayBlendMtl $current`;
		if (size($connsVR)==0 && size($connsVRBlend)==0)
			select -add `sets -q $current`;
		
		

	}
}

global proc om_addMaterialIDtoSG() {
	string $sela[] = `ls -sl`;
	for ($current in $sela){
		vray addAttributesFromGroup $current vray_material_id 1;
		vrayAddAttr $current vrayColorId;
		vrayAddAttr $current vrayMaterialId;
		}
}

global proc om_setMaterialIDValues(int $i) {
	string $sela[] = `ls -sl -type shadingEngine`;	
	for ($current in $sela){
		catch(`setAttr ($current+".vrayMaterialId") $i`);
		$i=$i+1;
	}
}

global proc string[] om_returnRenderableObjects() {
	string	$vops[]=`ls -type VRayObjectProperties`,
			$renderableObjects[];
	
	for ($current in $vops)
		if (`getAttr ($current+".matteSurface")`==0 && `getAttr ($current+".alphaContribution")`==1 && `getAttr ($current+".primaryVisibility")`==1) {
			string $tmp[]=`sets -q $current`;
			appendStringArray ($renderableObjects, $tmp, size($tmp));
		}
	return $renderableObjects;
}

global proc om_selectRenderableVOP() {
	string $tmp[]=om_returnRenderableObjects();
	select -r $tmp;
}


global proc om_cleanUpUVSets() {

	//string $vrayMeshes[]=`ls -type VRayMesh`;
	//for ($currentMesh in $vrayMeshes)
	//	setAttr ($current+".dontSetNormals") 0;
	
	string $sel[]=`ls -sl -type mesh`;
	//IF LOWEST LEVEL TRANSFORMS ARE SELECTED THEN CONVERT SELECTION TO SHAPES
	if (!size($sel))
		$sel=`listRelatives -f -s`;
	
	global string $gMainProgressBar;
	progressBar -edit    -beginProgress    -isInterruptable true    -status "Cleaning up uvSetNames ..."    -maxValue `size($sel)`    $gMainProgressBar;
	
	
	for ($current in $sel) {
		if (!om_hasVrayMesh($current)) 
		  if (`objExists $current`) {
			delete -ch $current; //DELETE CONSTRUCTION HISTORY
			string $allUVs[]=`polyUVSet -q -allUVSets $current`; //GET ALL UV-SETS			
			string $realCurrentUVset[]=`polyUVSet -q -currentUVSet $current`;
			
			//TRY TO COPY CURRENT UVset to emtpy map1 - just a hack when sometime there is a hidden map1
			int $uvsMap1[]=`polyEvaluate -uv -uvs "map1"`;
			if ($uvsMap1[0]==0 && $realCurrentUVset[0]!="map1")
				polyCopyUV -uvSetNameInput $realCurrentUVset[0] -uvSetName "map1"  -ch 0 $current;
			
			for ($currentUV in $allUVs) {				
				if ($currentUV!=$realCurrentUVset[0]) //DELETE ALL BUT THE CURRENT UVset
					catch(`polyUVSet -delete -uvSet $currentUV $current`);
			}
			$allUVs=`polyUVSet -q -allUVSets $current`;
			//print $allUVs;
			//polyCopyUV -uvSetNameInput $allUVs[0] -uvSetName "map1" -createNewMap 1 -ch 0 $currentT;
			
			//if ($allUVs[0]!="map1")
			catch(`polyUVSet -rename -newUVSet "map1" $current`);
			//polyUVSet -currentUVSet -uvSet "map1" $currenT;
			//polyUVSet -delete -uvSet $allUVs[0] $currenT;
			delete -ch $current;
		}
		else
			print ("Skipping "+$current+" because it already has a Vray Proxy attached!\n");
			
		progressBar -edit -step 1 $gMainProgressBar;


	}
	progressBar -edit    -endProgress    $gMainProgressBar;	
	


}



global proc string[] om_findObjectsWithoutVOP() {
	//ALWAYS CHECK FOR NEW UNCONNECTED OBJECTS and put them in there
	string	$allTransforms[]=`ls -type transform`,
			$unconnected[];	
			
	int $i=0;
	
	for ($current in $allTransforms) {
		string $hasShape[]=`listRelatives -f -s $current`;
		if (size($hasShape))
		  if (`nodeType $hasShape[0]`=="mesh") {
			string $isConnected[]=`listConnections -type VRayObjectProperties $current`;
			if (!size($isConnected)) {
				$unconnected[$i]=$current;
				$i++;			
			}
		}		
	}
	return $unconnected;
}


global proc om_createOcclusion() {
	if (!objExists("om_OCC_surfaceShader")) {
		createNode -n om_OCC_surfaceShader  surfaceShader;
		
		createNode -n om_OCC_VRayDirt  VRayDirt;
		setAttr "om_OCC_VRayDirt.workWithTransparency" 1;
		setAttr "om_OCC_VRayDirt.radius" 10;
		setAttr "om_OCC_VRayDirt.subdivs" 64;
		setAttr "om_OCC_VRayDirt.distribution" 1;


		createNode -n om_OCC_VRayDirt_flippedNormal  VRayDirt;
		setAttr "om_OCC_VRayDirt_flippedNormal.invertNormal" 1;
		connectAttr -f om_OCC_VRayDirt.radius om_OCC_VRayDirt_flippedNormal.radius;
		connectAttr -f om_OCC_VRayDirt.subdivs om_OCC_VRayDirt_flippedNormal.subdivs;
		connectAttr -f om_OCC_VRayDirt.distribution om_OCC_VRayDirt_flippedNormal.distribution;

		createNode -n om_OCC_samplerInfo samplerInfo;
		createNode -n om_OCC_condition condition;
		connectAttr -f om_OCC_samplerInfo.flippedNormal om_OCC_condition.firstTerm;
		connectAttr -f om_OCC_VRayDirt.outColor om_OCC_condition.colorIfTrue;
		connectAttr -f om_OCC_VRayDirt_flippedNormal.outColor om_OCC_condition.colorIfFalse;

		connectAttr -f om_OCC_condition.outColor om_OCC_surfaceShader.outColor;

		createNode -n om_OCC_SG  shadingEngine;		
		connectAttr -f om_OCC_surfaceShader.outColor om_OCC_SG.surfaceShader;
	
	
	}
	if (!attributeExists ("forceOcclusion", "om_OCC_SG")) {
		addAttr -ln "forceOcclusion"  -at bool  om_OCC_SG;
		setAttr om_OCC_SG.forceOcclusion 1;
		}
		

	string $rl[]=`listConnections -type renderLayer renderLayerManager`;
	for  ($currentRenderLayer in $rl) {
		if (!attributeExists ("renderOcclusion", $currentRenderLayer) ) {
			addAttr -ln "renderOcclusion"  -at bool  $currentRenderLayer;
			setAttr ($currentRenderLayer+".renderOcclusion") 0;
		}
		//if (!attributeExists ("reRenderOcclusion", $currentRenderLayer) ) {
		//	addAttr -ln "reRenderOcclusion"  -at bool  $currentRenderLayer;
		//	setAttr ($currentRenderLayer+".reRenderOcclusion") 1;
		//}
		if (!attributeExists ("occlusionRenderedOnFrame", $currentRenderLayer) ) {
			addAttr -ln "occlusionRenderedOnFrame"  -dt "string"  $currentRenderLayer;;
			setAttr -type "string" ($currentRenderLayer+".occlusionRenderedOnFrame") ",";
		}
		
	}
	
	//connect to renderlayer
	string	$currentLayer = `editRenderLayerGlobals -q -currentRenderLayer`;
	om_connectOcclusion($currentLayer);
	
	select -r -ne om_OCC_SG;
	
}

global proc om_connectOcclusion(string $renderLayer) {
	
	//REMEMBER CURRENT LAYER OVERRIDE
	string $layerOverride[]=`listConnections -p 1 ($renderLayer+".shadingGroupOverride")`;
	if (size($layerOverride)) {
		if (!attributeExists ("layerOverride", $renderLayer) )
			addAttr -ln "layerOverride"  -dt "string"  $renderLayer;
		setAttr -type "string" ($renderLayer+".layerOverride") $layerOverride[0];
	}
	
	//CONNECT OCCLUSION
	if (objExists("om_OCC_SG"))
		connectAttr -f om_OCC_SG.message ($renderLayer+".shadingGroupOverride");
	else
		error "Please setup your occlusion first!";
}

global proc om_disconnectOcclusion() {
	if (`objExists om_OCC_SG`) {
		string $sgOverrides[]=`listConnections -type renderLayer om_OCC_SG.message`;
		for ($current in $sgOverrides) {
			disconnectAttr om_OCC_SG.message ($current+".shadingGroupOverride");
			//RECONNECT OLD OVERRIDE
			if (attributeExists ("layerOverride", $current)) {
				string $layerOverride=`getAttr ($current+".layerOverride")`;
				print $layerOverride;
				if ($layerOverride!="")
					connectAttr -f $layerOverride ($current+".shadingGroupOverride");
			}
		}
	}	
}


global proc om_printFramesWithOcclusion() {
	string $rls[]=`listConnections -type renderLayer renderLayerManager`;
	for ($currentRenderLayer in $rls)
		if (attributeExists ("occlusionRenderedOnFrame", $currentRenderLayer) ) {
				//setAttr -type "string" ($currentRenderLayer+".occlusionRenderedOnFrame") ",";
				print ("catch(`setAttr -type \"string\" \""+$currentRenderLayer+".occlusionRenderedOnFrame\" \""+`getAttr ($currentRenderLayer+".occlusionRenderedOnFrame")`+"\"`);\n");
				
			}
}

global proc om_rerenderOcclusion() {
	//string $rls[]=`listConnections -type renderLayer renderLayerManager`;
	//for ($currentRenderLayer in $rls)
	$currentRenderLayer = `editRenderLayerGlobals -q -currentRenderLayer`; 
		if (attributeExists ("occlusionRenderedOnFrame", $currentRenderLayer) ) {
				//setAttr -type "string" ($currentRenderLayer+".occlusionRenderedOnFrame") ",";
				setAttr -type "string" ($currentRenderLayer+".occlusionRenderedOnFrame") ",";
				
			}
}




global proc om_mirrorKeys(float $startTime, float $endTime, float $timeScalePivot) {
	//USAGE
	//om_mirrorKeys(11,19,10); bei alten Konfiguratoren start bei 90 Seite
	//om_mirrorKeys(19,27,28); bei alten Konfiguratoren
	//om_mirrorKeys(0,17,18);  bei neuen Konfiguratoren start bei 0 Front
	
	
	
	string $sel[]=`ls -sl -type transform`;
	for ($currentObj in $sel) {
		string $attributes[]=`keyframe -q -name $currentObj`;
		for ($currentAttr in $attributes) {
			float	$keys[]=`keyframe -time ($startTime + ":" + $endTime ) -q  -timeChange -valueChange $currentAttr`;
			//NOT IN USE
			//string	$tangents[]=`keyTangent -time ($startTime + ":" + $endTime ) -q -itt -ott $currentAttr`;
					

			//print ("-------------"+$currentAttr+"----------\n");
			//print $keys;
			for ($i=0;$i<size($keys);$i=$i+2) {
				float $newTime = ($keys[$i] - $timeScalePivot) * -1 + $timeScalePivot;
				setKeyframe -t $newTime -v $keys[$i+1] -itt linear  -ott linear  $currentAttr;				
			}
		}
	}
}


global proc om_findObjectsWithoutProxy() {

	string $sel[]=`ls -type transform`;

	select -cl;

	for ($current in $sel) {
		string $shape[]=`listRelatives -f -s -type mesh $current`;	
		if (size($shape)) {
			//string $vrmeshes[]=`listConnections -type VRayMesh $shape[0]`;
			string $history[]=`listHistory $shape[0]`;
			int $foundVRayMesh=0;
			for ($currentNode in $history)
				if (`nodeType $currentNode`=="VRayMesh")
					$foundVRayMesh=1;
			if ($foundVRayMesh==0)
				select -add $current;
		}
	}
}

global proc removeShadingGroupReferenceEdits(string $refNode) {
	string	$allRefEditString[]=`referenceQuery -es $refNode`,
			$buffer[],
			$disconnectedFromSG[];
	int $counter=0;
	
	global string $gMainProgressBar;
	progressBar -edit    -beginProgress    -isInterruptable true    -status "Initializing..."    -maxValue `size($allRefEditString)`    $gMainProgressBar;
	
	
	for ($i=0;$i<size($allRefEditString);$i++) {
		if (`gmatch $allRefEditString[$i] "disconnectAttr*.instObjGroups*.dagSetMembers*"`) {
			//print ($allRefEditString[$i]+"\n");
			tokenize $allRefEditString[$i] "\"" $buffer;
			//print ($buffer[1]+"\n");			
			if (size($buffer)>1) {
				$disconnectedFromSG[size($disconnectedFromSG)]=$buffer[1];
			}
			else
				print ("DEBUG: "+$buffer[0]);
		}
	}
	for ($i=0;$i<size($allRefEditString);$i++) {
		if (`gmatch $allRefEditString[$i] "connectAttr*.instObjGroups*.dagSetMembers*"`) {
			//print ($allRefEditString[$i]+"\n");
			tokenize $allRefEditString[$i] "\"" $buffer;
			//print ($buffer[1]+"\n");			
			if (size($buffer)>1) {
				if (stringArrayContains($buffer[1], $disconnectedFromSG)) {
					referenceEdit -failedEdits true -successfulEdits true -editCommand disconnectAttr -removeEdits ($buffer[1]);
					referenceEdit -failedEdits true -successfulEdits true -editCommand connectAttr -removeEdits ($buffer[1]);					
					$counter++;
				}
			}
			else
				print ("DEBUG: "+$buffer[0]);
			
		}
		if(`progressBar -query -isCancelled $gMainProgressBar`)
			break;
		progressBar -edit -status ("Removing ref edits..."+$counter+" until now... (press ESC to cancel)") -step 1 $gMainProgressBar;
	}
	progressBar -edit    -endProgress    $gMainProgressBar;
	print ("Removed "+$counter+" shadingGroup reference edits.\n");
	
}

global proc om_allCamsOff() {
	//set all cameras renderable off
	string $cams[]=`ls -type camera`;
	for ($current in $cams)
		if(`getAttr ($current+".renderable")`)
			setAttr ($current+".renderable") 0;
}

global proc om_mergeVertices() {

	string $mesh[]=`ls -sl -type transform -type mesh`;
	if (!size($mesh))
		$mesh=`ls -type mesh`;
		
	int $index=0,$size=`size($mesh)`;
	global string $gMainProgressBar;
	progressBar -edit    -beginProgress    -isInterruptable true    -maxValue $size $gMainProgressBar;

	for ($current in $mesh) {
		delete -ch $current;
		trace ("Current object: "+$current+"\n");
		polyMergeVertex -d 0 -am 0 -ch 0 $current;
		if(`progressBar -query -isCancelled $gMainProgressBar`)
			break;
		$index++;
		progressBar -edit -step 1 -status ("Mergizzle... "+$index+"/"+$size) $gMainProgressBar;
		}
	progressBar -edit    -endProgress    $gMainProgressBar;
}

global proc om_removeLightLinks() {
	//BREAK CONNECTIONS ON ALL LIGHTLINKERS
	string $lightLinkers[]=`ls -type lightLinker`;
	for ($currentLL in $lightLinkers) {
		string $conns[]=`listConnections -s 1 -d 0 -p 1 -c 1 $currentLL`;

		global string $gMainProgressBar;
		progressBar -edit    -beginProgress    -isInterruptable true    -status ("removing lightlinks on "+$currentLL) -maxValue (`size($conns)`/2)    $gMainProgressBar;
			
		for ($i=0;$i<size($conns);$i=$i+2) {
			disconnectAttr $conns[$i+1] $conns[$i];
			//if(`progressBar -query -isCancelled $gMainProgressBar`)
					//break;
			progressBar -edit -step 1 $gMainProgressBar;
		}
		progressBar -edit    -endProgress    $gMainProgressBar;
	}
	//RESTORE CONNECTIONS FROM ALL shadingGroups to lightLinker1
	string $sgs[]=`ls -type shadingEngine`;
	for ($i=0;$i<size($sgs);$i++) {
		catch(`connectAttr -f defaultLightSet.message  lightLinker1.link[$i].light`);
		catch(`connectAttr -f ($sgs[$i]+".message") lightLinker1.link[$i].object`) ;

		catch(`connectAttr -f defaultLightSet.message lightLinker1.shadowLink[$i].shadowLight`) ;
		catch(`connectAttr -f ($sgs[$i]+".message")  lightLinker1.shadowLink[$i].shadowObject`) ;
	}
}


global proc om_cleanVOPConnections() {
int $counter=0;
string $sel[]=`ls -type transform`;
for ($currentTransform in $sel) {
	string $conns[]=`listConnections -type VRayObjectProperties -p 1 -c 1 $currentTransform`;
	if (size($conns) > 2) { //greater 2 because lisconnections return source and destination
		for ($i=2;$i<size($conns);$i=$i+2) {
			disconnectAttr $conns[$i] $conns[$i+1];
			$counter++;
		}
	}

}
print ("removed " + $counter + " duplicate VOP connections");
}

global proc om_setupStereo(string $eye) {

om_setImageFilePrefixStereo();

string $stereoRig[]=`ls -type stereoRigTransform`;
string $leftCam[]=`listConnections ($stereoRig[0]+".leftCamera")`;
string $rightCam[]=`listConnections ($stereoRig[0]+".rightCamera")`;

if ($eye=="left") {
	setAttr -type "string" vraySettings.batchCamera $leftCam[0];
	print $leftCam[0];
	}
if ($eye=="right") {
	setAttr -type "string" vraySettings.batchCamera $rightCam[0];
	print $rightCam[0];
	}
}

global proc om_setImageFilePrefixStereo() {

string $sceneDir=`workspace -q -rd`+`workspace -q -rte scene`,
	$fileDir = dirname(`file -q -exn`);

int	$lenSceneDir =  size($sceneDir) + 2,
	$lenFileDir  =  size($fileDir);
string $imgFilePrefix=`substring $fileDir $lenSceneDir  $lenFileDir`;

$imgFilePrefix = $imgFilePrefix + "/<Layer>/<Scene>/<Camera>/<Scene>.";

om_setFileNamePrefix($imgFilePrefix);

}

global proc om_setFileNamePrefix(string $fileNamePrefix) {

	if (catch(`textFieldGrp -e -text $fileNamePrefix vrayFileNamePrefix`))
		error "Please open RenderGlobals and initialize Vray Common Tab";
	setAttr -type "string" vraySettings.fileNamePrefix $fileNamePrefix;
	vrayChangeFileNamePrefix();
	
}




